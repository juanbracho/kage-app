var Cg=Object.defineProperty;var Dg=(e,t,r)=>t in e?Cg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var sr=(e,t,r)=>Dg(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();const Tg="modulepreload",Eg=function(e,t){return new URL(e,t).href},tc={},ge=function(t,r,a){let s=Promise.resolve();if(r&&r.length>0){const i=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),l=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=Promise.allSettled(r.map(d=>{if(d=Eg(d,a),d in tc)return;tc[d]=!0;const h=d.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(!!a)for(let m=i.length-1;m>=0;m--){const v=i[m];if(v.href===d&&(!h||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${u}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":Tg,h||(g.as="script"),g.crossOrigin="",g.href=d,l&&g.setAttribute("nonce",l),document.head.appendChild(g),h)return new Promise((m,v)=>{g.addEventListener("load",m),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};function Od(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _d={exports:{}},Ws={},$d={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ca=Symbol.for("react.element"),Ig=Symbol.for("react.portal"),Pg=Symbol.for("react.fragment"),Ag=Symbol.for("react.strict_mode"),Mg=Symbol.for("react.profiler"),Fg=Symbol.for("react.provider"),Lg=Symbol.for("react.context"),Og=Symbol.for("react.forward_ref"),_g=Symbol.for("react.suspense"),$g=Symbol.for("react.memo"),Rg=Symbol.for("react.lazy"),rc=Symbol.iterator;function Bg(e){return e===null||typeof e!="object"?null:(e=rc&&e[rc]||e["@@iterator"],typeof e=="function"?e:null)}var Rd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bd=Object.assign,zd={};function Pn(e,t,r){this.props=e,this.context=t,this.refs=zd,this.updater=r||Rd}Pn.prototype.isReactComponent={};Pn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Pn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Hd(){}Hd.prototype=Pn.prototype;function Vi(e,t,r){this.props=e,this.context=t,this.refs=zd,this.updater=r||Rd}var Yi=Vi.prototype=new Hd;Yi.constructor=Vi;Bd(Yi,Pn.prototype);Yi.isPureReactComponent=!0;var nc=Array.isArray,Gd=Object.prototype.hasOwnProperty,Qi={current:null},Ud={key:!0,ref:!0,__self:!0,__source:!0};function qd(e,t,r){var a,s={},o=null,i=null;if(t!=null)for(a in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)Gd.call(t,a)&&!Ud.hasOwnProperty(a)&&(s[a]=t[a]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var l=Array(c),d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps,c)s[a]===void 0&&(s[a]=c[a]);return{$$typeof:Ca,type:e,key:o,ref:i,props:s,_owner:Qi.current}}function zg(e,t){return{$$typeof:Ca,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ki(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ca}function Hg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var ac=/\/+/g;function uo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Hg(""+e.key):t.toString(36)}function rs(e,t,r,a,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Ca:case Ig:i=!0}}if(i)return i=e,s=s(i),e=a===""?"."+uo(i,0):a,nc(s)?(r="",e!=null&&(r=e.replace(ac,"$&/")+"/"),rs(s,t,r,"",function(d){return d})):s!=null&&(Ki(s)&&(s=zg(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(ac,"$&/")+"/")+e)),t.push(s)),1;if(i=0,a=a===""?".":a+":",nc(e))for(var c=0;c<e.length;c++){o=e[c];var l=a+uo(o,c);i+=rs(o,t,r,l,s)}else if(l=Bg(e),typeof l=="function")for(e=l.call(e),c=0;!(o=e.next()).done;)o=o.value,l=a+uo(o,c++),i+=rs(o,t,r,l,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Ma(e,t,r){if(e==null)return e;var a=[],s=0;return rs(e,a,"","",function(o){return t.call(r,o,s++)}),a}function Gg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var tt={current:null},ns={transition:null},Ug={ReactCurrentDispatcher:tt,ReactCurrentBatchConfig:ns,ReactCurrentOwner:Qi};function Wd(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:Ma,forEach:function(e,t,r){Ma(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ma(e,function(){t++}),t},toArray:function(e){return Ma(e,function(t){return t})||[]},only:function(e){if(!Ki(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};le.Component=Pn;le.Fragment=Pg;le.Profiler=Mg;le.PureComponent=Vi;le.StrictMode=Ag;le.Suspense=_g;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ug;le.act=Wd;le.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=Bd({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Qi.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)Gd.call(t,l)&&!Ud.hasOwnProperty(l)&&(a[l]=t[l]===void 0&&c!==void 0?c[l]:t[l])}var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){c=Array(l);for(var d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}return{$$typeof:Ca,type:e.type,key:s,ref:o,props:a,_owner:i}};le.createContext=function(e){return e={$$typeof:Lg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Fg,_context:e},e.Consumer=e};le.createElement=qd;le.createFactory=function(e){var t=qd.bind(null,e);return t.type=e,t};le.createRef=function(){return{current:null}};le.forwardRef=function(e){return{$$typeof:Og,render:e}};le.isValidElement=Ki;le.lazy=function(e){return{$$typeof:Rg,_payload:{_status:-1,_result:e},_init:Gg}};le.memo=function(e,t){return{$$typeof:$g,type:e,compare:t===void 0?null:t}};le.startTransition=function(e){var t=ns.transition;ns.transition={};try{e()}finally{ns.transition=t}};le.unstable_act=Wd;le.useCallback=function(e,t){return tt.current.useCallback(e,t)};le.useContext=function(e){return tt.current.useContext(e)};le.useDebugValue=function(){};le.useDeferredValue=function(e){return tt.current.useDeferredValue(e)};le.useEffect=function(e,t){return tt.current.useEffect(e,t)};le.useId=function(){return tt.current.useId()};le.useImperativeHandle=function(e,t,r){return tt.current.useImperativeHandle(e,t,r)};le.useInsertionEffect=function(e,t){return tt.current.useInsertionEffect(e,t)};le.useLayoutEffect=function(e,t){return tt.current.useLayoutEffect(e,t)};le.useMemo=function(e,t){return tt.current.useMemo(e,t)};le.useReducer=function(e,t,r){return tt.current.useReducer(e,t,r)};le.useRef=function(e){return tt.current.useRef(e)};le.useState=function(e){return tt.current.useState(e)};le.useSyncExternalStore=function(e,t,r){return tt.current.useSyncExternalStore(e,t,r)};le.useTransition=function(){return tt.current.useTransition()};le.version="18.3.1";$d.exports=le;var N=$d.exports;const Vd=Od(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qg=N,Wg=Symbol.for("react.element"),Vg=Symbol.for("react.fragment"),Yg=Object.prototype.hasOwnProperty,Qg=qg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kg={key:!0,ref:!0,__self:!0,__source:!0};function Yd(e,t,r){var a,s={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)Yg.call(t,a)&&!Kg.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:Wg,type:e,key:o,ref:i,props:s,_owner:Qg.current}}Ws.Fragment=Vg;Ws.jsx=Yd;Ws.jsxs=Yd;_d.exports=Ws;var n=_d.exports,Wo={},Qd={exports:{}},vt={},Kd={exports:{}},Jd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,q){var U=O.length;O.push(q);e:for(;0<U;){var Z=U-1>>>1,$=O[Z];if(0<s($,q))O[Z]=q,O[U]=$,U=Z;else break e}}function r(O){return O.length===0?null:O[0]}function a(O){if(O.length===0)return null;var q=O[0],U=O.pop();if(U!==q){O[0]=U;e:for(var Z=0,$=O.length,R=$>>>1;Z<R;){var Y=2*(Z+1)-1,oe=O[Y],ae=Y+1,Pe=O[ae];if(0>s(oe,U))ae<$&&0>s(Pe,oe)?(O[Z]=Pe,O[ae]=U,Z=ae):(O[Z]=oe,O[Y]=U,Z=Y);else if(ae<$&&0>s(Pe,U))O[Z]=Pe,O[ae]=U,Z=ae;else break e}}return q}function s(O,q){var U=O.sortIndex-q.sortIndex;return U!==0?U:O.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,c=i.now();e.unstable_now=function(){return i.now()-c}}var l=[],d=[],h=1,u=null,f=3,g=!1,m=!1,v=!1,D=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(O){for(var q=r(d);q!==null;){if(q.callback===null)a(d);else if(q.startTime<=O)a(d),q.sortIndex=q.expirationTime,t(l,q);else break;q=r(d)}}function k(O){if(v=!1,x(O),!m)if(r(l)!==null)m=!0,H(C);else{var q=r(d);q!==null&&P(k,q.startTime-O)}}function C(O,q){m=!1,v&&(v=!1,y(j),j=-1),g=!0;var U=f;try{for(x(q),u=r(l);u!==null&&(!(u.expirationTime>q)||O&&!_());){var Z=u.callback;if(typeof Z=="function"){u.callback=null,f=u.priorityLevel;var $=Z(u.expirationTime<=q);q=e.unstable_now(),typeof $=="function"?u.callback=$:u===r(l)&&a(l),x(q)}else a(l);u=r(l)}if(u!==null)var R=!0;else{var Y=r(d);Y!==null&&P(k,Y.startTime-q),R=!1}return R}finally{u=null,f=U,g=!1}}var T=!1,b=null,j=-1,S=5,w=-1;function _(){return!(e.unstable_now()-w<S)}function M(){if(b!==null){var O=e.unstable_now();w=O;var q=!0;try{q=b(!0,O)}finally{q?F():(T=!1,b=null)}}else T=!1}var F;if(typeof p=="function")F=function(){p(M)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,L=G.port2;G.port1.onmessage=M,F=function(){L.postMessage(null)}}else F=function(){D(M,0)};function H(O){b=O,T||(T=!0,F())}function P(O,q){j=D(function(){O(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){m||g||(m=!0,H(C))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(O){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var U=f;f=q;try{return O()}finally{f=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,q){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var U=f;f=O;try{return q()}finally{f=U}},e.unstable_scheduleCallback=function(O,q,U){var Z=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?Z+U:Z):U=Z,O){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=U+$,O={id:h++,callback:q,priorityLevel:O,startTime:U,expirationTime:$,sortIndex:-1},U>Z?(O.sortIndex=U,t(d,O),r(l)===null&&O===r(d)&&(v?(y(j),j=-1):v=!0,P(k,U-Z))):(O.sortIndex=$,t(l,O),m||g||(m=!0,H(C))),O},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(O){var q=f;return function(){var U=f;f=q;try{return O.apply(this,arguments)}finally{f=U}}}})(Jd);Kd.exports=Jd;var Jg=Kd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg=N,bt=Jg;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xd=new Set,ia={};function Qr(e,t){kn(e,t),kn(e+"Capture",t)}function kn(e,t){for(ia[e]=t,e=0;e<t.length;e++)Xd.add(t[e])}var Xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vo=Object.prototype.hasOwnProperty,Zg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sc={},oc={};function e0(e){return Vo.call(oc,e)?!0:Vo.call(sc,e)?!1:Zg.test(e)?oc[e]=!0:(sc[e]=!0,!1)}function t0(e,t,r,a){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function r0(e,t,r,a){if(t===null||typeof t>"u"||t0(e,t,r,a))return!0;if(a)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rt(e,t,r,a,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var qe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qe[e]=new rt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qe[t]=new rt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qe[e]=new rt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qe[e]=new rt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qe[e]=new rt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qe[e]=new rt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qe[e]=new rt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qe[e]=new rt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qe[e]=new rt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ji=/[\-:]([a-z])/g;function Xi(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ji,Xi);qe[t]=new rt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ji,Xi);qe[t]=new rt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ji,Xi);qe[t]=new rt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qe[e]=new rt(e,1,!1,e.toLowerCase(),null,!1,!1)});qe.xlinkHref=new rt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qe[e]=new rt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zi(e,t,r,a){var s=qe.hasOwnProperty(t)?qe[t]:null;(s!==null?s.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(r0(t,r,s,a)&&(r=null),a||s===null?e0(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,a=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}var rr=Xg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fa=Symbol.for("react.element"),en=Symbol.for("react.portal"),tn=Symbol.for("react.fragment"),el=Symbol.for("react.strict_mode"),Yo=Symbol.for("react.profiler"),Zd=Symbol.for("react.provider"),eu=Symbol.for("react.context"),tl=Symbol.for("react.forward_ref"),Qo=Symbol.for("react.suspense"),Ko=Symbol.for("react.suspense_list"),rl=Symbol.for("react.memo"),lr=Symbol.for("react.lazy"),tu=Symbol.for("react.offscreen"),ic=Symbol.iterator;function On(e){return e===null||typeof e!="object"?null:(e=ic&&e[ic]||e["@@iterator"],typeof e=="function"?e:null)}var Ne=Object.assign,mo;function Wn(e){if(mo===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);mo=t&&t[1]||""}return`
`+mo+e}var go=!1;function po(e,t){if(!e||go)return"";go=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var a=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){a=d}e.call(t.prototype)}else{try{throw Error()}catch(d){a=d}e()}}catch(d){if(d&&a&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=a.stack.split(`
`),i=s.length-1,c=o.length-1;1<=i&&0<=c&&s[i]!==o[c];)c--;for(;1<=i&&0<=c;i--,c--)if(s[i]!==o[c]){if(i!==1||c!==1)do if(i--,c--,0>c||s[i]!==o[c]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=c);break}}}finally{go=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Wn(e):""}function n0(e){switch(e.tag){case 5:return Wn(e.type);case 16:return Wn("Lazy");case 13:return Wn("Suspense");case 19:return Wn("SuspenseList");case 0:case 2:case 15:return e=po(e.type,!1),e;case 11:return e=po(e.type.render,!1),e;case 1:return e=po(e.type,!0),e;default:return""}}function Jo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case tn:return"Fragment";case en:return"Portal";case Yo:return"Profiler";case el:return"StrictMode";case Qo:return"Suspense";case Ko:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eu:return(e.displayName||"Context")+".Consumer";case Zd:return(e._context.displayName||"Context")+".Provider";case tl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case rl:return t=e.displayName||null,t!==null?t:Jo(e.type)||"Memo";case lr:t=e._payload,e=e._init;try{return Jo(e(t))}catch{}}return null}function a0(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jo(t);case 8:return t===el?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ru(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function s0(e){var t=ru(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){a=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(i){a=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function La(e){e._valueTracker||(e._valueTracker=s0(e))}function nu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=ru(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function ys(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xo(e,t){var r=t.checked;return Ne({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function lc(e,t){var r=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;r=jr(t.value!=null?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function au(e,t){t=t.checked,t!=null&&Zi(e,"checked",t,!1)}function Zo(e,t){au(e,t);var r=jr(t.value),a=t.type;if(r!=null)a==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ei(e,t.type,r):t.hasOwnProperty("defaultValue")&&ei(e,t.type,jr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cc(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ei(e,t,r){(t!=="number"||ys(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Vn=Array.isArray;function pn(e,t,r,a){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&a&&(e[r].defaultSelected=!0)}else{for(r=""+jr(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,a&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function ti(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ne({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dc(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(W(92));if(Vn(r)){if(1<r.length)throw Error(W(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:jr(r)}}function su(e,t){var r=jr(t.value),a=jr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),a!=null&&(e.defaultValue=""+a)}function uc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ou(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ri(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ou(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Oa,iu=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,a,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,a,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Oa=Oa||document.createElement("div"),Oa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Oa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function la(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Kn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},o0=["Webkit","ms","Moz","O"];Object.keys(Kn).forEach(function(e){o0.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Kn[t]=Kn[e]})});function lu(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Kn.hasOwnProperty(e)&&Kn[e]?(""+t).trim():t+"px"}function cu(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var a=r.indexOf("--")===0,s=lu(r,t[r],a);r==="float"&&(r="cssFloat"),a?e.setProperty(r,s):e[r]=s}}var i0=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ni(e,t){if(t){if(i0[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function ai(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var si=null;function nl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oi=null,hn=null,fn=null;function mc(e){if(e=Ea(e)){if(typeof oi!="function")throw Error(W(280));var t=e.stateNode;t&&(t=Js(t),oi(e.stateNode,e.type,t))}}function du(e){hn?fn?fn.push(e):fn=[e]:hn=e}function uu(){if(hn){var e=hn,t=fn;if(fn=hn=null,mc(e),t)for(e=0;e<t.length;e++)mc(t[e])}}function mu(e,t){return e(t)}function gu(){}var ho=!1;function pu(e,t,r){if(ho)return e(t,r);ho=!0;try{return mu(e,t,r)}finally{ho=!1,(hn!==null||fn!==null)&&(gu(),uu())}}function ca(e,t){var r=e.stateNode;if(r===null)return null;var a=Js(r);if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(W(231,t,typeof r));return r}var ii=!1;if(Xt)try{var _n={};Object.defineProperty(_n,"passive",{get:function(){ii=!0}}),window.addEventListener("test",_n,_n),window.removeEventListener("test",_n,_n)}catch{ii=!1}function l0(e,t,r,a,s,o,i,c,l){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(h){this.onError(h)}}var Jn=!1,xs=null,bs=!1,li=null,c0={onError:function(e){Jn=!0,xs=e}};function d0(e,t,r,a,s,o,i,c,l){Jn=!1,xs=null,l0.apply(c0,arguments)}function u0(e,t,r,a,s,o,i,c,l){if(d0.apply(this,arguments),Jn){if(Jn){var d=xs;Jn=!1,xs=null}else throw Error(W(198));bs||(bs=!0,li=d)}}function Kr(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function hu(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gc(e){if(Kr(e)!==e)throw Error(W(188))}function m0(e){var t=e.alternate;if(!t){if(t=Kr(e),t===null)throw Error(W(188));return t!==e?null:e}for(var r=e,a=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(a=s.return,a!==null){r=a;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return gc(s),e;if(o===a)return gc(s),t;o=o.sibling}throw Error(W(188))}if(r.return!==a.return)r=s,a=o;else{for(var i=!1,c=s.child;c;){if(c===r){i=!0,r=s,a=o;break}if(c===a){i=!0,a=s,r=o;break}c=c.sibling}if(!i){for(c=o.child;c;){if(c===r){i=!0,r=o,a=s;break}if(c===a){i=!0,a=o,r=s;break}c=c.sibling}if(!i)throw Error(W(189))}}if(r.alternate!==a)throw Error(W(190))}if(r.tag!==3)throw Error(W(188));return r.stateNode.current===r?e:t}function fu(e){return e=m0(e),e!==null?yu(e):null}function yu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yu(e);if(t!==null)return t;e=e.sibling}return null}var xu=bt.unstable_scheduleCallback,pc=bt.unstable_cancelCallback,g0=bt.unstable_shouldYield,p0=bt.unstable_requestPaint,Ie=bt.unstable_now,h0=bt.unstable_getCurrentPriorityLevel,al=bt.unstable_ImmediatePriority,bu=bt.unstable_UserBlockingPriority,vs=bt.unstable_NormalPriority,f0=bt.unstable_LowPriority,vu=bt.unstable_IdlePriority,Vs=null,Ut=null;function y0(e){if(Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(Vs,e,void 0,(e.current.flags&128)===128)}catch{}}var _t=Math.clz32?Math.clz32:v0,x0=Math.log,b0=Math.LN2;function v0(e){return e>>>=0,e===0?32:31-(x0(e)/b0|0)|0}var _a=64,$a=4194304;function Yn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ks(e,t){var r=e.pendingLanes;if(r===0)return 0;var a=0,s=e.suspendedLanes,o=e.pingedLanes,i=r&268435455;if(i!==0){var c=i&~s;c!==0?a=Yn(c):(o&=i,o!==0&&(a=Yn(o)))}else i=r&~s,i!==0?a=Yn(i):o!==0&&(a=Yn(o));if(a===0)return 0;if(t!==0&&t!==a&&!(t&s)&&(s=a&-a,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(a&4&&(a|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)r=31-_t(t),s=1<<r,a|=e[r],t&=~s;return a}function k0(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function w0(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-_t(o),c=1<<i,l=s[i];l===-1?(!(c&r)||c&a)&&(s[i]=k0(c,t)):l<=t&&(e.expiredLanes|=c),o&=~c}}function ci(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ku(){var e=_a;return _a<<=1,!(_a&4194240)&&(_a=64),e}function fo(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Da(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_t(t),e[t]=r}function j0(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-_t(r),o=1<<s;t[s]=0,a[s]=-1,e[s]=-1,r&=~o}}function sl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-_t(r),s=1<<a;s&t|e[a]&t&&(e[a]|=t),r&=~s}}var pe=0;function wu(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ju,ol,Nu,Su,Cu,di=!1,Ra=[],pr=null,hr=null,fr=null,da=new Map,ua=new Map,dr=[],N0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hc(e,t){switch(e){case"focusin":case"focusout":pr=null;break;case"dragenter":case"dragleave":hr=null;break;case"mouseover":case"mouseout":fr=null;break;case"pointerover":case"pointerout":da.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ua.delete(t.pointerId)}}function $n(e,t,r,a,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:o,targetContainers:[s]},t!==null&&(t=Ea(t),t!==null&&ol(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function S0(e,t,r,a,s){switch(t){case"focusin":return pr=$n(pr,e,t,r,a,s),!0;case"dragenter":return hr=$n(hr,e,t,r,a,s),!0;case"mouseover":return fr=$n(fr,e,t,r,a,s),!0;case"pointerover":var o=s.pointerId;return da.set(o,$n(da.get(o)||null,e,t,r,a,s)),!0;case"gotpointercapture":return o=s.pointerId,ua.set(o,$n(ua.get(o)||null,e,t,r,a,s)),!0}return!1}function Du(e){var t=$r(e.target);if(t!==null){var r=Kr(t);if(r!==null){if(t=r.tag,t===13){if(t=hu(r),t!==null){e.blockedOn=t,Cu(e.priority,function(){Nu(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function as(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ui(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);si=a,r.target.dispatchEvent(a),si=null}else return t=Ea(r),t!==null&&ol(t),e.blockedOn=r,!1;t.shift()}return!0}function fc(e,t,r){as(e)&&r.delete(t)}function C0(){di=!1,pr!==null&&as(pr)&&(pr=null),hr!==null&&as(hr)&&(hr=null),fr!==null&&as(fr)&&(fr=null),da.forEach(fc),ua.forEach(fc)}function Rn(e,t){e.blockedOn===t&&(e.blockedOn=null,di||(di=!0,bt.unstable_scheduleCallback(bt.unstable_NormalPriority,C0)))}function ma(e){function t(s){return Rn(s,e)}if(0<Ra.length){Rn(Ra[0],e);for(var r=1;r<Ra.length;r++){var a=Ra[r];a.blockedOn===e&&(a.blockedOn=null)}}for(pr!==null&&Rn(pr,e),hr!==null&&Rn(hr,e),fr!==null&&Rn(fr,e),da.forEach(t),ua.forEach(t),r=0;r<dr.length;r++)a=dr[r],a.blockedOn===e&&(a.blockedOn=null);for(;0<dr.length&&(r=dr[0],r.blockedOn===null);)Du(r),r.blockedOn===null&&dr.shift()}var yn=rr.ReactCurrentBatchConfig,ws=!0;function D0(e,t,r,a){var s=pe,o=yn.transition;yn.transition=null;try{pe=1,il(e,t,r,a)}finally{pe=s,yn.transition=o}}function T0(e,t,r,a){var s=pe,o=yn.transition;yn.transition=null;try{pe=4,il(e,t,r,a)}finally{pe=s,yn.transition=o}}function il(e,t,r,a){if(ws){var s=ui(e,t,r,a);if(s===null)Co(e,t,a,js,r),hc(e,a);else if(S0(s,e,t,r,a))a.stopPropagation();else if(hc(e,a),t&4&&-1<N0.indexOf(e)){for(;s!==null;){var o=Ea(s);if(o!==null&&ju(o),o=ui(e,t,r,a),o===null&&Co(e,t,a,js,r),o===s)break;s=o}s!==null&&a.stopPropagation()}else Co(e,t,a,null,r)}}var js=null;function ui(e,t,r,a){if(js=null,e=nl(a),e=$r(e),e!==null)if(t=Kr(e),t===null)e=null;else if(r=t.tag,r===13){if(e=hu(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return js=e,null}function Tu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(h0()){case al:return 1;case bu:return 4;case vs:case f0:return 16;case vu:return 536870912;default:return 16}default:return 16}}var mr=null,ll=null,ss=null;function Eu(){if(ss)return ss;var e,t=ll,r=t.length,a,s="value"in mr?mr.value:mr.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(a=1;a<=i&&t[r-a]===s[o-a];a++);return ss=s.slice(e,1<a?1-a:void 0)}function os(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ba(){return!0}function yc(){return!1}function kt(e){function t(r,a,s,o,i){this._reactName=r,this._targetInst=s,this.type=a,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ba:yc,this.isPropagationStopped=yc,this}return Ne(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),t}var An={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cl=kt(An),Ta=Ne({},An,{view:0,detail:0}),E0=kt(Ta),yo,xo,Bn,Ys=Ne({},Ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bn&&(Bn&&e.type==="mousemove"?(yo=e.screenX-Bn.screenX,xo=e.screenY-Bn.screenY):xo=yo=0,Bn=e),yo)},movementY:function(e){return"movementY"in e?e.movementY:xo}}),xc=kt(Ys),I0=Ne({},Ys,{dataTransfer:0}),P0=kt(I0),A0=Ne({},Ta,{relatedTarget:0}),bo=kt(A0),M0=Ne({},An,{animationName:0,elapsedTime:0,pseudoElement:0}),F0=kt(M0),L0=Ne({},An,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),O0=kt(L0),_0=Ne({},An,{data:0}),bc=kt(_0),$0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},R0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function z0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=B0[e])?!!t[e]:!1}function dl(){return z0}var H0=Ne({},Ta,{key:function(e){if(e.key){var t=$0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=os(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?R0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dl,charCode:function(e){return e.type==="keypress"?os(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?os(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),G0=kt(H0),U0=Ne({},Ys,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vc=kt(U0),q0=Ne({},Ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dl}),W0=kt(q0),V0=Ne({},An,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y0=kt(V0),Q0=Ne({},Ys,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),K0=kt(Q0),J0=[9,13,27,32],ul=Xt&&"CompositionEvent"in window,Xn=null;Xt&&"documentMode"in document&&(Xn=document.documentMode);var X0=Xt&&"TextEvent"in window&&!Xn,Iu=Xt&&(!ul||Xn&&8<Xn&&11>=Xn),kc=" ",wc=!1;function Pu(e,t){switch(e){case"keyup":return J0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Au(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rn=!1;function Z0(e,t){switch(e){case"compositionend":return Au(t);case"keypress":return t.which!==32?null:(wc=!0,kc);case"textInput":return e=t.data,e===kc&&wc?null:e;default:return null}}function ep(e,t){if(rn)return e==="compositionend"||!ul&&Pu(e,t)?(e=Eu(),ss=ll=mr=null,rn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Iu&&t.locale!=="ko"?null:t.data;default:return null}}var tp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!tp[e.type]:t==="textarea"}function Mu(e,t,r,a){du(a),t=Ns(t,"onChange"),0<t.length&&(r=new cl("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var Zn=null,ga=null;function rp(e){Uu(e,0)}function Qs(e){var t=sn(e);if(nu(t))return e}function np(e,t){if(e==="change")return t}var Fu=!1;if(Xt){var vo;if(Xt){var ko="oninput"in document;if(!ko){var Nc=document.createElement("div");Nc.setAttribute("oninput","return;"),ko=typeof Nc.oninput=="function"}vo=ko}else vo=!1;Fu=vo&&(!document.documentMode||9<document.documentMode)}function Sc(){Zn&&(Zn.detachEvent("onpropertychange",Lu),ga=Zn=null)}function Lu(e){if(e.propertyName==="value"&&Qs(ga)){var t=[];Mu(t,ga,e,nl(e)),pu(rp,t)}}function ap(e,t,r){e==="focusin"?(Sc(),Zn=t,ga=r,Zn.attachEvent("onpropertychange",Lu)):e==="focusout"&&Sc()}function sp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Qs(ga)}function op(e,t){if(e==="click")return Qs(t)}function ip(e,t){if(e==="input"||e==="change")return Qs(t)}function lp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rt=typeof Object.is=="function"?Object.is:lp;function pa(e,t){if(Rt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var s=r[a];if(!Vo.call(t,s)||!Rt(e[s],t[s]))return!1}return!0}function Cc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dc(e,t){var r=Cc(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Cc(r)}}function Ou(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ou(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _u(){for(var e=window,t=ys();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ys(e.document)}return t}function ml(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function cp(e){var t=_u(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ou(r.ownerDocument.documentElement,r)){if(a!==null&&ml(r)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(a.start,s);a=a.end===void 0?o:Math.min(a.end,s),!e.extend&&o>a&&(s=a,a=o,o=s),s=Dc(r,o);var i=Dc(r,a);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dp=Xt&&"documentMode"in document&&11>=document.documentMode,nn=null,mi=null,ea=null,gi=!1;function Tc(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;gi||nn==null||nn!==ys(a)||(a=nn,"selectionStart"in a&&ml(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),ea&&pa(ea,a)||(ea=a,a=Ns(mi,"onSelect"),0<a.length&&(t=new cl("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=nn)))}function za(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var an={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionend:za("Transition","TransitionEnd")},wo={},$u={};Xt&&($u=document.createElement("div").style,"AnimationEvent"in window||(delete an.animationend.animation,delete an.animationiteration.animation,delete an.animationstart.animation),"TransitionEvent"in window||delete an.transitionend.transition);function Ks(e){if(wo[e])return wo[e];if(!an[e])return e;var t=an[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in $u)return wo[e]=t[r];return e}var Ru=Ks("animationend"),Bu=Ks("animationiteration"),zu=Ks("animationstart"),Hu=Ks("transitionend"),Gu=new Map,Ec="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Gu.set(e,t),Qr(t,[e])}for(var jo=0;jo<Ec.length;jo++){var No=Ec[jo],up=No.toLowerCase(),mp=No[0].toUpperCase()+No.slice(1);Dr(up,"on"+mp)}Dr(Ru,"onAnimationEnd");Dr(Bu,"onAnimationIteration");Dr(zu,"onAnimationStart");Dr("dblclick","onDoubleClick");Dr("focusin","onFocus");Dr("focusout","onBlur");Dr(Hu,"onTransitionEnd");kn("onMouseEnter",["mouseout","mouseover"]);kn("onMouseLeave",["mouseout","mouseover"]);kn("onPointerEnter",["pointerout","pointerover"]);kn("onPointerLeave",["pointerout","pointerover"]);Qr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qn));function Ic(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,u0(a,t,void 0,e),e.currentTarget=null}function Uu(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],s=a.event;a=a.listeners;e:{var o=void 0;if(t)for(var i=a.length-1;0<=i;i--){var c=a[i],l=c.instance,d=c.currentTarget;if(c=c.listener,l!==o&&s.isPropagationStopped())break e;Ic(s,c,d),o=l}else for(i=0;i<a.length;i++){if(c=a[i],l=c.instance,d=c.currentTarget,c=c.listener,l!==o&&s.isPropagationStopped())break e;Ic(s,c,d),o=l}}}if(bs)throw e=li,bs=!1,li=null,e}function xe(e,t){var r=t[xi];r===void 0&&(r=t[xi]=new Set);var a=e+"__bubble";r.has(a)||(qu(t,e,2,!1),r.add(a))}function So(e,t,r){var a=0;t&&(a|=4),qu(r,e,a,t)}var Ha="_reactListening"+Math.random().toString(36).slice(2);function ha(e){if(!e[Ha]){e[Ha]=!0,Xd.forEach(function(r){r!=="selectionchange"&&(gp.has(r)||So(r,!1,e),So(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ha]||(t[Ha]=!0,So("selectionchange",!1,t))}}function qu(e,t,r,a){switch(Tu(t)){case 1:var s=D0;break;case 4:s=T0;break;default:s=il}r=s.bind(null,t,r,e),s=void 0,!ii||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),a?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Co(e,t,r,a,s){var o=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var i=a.tag;if(i===3||i===4){var c=a.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(i===4)for(i=a.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;c!==null;){if(i=$r(c),i===null)return;if(l=i.tag,l===5||l===6){a=o=i;continue e}c=c.parentNode}}a=a.return}pu(function(){var d=o,h=nl(r),u=[];e:{var f=Gu.get(e);if(f!==void 0){var g=cl,m=e;switch(e){case"keypress":if(os(r)===0)break e;case"keydown":case"keyup":g=G0;break;case"focusin":m="focus",g=bo;break;case"focusout":m="blur",g=bo;break;case"beforeblur":case"afterblur":g=bo;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=xc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=P0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=W0;break;case Ru:case Bu:case zu:g=F0;break;case Hu:g=Y0;break;case"scroll":g=E0;break;case"wheel":g=K0;break;case"copy":case"cut":case"paste":g=O0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=vc}var v=(t&4)!==0,D=!v&&e==="scroll",y=v?f!==null?f+"Capture":null:f;v=[];for(var p=d,x;p!==null;){x=p;var k=x.stateNode;if(x.tag===5&&k!==null&&(x=k,y!==null&&(k=ca(p,y),k!=null&&v.push(fa(p,k,x)))),D)break;p=p.return}0<v.length&&(f=new g(f,m,null,r,h),u.push({event:f,listeners:v}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",f&&r!==si&&(m=r.relatedTarget||r.fromElement)&&($r(m)||m[Zt]))break e;if((g||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,g?(m=r.relatedTarget||r.toElement,g=d,m=m?$r(m):null,m!==null&&(D=Kr(m),m!==D||m.tag!==5&&m.tag!==6)&&(m=null)):(g=null,m=d),g!==m)){if(v=xc,k="onMouseLeave",y="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(v=vc,k="onPointerLeave",y="onPointerEnter",p="pointer"),D=g==null?f:sn(g),x=m==null?f:sn(m),f=new v(k,p+"leave",g,r,h),f.target=D,f.relatedTarget=x,k=null,$r(h)===d&&(v=new v(y,p+"enter",m,r,h),v.target=x,v.relatedTarget=D,k=v),D=k,g&&m)t:{for(v=g,y=m,p=0,x=v;x;x=Xr(x))p++;for(x=0,k=y;k;k=Xr(k))x++;for(;0<p-x;)v=Xr(v),p--;for(;0<x-p;)y=Xr(y),x--;for(;p--;){if(v===y||y!==null&&v===y.alternate)break t;v=Xr(v),y=Xr(y)}v=null}else v=null;g!==null&&Pc(u,f,g,v,!1),m!==null&&D!==null&&Pc(u,D,m,v,!0)}}e:{if(f=d?sn(d):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var C=np;else if(jc(f))if(Fu)C=ip;else{C=sp;var T=ap}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=op);if(C&&(C=C(e,d))){Mu(u,C,r,h);break e}T&&T(e,f,d),e==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&ei(f,"number",f.value)}switch(T=d?sn(d):window,e){case"focusin":(jc(T)||T.contentEditable==="true")&&(nn=T,mi=d,ea=null);break;case"focusout":ea=mi=nn=null;break;case"mousedown":gi=!0;break;case"contextmenu":case"mouseup":case"dragend":gi=!1,Tc(u,r,h);break;case"selectionchange":if(dp)break;case"keydown":case"keyup":Tc(u,r,h)}var b;if(ul)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else rn?Pu(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(Iu&&r.locale!=="ko"&&(rn||j!=="onCompositionStart"?j==="onCompositionEnd"&&rn&&(b=Eu()):(mr=h,ll="value"in mr?mr.value:mr.textContent,rn=!0)),T=Ns(d,j),0<T.length&&(j=new bc(j,e,null,r,h),u.push({event:j,listeners:T}),b?j.data=b:(b=Au(r),b!==null&&(j.data=b)))),(b=X0?Z0(e,r):ep(e,r))&&(d=Ns(d,"onBeforeInput"),0<d.length&&(h=new bc("onBeforeInput","beforeinput",null,r,h),u.push({event:h,listeners:d}),h.data=b))}Uu(u,t)})}function fa(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ns(e,t){for(var r=t+"Capture",a=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=ca(e,r),o!=null&&a.unshift(fa(e,o,s)),o=ca(e,t),o!=null&&a.push(fa(e,o,s))),e=e.return}return a}function Xr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Pc(e,t,r,a,s){for(var o=t._reactName,i=[];r!==null&&r!==a;){var c=r,l=c.alternate,d=c.stateNode;if(l!==null&&l===a)break;c.tag===5&&d!==null&&(c=d,s?(l=ca(r,o),l!=null&&i.unshift(fa(r,l,c))):s||(l=ca(r,o),l!=null&&i.push(fa(r,l,c)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var pp=/\r\n?/g,hp=/\u0000|\uFFFD/g;function Ac(e){return(typeof e=="string"?e:""+e).replace(pp,`
`).replace(hp,"")}function Ga(e,t,r){if(t=Ac(t),Ac(e)!==t&&r)throw Error(W(425))}function Ss(){}var pi=null,hi=null;function fi(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var yi=typeof setTimeout=="function"?setTimeout:void 0,fp=typeof clearTimeout=="function"?clearTimeout:void 0,Mc=typeof Promise=="function"?Promise:void 0,yp=typeof queueMicrotask=="function"?queueMicrotask:typeof Mc<"u"?function(e){return Mc.resolve(null).then(e).catch(xp)}:yi;function xp(e){setTimeout(function(){throw e})}function Do(e,t){var r=t,a=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(a===0){e.removeChild(s),ma(t);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=s}while(r);ma(t)}function yr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Mn=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Mn,ya="__reactProps$"+Mn,Zt="__reactContainer$"+Mn,xi="__reactEvents$"+Mn,bp="__reactListeners$"+Mn,vp="__reactHandles$"+Mn;function $r(e){var t=e[Gt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Zt]||r[Gt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Fc(e);e!==null;){if(r=e[Gt])return r;e=Fc(e)}return t}e=r,r=e.parentNode}return null}function Ea(e){return e=e[Gt]||e[Zt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function Js(e){return e[ya]||null}var bi=[],on=-1;function Tr(e){return{current:e}}function be(e){0>on||(e.current=bi[on],bi[on]=null,on--)}function fe(e,t){on++,bi[on]=e.current,e.current=t}var Nr={},Je=Tr(Nr),lt=Tr(!1),Ur=Nr;function wn(e,t){var r=e.type.contextTypes;if(!r)return Nr;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ct(e){return e=e.childContextTypes,e!=null}function Cs(){be(lt),be(Je)}function Lc(e,t,r){if(Je.current!==Nr)throw Error(W(168));fe(Je,t),fe(lt,r)}function Wu(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return r;a=a.getChildContext();for(var s in a)if(!(s in t))throw Error(W(108,a0(e)||"Unknown",s));return Ne({},r,a)}function Ds(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nr,Ur=Je.current,fe(Je,e),fe(lt,lt.current),!0}function Oc(e,t,r){var a=e.stateNode;if(!a)throw Error(W(169));r?(e=Wu(e,t,Ur),a.__reactInternalMemoizedMergedChildContext=e,be(lt),be(Je),fe(Je,e)):be(lt),fe(lt,r)}var Yt=null,Xs=!1,To=!1;function Vu(e){Yt===null?Yt=[e]:Yt.push(e)}function kp(e){Xs=!0,Vu(e)}function Er(){if(!To&&Yt!==null){To=!0;var e=0,t=pe;try{var r=Yt;for(pe=1;e<r.length;e++){var a=r[e];do a=a(!0);while(a!==null)}Yt=null,Xs=!1}catch(s){throw Yt!==null&&(Yt=Yt.slice(e+1)),xu(al,Er),s}finally{pe=t,To=!1}}return null}var ln=[],cn=0,Ts=null,Es=0,jt=[],Nt=0,qr=null,Qt=1,Kt="";function Lr(e,t){ln[cn++]=Es,ln[cn++]=Ts,Ts=e,Es=t}function Yu(e,t,r){jt[Nt++]=Qt,jt[Nt++]=Kt,jt[Nt++]=qr,qr=e;var a=Qt;e=Kt;var s=32-_t(a)-1;a&=~(1<<s),r+=1;var o=32-_t(t)+s;if(30<o){var i=s-s%5;o=(a&(1<<i)-1).toString(32),a>>=i,s-=i,Qt=1<<32-_t(t)+s|r<<s|a,Kt=o+e}else Qt=1<<o|r<<s|a,Kt=e}function gl(e){e.return!==null&&(Lr(e,1),Yu(e,1,0))}function pl(e){for(;e===Ts;)Ts=ln[--cn],ln[cn]=null,Es=ln[--cn],ln[cn]=null;for(;e===qr;)qr=jt[--Nt],jt[Nt]=null,Kt=jt[--Nt],jt[Nt]=null,Qt=jt[--Nt],jt[Nt]=null}var xt=null,ht=null,ve=!1,Ot=null;function Qu(e,t){var r=Ct(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _c(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xt=e,ht=yr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xt=e,ht=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=qr!==null?{id:Qt,overflow:Kt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ct(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,xt=e,ht=null,!0):!1;default:return!1}}function vi(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ki(e){if(ve){var t=ht;if(t){var r=t;if(!_c(e,t)){if(vi(e))throw Error(W(418));t=yr(r.nextSibling);var a=xt;t&&_c(e,t)?Qu(a,r):(e.flags=e.flags&-4097|2,ve=!1,xt=e)}}else{if(vi(e))throw Error(W(418));e.flags=e.flags&-4097|2,ve=!1,xt=e}}}function $c(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xt=e}function Ua(e){if(e!==xt)return!1;if(!ve)return $c(e),ve=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fi(e.type,e.memoizedProps)),t&&(t=ht)){if(vi(e))throw Ku(),Error(W(418));for(;t;)Qu(e,t),t=yr(t.nextSibling)}if($c(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ht=yr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ht=null}}else ht=xt?yr(e.stateNode.nextSibling):null;return!0}function Ku(){for(var e=ht;e;)e=yr(e.nextSibling)}function jn(){ht=xt=null,ve=!1}function hl(e){Ot===null?Ot=[e]:Ot.push(e)}var wp=rr.ReactCurrentBatchConfig;function zn(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(W(309));var a=r.stateNode}if(!a)throw Error(W(147,e));var s=a,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var c=s.refs;i===null?delete c[o]:c[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(W(284));if(!r._owner)throw Error(W(290,e))}return e}function qa(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Rc(e){var t=e._init;return t(e._payload)}function Ju(e){function t(y,p){if(e){var x=y.deletions;x===null?(y.deletions=[p],y.flags|=16):x.push(p)}}function r(y,p){if(!e)return null;for(;p!==null;)t(y,p),p=p.sibling;return null}function a(y,p){for(y=new Map;p!==null;)p.key!==null?y.set(p.key,p):y.set(p.index,p),p=p.sibling;return y}function s(y,p){return y=kr(y,p),y.index=0,y.sibling=null,y}function o(y,p,x){return y.index=x,e?(x=y.alternate,x!==null?(x=x.index,x<p?(y.flags|=2,p):x):(y.flags|=2,p)):(y.flags|=1048576,p)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function c(y,p,x,k){return p===null||p.tag!==6?(p=Lo(x,y.mode,k),p.return=y,p):(p=s(p,x),p.return=y,p)}function l(y,p,x,k){var C=x.type;return C===tn?h(y,p,x.props.children,k,x.key):p!==null&&(p.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===lr&&Rc(C)===p.type)?(k=s(p,x.props),k.ref=zn(y,p,x),k.return=y,k):(k=gs(x.type,x.key,x.props,null,y.mode,k),k.ref=zn(y,p,x),k.return=y,k)}function d(y,p,x,k){return p===null||p.tag!==4||p.stateNode.containerInfo!==x.containerInfo||p.stateNode.implementation!==x.implementation?(p=Oo(x,y.mode,k),p.return=y,p):(p=s(p,x.children||[]),p.return=y,p)}function h(y,p,x,k,C){return p===null||p.tag!==7?(p=Gr(x,y.mode,k,C),p.return=y,p):(p=s(p,x),p.return=y,p)}function u(y,p,x){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Lo(""+p,y.mode,x),p.return=y,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Fa:return x=gs(p.type,p.key,p.props,null,y.mode,x),x.ref=zn(y,null,p),x.return=y,x;case en:return p=Oo(p,y.mode,x),p.return=y,p;case lr:var k=p._init;return u(y,k(p._payload),x)}if(Vn(p)||On(p))return p=Gr(p,y.mode,x,null),p.return=y,p;qa(y,p)}return null}function f(y,p,x,k){var C=p!==null?p.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return C!==null?null:c(y,p,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Fa:return x.key===C?l(y,p,x,k):null;case en:return x.key===C?d(y,p,x,k):null;case lr:return C=x._init,f(y,p,C(x._payload),k)}if(Vn(x)||On(x))return C!==null?null:h(y,p,x,k,null);qa(y,x)}return null}function g(y,p,x,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return y=y.get(x)||null,c(p,y,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Fa:return y=y.get(k.key===null?x:k.key)||null,l(p,y,k,C);case en:return y=y.get(k.key===null?x:k.key)||null,d(p,y,k,C);case lr:var T=k._init;return g(y,p,x,T(k._payload),C)}if(Vn(k)||On(k))return y=y.get(x)||null,h(p,y,k,C,null);qa(p,k)}return null}function m(y,p,x,k){for(var C=null,T=null,b=p,j=p=0,S=null;b!==null&&j<x.length;j++){b.index>j?(S=b,b=null):S=b.sibling;var w=f(y,b,x[j],k);if(w===null){b===null&&(b=S);break}e&&b&&w.alternate===null&&t(y,b),p=o(w,p,j),T===null?C=w:T.sibling=w,T=w,b=S}if(j===x.length)return r(y,b),ve&&Lr(y,j),C;if(b===null){for(;j<x.length;j++)b=u(y,x[j],k),b!==null&&(p=o(b,p,j),T===null?C=b:T.sibling=b,T=b);return ve&&Lr(y,j),C}for(b=a(y,b);j<x.length;j++)S=g(b,y,j,x[j],k),S!==null&&(e&&S.alternate!==null&&b.delete(S.key===null?j:S.key),p=o(S,p,j),T===null?C=S:T.sibling=S,T=S);return e&&b.forEach(function(_){return t(y,_)}),ve&&Lr(y,j),C}function v(y,p,x,k){var C=On(x);if(typeof C!="function")throw Error(W(150));if(x=C.call(x),x==null)throw Error(W(151));for(var T=C=null,b=p,j=p=0,S=null,w=x.next();b!==null&&!w.done;j++,w=x.next()){b.index>j?(S=b,b=null):S=b.sibling;var _=f(y,b,w.value,k);if(_===null){b===null&&(b=S);break}e&&b&&_.alternate===null&&t(y,b),p=o(_,p,j),T===null?C=_:T.sibling=_,T=_,b=S}if(w.done)return r(y,b),ve&&Lr(y,j),C;if(b===null){for(;!w.done;j++,w=x.next())w=u(y,w.value,k),w!==null&&(p=o(w,p,j),T===null?C=w:T.sibling=w,T=w);return ve&&Lr(y,j),C}for(b=a(y,b);!w.done;j++,w=x.next())w=g(b,y,j,w.value,k),w!==null&&(e&&w.alternate!==null&&b.delete(w.key===null?j:w.key),p=o(w,p,j),T===null?C=w:T.sibling=w,T=w);return e&&b.forEach(function(M){return t(y,M)}),ve&&Lr(y,j),C}function D(y,p,x,k){if(typeof x=="object"&&x!==null&&x.type===tn&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Fa:e:{for(var C=x.key,T=p;T!==null;){if(T.key===C){if(C=x.type,C===tn){if(T.tag===7){r(y,T.sibling),p=s(T,x.props.children),p.return=y,y=p;break e}}else if(T.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===lr&&Rc(C)===T.type){r(y,T.sibling),p=s(T,x.props),p.ref=zn(y,T,x),p.return=y,y=p;break e}r(y,T);break}else t(y,T);T=T.sibling}x.type===tn?(p=Gr(x.props.children,y.mode,k,x.key),p.return=y,y=p):(k=gs(x.type,x.key,x.props,null,y.mode,k),k.ref=zn(y,p,x),k.return=y,y=k)}return i(y);case en:e:{for(T=x.key;p!==null;){if(p.key===T)if(p.tag===4&&p.stateNode.containerInfo===x.containerInfo&&p.stateNode.implementation===x.implementation){r(y,p.sibling),p=s(p,x.children||[]),p.return=y,y=p;break e}else{r(y,p);break}else t(y,p);p=p.sibling}p=Oo(x,y.mode,k),p.return=y,y=p}return i(y);case lr:return T=x._init,D(y,p,T(x._payload),k)}if(Vn(x))return m(y,p,x,k);if(On(x))return v(y,p,x,k);qa(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,p!==null&&p.tag===6?(r(y,p.sibling),p=s(p,x),p.return=y,y=p):(r(y,p),p=Lo(x,y.mode,k),p.return=y,y=p),i(y)):r(y,p)}return D}var Nn=Ju(!0),Xu=Ju(!1),Is=Tr(null),Ps=null,dn=null,fl=null;function yl(){fl=dn=Ps=null}function xl(e){var t=Is.current;be(Is),e._currentValue=t}function wi(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function xn(e,t){Ps=e,fl=dn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(it=!0),e.firstContext=null)}function Et(e){var t=e._currentValue;if(fl!==e)if(e={context:e,memoizedValue:t,next:null},dn===null){if(Ps===null)throw Error(W(308));dn=e,Ps.dependencies={lanes:0,firstContext:e}}else dn=dn.next=e;return t}var Rr=null;function bl(e){Rr===null?Rr=[e]:Rr.push(e)}function Zu(e,t,r,a){var s=t.interleaved;return s===null?(r.next=r,bl(t)):(r.next=s.next,s.next=r),t.interleaved=r,er(e,a)}function er(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var cr=!1;function vl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function em(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Jt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xr(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,de&2){var s=a.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),a.pending=t,er(e,r)}return s=a.interleaved,s===null?(t.next=t,bl(a)):(t.next=s.next,s.next=t),a.interleaved=t,er(e,r)}function is(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,sl(e,r)}}function Bc(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:a.shared,effects:a.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function As(e,t,r,a){var s=e.updateQueue;cr=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var l=c,d=l.next;l.next=null,i===null?o=d:i.next=d,i=l;var h=e.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==i&&(c===null?h.firstBaseUpdate=d:c.next=d,h.lastBaseUpdate=l))}if(o!==null){var u=s.baseState;i=0,h=d=l=null,c=o;do{var f=c.lane,g=c.eventTime;if((a&f)===f){h!==null&&(h=h.next={eventTime:g,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var m=e,v=c;switch(f=t,g=r,v.tag){case 1:if(m=v.payload,typeof m=="function"){u=m.call(g,u,f);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,f=typeof m=="function"?m.call(g,u,f):m,f==null)break e;u=Ne({},u,f);break e;case 2:cr=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[c]:f.push(c))}else g={eventTime:g,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(d=h=g,l=u):h=h.next=g,i|=f;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;f=c,c=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(h===null&&(l=u),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Vr|=i,e.lanes=i,e.memoizedState=u}}function zc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],s=a.callback;if(s!==null){if(a.callback=null,a=r,typeof s!="function")throw Error(W(191,s));s.call(a)}}}var Ia={},qt=Tr(Ia),xa=Tr(Ia),ba=Tr(Ia);function Br(e){if(e===Ia)throw Error(W(174));return e}function kl(e,t){switch(fe(ba,t),fe(xa,e),fe(qt,Ia),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ri(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ri(t,e)}be(qt),fe(qt,t)}function Sn(){be(qt),be(xa),be(ba)}function tm(e){Br(ba.current);var t=Br(qt.current),r=ri(t,e.type);t!==r&&(fe(xa,e),fe(qt,r))}function wl(e){xa.current===e&&(be(qt),be(xa))}var we=Tr(0);function Ms(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Eo=[];function jl(){for(var e=0;e<Eo.length;e++)Eo[e]._workInProgressVersionPrimary=null;Eo.length=0}var ls=rr.ReactCurrentDispatcher,Io=rr.ReactCurrentBatchConfig,Wr=0,je=null,Le=null,Be=null,Fs=!1,ta=!1,va=0,jp=0;function We(){throw Error(W(321))}function Nl(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rt(e[r],t[r]))return!1;return!0}function Sl(e,t,r,a,s,o){if(Wr=o,je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ls.current=e===null||e.memoizedState===null?Dp:Tp,e=r(a,s),ta){o=0;do{if(ta=!1,va=0,25<=o)throw Error(W(301));o+=1,Be=Le=null,t.updateQueue=null,ls.current=Ep,e=r(a,s)}while(ta)}if(ls.current=Ls,t=Le!==null&&Le.next!==null,Wr=0,Be=Le=je=null,Fs=!1,t)throw Error(W(300));return e}function Cl(){var e=va!==0;return va=0,e}function Ht(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?je.memoizedState=Be=e:Be=Be.next=e,Be}function It(){if(Le===null){var e=je.alternate;e=e!==null?e.memoizedState:null}else e=Le.next;var t=Be===null?je.memoizedState:Be.next;if(t!==null)Be=t,Le=e;else{if(e===null)throw Error(W(310));Le=e,e={memoizedState:Le.memoizedState,baseState:Le.baseState,baseQueue:Le.baseQueue,queue:Le.queue,next:null},Be===null?je.memoizedState=Be=e:Be=Be.next=e}return Be}function ka(e,t){return typeof t=="function"?t(e):t}function Po(e){var t=It(),r=t.queue;if(r===null)throw Error(W(311));r.lastRenderedReducer=e;var a=Le,s=a.baseQueue,o=r.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}a.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,a=a.baseState;var c=i=null,l=null,d=o;do{var h=d.lane;if((Wr&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(c=l=u,i=a):l=l.next=u,je.lanes|=h,Vr|=h}d=d.next}while(d!==null&&d!==o);l===null?i=a:l.next=c,Rt(a,t.memoizedState)||(it=!0),t.memoizedState=a,t.baseState=i,t.baseQueue=l,r.lastRenderedState=a}if(e=r.interleaved,e!==null){s=e;do o=s.lane,je.lanes|=o,Vr|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ao(e){var t=It(),r=t.queue;if(r===null)throw Error(W(311));r.lastRenderedReducer=e;var a=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);Rt(o,t.memoizedState)||(it=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,a]}function rm(){}function nm(e,t){var r=je,a=It(),s=t(),o=!Rt(a.memoizedState,s);if(o&&(a.memoizedState=s,it=!0),a=a.queue,Dl(om.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||Be!==null&&Be.memoizedState.tag&1){if(r.flags|=2048,wa(9,sm.bind(null,r,a,s,t),void 0,null),ze===null)throw Error(W(349));Wr&30||am(r,t,s)}return s}function am(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=je.updateQueue,t===null?(t={lastEffect:null,stores:null},je.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function sm(e,t,r,a){t.value=r,t.getSnapshot=a,im(t)&&lm(e)}function om(e,t,r){return r(function(){im(t)&&lm(e)})}function im(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rt(e,r)}catch{return!0}}function lm(e){var t=er(e,1);t!==null&&$t(t,e,1,-1)}function Hc(e){var t=Ht();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:e},t.queue=e,e=e.dispatch=Cp.bind(null,je,e),[t.memoizedState,e]}function wa(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},t=je.updateQueue,t===null?(t={lastEffect:null,stores:null},je.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e)),e}function cm(){return It().memoizedState}function cs(e,t,r,a){var s=Ht();je.flags|=e,s.memoizedState=wa(1|t,r,void 0,a===void 0?null:a)}function Zs(e,t,r,a){var s=It();a=a===void 0?null:a;var o=void 0;if(Le!==null){var i=Le.memoizedState;if(o=i.destroy,a!==null&&Nl(a,i.deps)){s.memoizedState=wa(t,r,o,a);return}}je.flags|=e,s.memoizedState=wa(1|t,r,o,a)}function Gc(e,t){return cs(8390656,8,e,t)}function Dl(e,t){return Zs(2048,8,e,t)}function dm(e,t){return Zs(4,2,e,t)}function um(e,t){return Zs(4,4,e,t)}function mm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gm(e,t,r){return r=r!=null?r.concat([e]):null,Zs(4,4,mm.bind(null,t,e),r)}function Tl(){}function pm(e,t){var r=It();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Nl(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function hm(e,t){var r=It();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Nl(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function fm(e,t,r){return Wr&21?(Rt(r,t)||(r=ku(),je.lanes|=r,Vr|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,it=!0),e.memoizedState=r)}function Np(e,t){var r=pe;pe=r!==0&&4>r?r:4,e(!0);var a=Io.transition;Io.transition={};try{e(!1),t()}finally{pe=r,Io.transition=a}}function ym(){return It().memoizedState}function Sp(e,t,r){var a=vr(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},xm(e))bm(t,r);else if(r=Zu(e,t,r,a),r!==null){var s=et();$t(r,e,a,s),vm(r,t,a)}}function Cp(e,t,r){var a=vr(e),s={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(xm(e))bm(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,c=o(i,r);if(s.hasEagerState=!0,s.eagerState=c,Rt(c,i)){var l=t.interleaved;l===null?(s.next=s,bl(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=Zu(e,t,s,a),r!==null&&(s=et(),$t(r,e,a,s),vm(r,t,a))}}function xm(e){var t=e.alternate;return e===je||t!==null&&t===je}function bm(e,t){ta=Fs=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vm(e,t,r){if(r&4194240){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,sl(e,r)}}var Ls={readContext:Et,useCallback:We,useContext:We,useEffect:We,useImperativeHandle:We,useInsertionEffect:We,useLayoutEffect:We,useMemo:We,useReducer:We,useRef:We,useState:We,useDebugValue:We,useDeferredValue:We,useTransition:We,useMutableSource:We,useSyncExternalStore:We,useId:We,unstable_isNewReconciler:!1},Dp={readContext:Et,useCallback:function(e,t){return Ht().memoizedState=[e,t===void 0?null:t],e},useContext:Et,useEffect:Gc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,cs(4194308,4,mm.bind(null,t,e),r)},useLayoutEffect:function(e,t){return cs(4194308,4,e,t)},useInsertionEffect:function(e,t){return cs(4,2,e,t)},useMemo:function(e,t){var r=Ht();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=Ht();return t=r!==void 0?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Sp.bind(null,je,e),[a.memoizedState,e]},useRef:function(e){var t=Ht();return e={current:e},t.memoizedState=e},useState:Hc,useDebugValue:Tl,useDeferredValue:function(e){return Ht().memoizedState=e},useTransition:function(){var e=Hc(!1),t=e[0];return e=Np.bind(null,e[1]),Ht().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=je,s=Ht();if(ve){if(r===void 0)throw Error(W(407));r=r()}else{if(r=t(),ze===null)throw Error(W(349));Wr&30||am(a,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,Gc(om.bind(null,a,o,e),[e]),a.flags|=2048,wa(9,sm.bind(null,a,o,r,t),void 0,null),r},useId:function(){var e=Ht(),t=ze.identifierPrefix;if(ve){var r=Kt,a=Qt;r=(a&~(1<<32-_t(a)-1)).toString(32)+r,t=":"+t+"R"+r,r=va++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=jp++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tp={readContext:Et,useCallback:pm,useContext:Et,useEffect:Dl,useImperativeHandle:gm,useInsertionEffect:dm,useLayoutEffect:um,useMemo:hm,useReducer:Po,useRef:cm,useState:function(){return Po(ka)},useDebugValue:Tl,useDeferredValue:function(e){var t=It();return fm(t,Le.memoizedState,e)},useTransition:function(){var e=Po(ka)[0],t=It().memoizedState;return[e,t]},useMutableSource:rm,useSyncExternalStore:nm,useId:ym,unstable_isNewReconciler:!1},Ep={readContext:Et,useCallback:pm,useContext:Et,useEffect:Dl,useImperativeHandle:gm,useInsertionEffect:dm,useLayoutEffect:um,useMemo:hm,useReducer:Ao,useRef:cm,useState:function(){return Ao(ka)},useDebugValue:Tl,useDeferredValue:function(e){var t=It();return Le===null?t.memoizedState=e:fm(t,Le.memoizedState,e)},useTransition:function(){var e=Ao(ka)[0],t=It().memoizedState;return[e,t]},useMutableSource:rm,useSyncExternalStore:nm,useId:ym,unstable_isNewReconciler:!1};function Ft(e,t){if(e&&e.defaultProps){t=Ne({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ji(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:Ne({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var eo={isMounted:function(e){return(e=e._reactInternals)?Kr(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=et(),s=vr(e),o=Jt(a,s);o.payload=t,r!=null&&(o.callback=r),t=xr(e,o,s),t!==null&&($t(t,e,s,a),is(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=et(),s=vr(e),o=Jt(a,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=xr(e,o,s),t!==null&&($t(t,e,s,a),is(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=et(),a=vr(e),s=Jt(r,a);s.tag=2,t!=null&&(s.callback=t),t=xr(e,s,a),t!==null&&($t(t,e,a,r),is(t,e,a))}};function Uc(e,t,r,a,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,o,i):t.prototype&&t.prototype.isPureReactComponent?!pa(r,a)||!pa(s,o):!0}function km(e,t,r){var a=!1,s=Nr,o=t.contextType;return typeof o=="object"&&o!==null?o=Et(o):(s=ct(t)?Ur:Je.current,a=t.contextTypes,o=(a=a!=null)?wn(e,s):Nr),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=eo,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function qc(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&eo.enqueueReplaceState(t,t.state,null)}function Ni(e,t,r,a){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},vl(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Et(o):(o=ct(t)?Ur:Je.current,s.context=wn(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(ji(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&eo.enqueueReplaceState(s,s.state,null),As(e,r,s,a),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Cn(e,t){try{var r="",a=t;do r+=n0(a),a=a.return;while(a);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function Mo(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Si(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ip=typeof WeakMap=="function"?WeakMap:Map;function wm(e,t,r){r=Jt(-1,r),r.tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){_s||(_s=!0,Li=a),Si(e,t)},r}function jm(e,t,r){r=Jt(-1,r),r.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var s=t.value;r.payload=function(){return a(s)},r.callback=function(){Si(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){Si(e,t),typeof a!="function"&&(br===null?br=new Set([this]):br.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Wc(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new Ip;var s=new Set;a.set(t,s)}else s=a.get(t),s===void 0&&(s=new Set,a.set(t,s));s.has(r)||(s.add(r),e=Up.bind(null,e,t,r),t.then(e,e))}function Vc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Yc(e,t,r,a,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Jt(-1,1),t.tag=2,xr(r,t,1))),r.lanes|=1),e)}var Pp=rr.ReactCurrentOwner,it=!1;function Ze(e,t,r,a){t.child=e===null?Xu(t,null,r,a):Nn(t,e.child,r,a)}function Qc(e,t,r,a,s){r=r.render;var o=t.ref;return xn(t,s),a=Sl(e,t,r,a,o,s),r=Cl(),e!==null&&!it?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,tr(e,t,s)):(ve&&r&&gl(t),t.flags|=1,Ze(e,t,a,s),t.child)}function Kc(e,t,r,a,s){if(e===null){var o=r.type;return typeof o=="function"&&!Ol(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,Nm(e,t,o,a,s)):(e=gs(r.type,null,a,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:pa,r(i,a)&&e.ref===t.ref)return tr(e,t,s)}return t.flags|=1,e=kr(o,a),e.ref=t.ref,e.return=t,t.child=e}function Nm(e,t,r,a,s){if(e!==null){var o=e.memoizedProps;if(pa(o,a)&&e.ref===t.ref)if(it=!1,t.pendingProps=a=o,(e.lanes&s)!==0)e.flags&131072&&(it=!0);else return t.lanes=e.lanes,tr(e,t,s)}return Ci(e,t,r,a,s)}function Sm(e,t,r){var a=t.pendingProps,s=a.children,o=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},fe(mn,pt),pt|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,fe(mn,pt),pt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=o!==null?o.baseLanes:r,fe(mn,pt),pt|=a}else o!==null?(a=o.baseLanes|r,t.memoizedState=null):a=r,fe(mn,pt),pt|=a;return Ze(e,t,s,r),t.child}function Cm(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ci(e,t,r,a,s){var o=ct(r)?Ur:Je.current;return o=wn(t,o),xn(t,s),r=Sl(e,t,r,a,o,s),a=Cl(),e!==null&&!it?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,tr(e,t,s)):(ve&&a&&gl(t),t.flags|=1,Ze(e,t,r,s),t.child)}function Jc(e,t,r,a,s){if(ct(r)){var o=!0;Ds(t)}else o=!1;if(xn(t,s),t.stateNode===null)ds(e,t),km(t,r,a),Ni(t,r,a,s),a=!0;else if(e===null){var i=t.stateNode,c=t.memoizedProps;i.props=c;var l=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=Et(d):(d=ct(r)?Ur:Je.current,d=wn(t,d));var h=r.getDerivedStateFromProps,u=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function";u||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(c!==a||l!==d)&&qc(t,i,a,d),cr=!1;var f=t.memoizedState;i.state=f,As(t,a,i,s),l=t.memoizedState,c!==a||f!==l||lt.current||cr?(typeof h=="function"&&(ji(t,r,h,a),l=t.memoizedState),(c=cr||Uc(t,r,c,a,f,l,d))?(u||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),i.props=a,i.state=l,i.context=d,a=c):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,em(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:Ft(t.type,c),i.props=d,u=t.pendingProps,f=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Et(l):(l=ct(r)?Ur:Je.current,l=wn(t,l));var g=r.getDerivedStateFromProps;(h=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(c!==u||f!==l)&&qc(t,i,a,l),cr=!1,f=t.memoizedState,i.state=f,As(t,a,i,s);var m=t.memoizedState;c!==u||f!==m||lt.current||cr?(typeof g=="function"&&(ji(t,r,g,a),m=t.memoizedState),(d=cr||Uc(t,r,d,a,f,m,l)||!1)?(h||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(a,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(a,m,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=m),i.props=a,i.state=m,i.context=l,a=d):(typeof i.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),a=!1)}return Di(e,t,r,a,o,s)}function Di(e,t,r,a,s,o){Cm(e,t);var i=(t.flags&128)!==0;if(!a&&!i)return s&&Oc(t,r,!1),tr(e,t,o);a=t.stateNode,Pp.current=t;var c=i&&typeof r.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&i?(t.child=Nn(t,e.child,null,o),t.child=Nn(t,null,c,o)):Ze(e,t,c,o),t.memoizedState=a.state,s&&Oc(t,r,!0),t.child}function Dm(e){var t=e.stateNode;t.pendingContext?Lc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lc(e,t.context,!1),kl(e,t.containerInfo)}function Xc(e,t,r,a,s){return jn(),hl(s),t.flags|=256,Ze(e,t,r,a),t.child}var Ti={dehydrated:null,treeContext:null,retryLane:0};function Ei(e){return{baseLanes:e,cachePool:null,transitions:null}}function Tm(e,t,r){var a=t.pendingProps,s=we.current,o=!1,i=(t.flags&128)!==0,c;if((c=i)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),fe(we,s&1),e===null)return ki(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=a.children,e=a.fallback,o?(a=t.mode,o=t.child,i={mode:"hidden",children:i},!(a&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=no(i,a,0,null),e=Gr(e,a,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Ei(r),t.memoizedState=Ti,e):El(t,i));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Ap(e,t,i,a,c,s,r);if(o){o=a.fallback,i=t.mode,s=e.child,c=s.sibling;var l={mode:"hidden",children:a.children};return!(i&1)&&t.child!==s?(a=t.child,a.childLanes=0,a.pendingProps=l,t.deletions=null):(a=kr(s,l),a.subtreeFlags=s.subtreeFlags&14680064),c!==null?o=kr(c,o):(o=Gr(o,i,r,null),o.flags|=2),o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,i=e.child.memoizedState,i=i===null?Ei(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~r,t.memoizedState=Ti,a}return o=e.child,e=o.sibling,a=kr(o,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=r),a.return=t,a.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function El(e,t){return t=no({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wa(e,t,r,a){return a!==null&&hl(a),Nn(t,e.child,null,r),e=El(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ap(e,t,r,a,s,o,i){if(r)return t.flags&256?(t.flags&=-257,a=Mo(Error(W(422))),Wa(e,t,i,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=a.fallback,s=t.mode,a=no({mode:"visible",children:a.children},s,0,null),o=Gr(o,s,i,null),o.flags|=2,a.return=t,o.return=t,a.sibling=o,t.child=a,t.mode&1&&Nn(t,e.child,null,i),t.child.memoizedState=Ei(i),t.memoizedState=Ti,o);if(!(t.mode&1))return Wa(e,t,i,null);if(s.data==="$!"){if(a=s.nextSibling&&s.nextSibling.dataset,a)var c=a.dgst;return a=c,o=Error(W(419)),a=Mo(o,a,void 0),Wa(e,t,i,a)}if(c=(i&e.childLanes)!==0,it||c){if(a=ze,a!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(a.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,er(e,s),$t(a,e,s,-1))}return Ll(),a=Mo(Error(W(421))),Wa(e,t,i,a)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=qp.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,ht=yr(s.nextSibling),xt=t,ve=!0,Ot=null,e!==null&&(jt[Nt++]=Qt,jt[Nt++]=Kt,jt[Nt++]=qr,Qt=e.id,Kt=e.overflow,qr=t),t=El(t,a.children),t.flags|=4096,t)}function Zc(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),wi(e.return,t,r)}function Fo(e,t,r,a,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=a,o.tail=r,o.tailMode=s)}function Em(e,t,r){var a=t.pendingProps,s=a.revealOrder,o=a.tail;if(Ze(e,t,a.children,r),a=we.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zc(e,r,t);else if(e.tag===19)Zc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(fe(we,a),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Ms(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Fo(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ms(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Fo(t,!0,r,null,o);break;case"together":Fo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ds(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function tr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Vr|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,r=kr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=kr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Mp(e,t,r){switch(t.tag){case 3:Dm(t),jn();break;case 5:tm(t);break;case 1:ct(t.type)&&Ds(t);break;case 4:kl(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,s=t.memoizedProps.value;fe(Is,a._currentValue),a._currentValue=s;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(fe(we,we.current&1),t.flags|=128,null):r&t.child.childLanes?Tm(e,t,r):(fe(we,we.current&1),e=tr(e,t,r),e!==null?e.sibling:null);fe(we,we.current&1);break;case 19:if(a=(r&t.childLanes)!==0,e.flags&128){if(a)return Em(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),fe(we,we.current),a)break;return null;case 22:case 23:return t.lanes=0,Sm(e,t,r)}return tr(e,t,r)}var Im,Ii,Pm,Am;Im=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ii=function(){};Pm=function(e,t,r,a){var s=e.memoizedProps;if(s!==a){e=t.stateNode,Br(qt.current);var o=null;switch(r){case"input":s=Xo(e,s),a=Xo(e,a),o=[];break;case"select":s=Ne({},s,{value:void 0}),a=Ne({},a,{value:void 0}),o=[];break;case"textarea":s=ti(e,s),a=ti(e,a),o=[];break;default:typeof s.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Ss)}ni(r,a);var i;r=null;for(d in s)if(!a.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(i in c)c.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ia.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in a){var l=a[d];if(c=s!=null?s[d]:void 0,a.hasOwnProperty(d)&&l!==c&&(l!=null||c!=null))if(d==="style")if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(o||(o=[]),o.push(d,r)),r=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,c=c?c.__html:void 0,l!=null&&c!==l&&(o=o||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ia.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&xe("scroll",e),o||c===l||(o=[])):(o=o||[]).push(d,l))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};Am=function(e,t,r,a){r!==a&&(t.flags|=4)};function Hn(e,t){if(!ve)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Ve(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags&14680064,a|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function Fp(e,t,r){var a=t.pendingProps;switch(pl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ve(t),null;case 1:return ct(t.type)&&Cs(),Ve(t),null;case 3:return a=t.stateNode,Sn(),be(lt),be(Je),jl(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Ua(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ot!==null&&($i(Ot),Ot=null))),Ii(e,t),Ve(t),null;case 5:wl(t);var s=Br(ba.current);if(r=t.type,e!==null&&t.stateNode!=null)Pm(e,t,r,a,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(W(166));return Ve(t),null}if(e=Br(qt.current),Ua(t)){a=t.stateNode,r=t.type;var o=t.memoizedProps;switch(a[Gt]=t,a[ya]=o,e=(t.mode&1)!==0,r){case"dialog":xe("cancel",a),xe("close",a);break;case"iframe":case"object":case"embed":xe("load",a);break;case"video":case"audio":for(s=0;s<Qn.length;s++)xe(Qn[s],a);break;case"source":xe("error",a);break;case"img":case"image":case"link":xe("error",a),xe("load",a);break;case"details":xe("toggle",a);break;case"input":lc(a,o),xe("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!o.multiple},xe("invalid",a);break;case"textarea":dc(a,o),xe("invalid",a)}ni(r,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="children"?typeof c=="string"?a.textContent!==c&&(o.suppressHydrationWarning!==!0&&Ga(a.textContent,c,e),s=["children",c]):typeof c=="number"&&a.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&Ga(a.textContent,c,e),s=["children",""+c]):ia.hasOwnProperty(i)&&c!=null&&i==="onScroll"&&xe("scroll",a)}switch(r){case"input":La(a),cc(a,o,!0);break;case"textarea":La(a),uc(a);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(a.onclick=Ss)}a=s,t.updateQueue=a,a!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ou(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=i.createElement(r,{is:a.is}):(e=i.createElement(r),r==="select"&&(i=e,a.multiple?i.multiple=!0:a.size&&(i.size=a.size))):e=i.createElementNS(e,r),e[Gt]=t,e[ya]=a,Im(e,t,!1,!1),t.stateNode=e;e:{switch(i=ai(r,a),r){case"dialog":xe("cancel",e),xe("close",e),s=a;break;case"iframe":case"object":case"embed":xe("load",e),s=a;break;case"video":case"audio":for(s=0;s<Qn.length;s++)xe(Qn[s],e);s=a;break;case"source":xe("error",e),s=a;break;case"img":case"image":case"link":xe("error",e),xe("load",e),s=a;break;case"details":xe("toggle",e),s=a;break;case"input":lc(e,a),s=Xo(e,a),xe("invalid",e);break;case"option":s=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},s=Ne({},a,{value:void 0}),xe("invalid",e);break;case"textarea":dc(e,a),s=ti(e,a),xe("invalid",e);break;default:s=a}ni(r,s),c=s;for(o in c)if(c.hasOwnProperty(o)){var l=c[o];o==="style"?cu(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&iu(e,l)):o==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&la(e,l):typeof l=="number"&&la(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ia.hasOwnProperty(o)?l!=null&&o==="onScroll"&&xe("scroll",e):l!=null&&Zi(e,o,l,i))}switch(r){case"input":La(e),cc(e,a,!1);break;case"textarea":La(e),uc(e);break;case"option":a.value!=null&&e.setAttribute("value",""+jr(a.value));break;case"select":e.multiple=!!a.multiple,o=a.value,o!=null?pn(e,!!a.multiple,o,!1):a.defaultValue!=null&&pn(e,!!a.multiple,a.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ss)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ve(t),null;case 6:if(e&&t.stateNode!=null)Am(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(W(166));if(r=Br(ba.current),Br(qt.current),Ua(t)){if(a=t.stateNode,r=t.memoizedProps,a[Gt]=t,(o=a.nodeValue!==r)&&(e=xt,e!==null))switch(e.tag){case 3:Ga(a.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ga(a.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else a=(r.nodeType===9?r:r.ownerDocument).createTextNode(a),a[Gt]=t,t.stateNode=a}return Ve(t),null;case 13:if(be(we),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ve&&ht!==null&&t.mode&1&&!(t.flags&128))Ku(),jn(),t.flags|=98560,o=!1;else if(o=Ua(t),a!==null&&a.dehydrated!==null){if(e===null){if(!o)throw Error(W(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(W(317));o[Gt]=t}else jn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ve(t),o=!1}else Ot!==null&&($i(Ot),Ot=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||we.current&1?_e===0&&(_e=3):Ll())),t.updateQueue!==null&&(t.flags|=4),Ve(t),null);case 4:return Sn(),Ii(e,t),e===null&&ha(t.stateNode.containerInfo),Ve(t),null;case 10:return xl(t.type._context),Ve(t),null;case 17:return ct(t.type)&&Cs(),Ve(t),null;case 19:if(be(we),o=t.memoizedState,o===null)return Ve(t),null;if(a=(t.flags&128)!==0,i=o.rendering,i===null)if(a)Hn(o,!1);else{if(_e!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Ms(e),i!==null){for(t.flags|=128,Hn(o,!1),a=i.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;r!==null;)o=r,e=a,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return fe(we,we.current&1|2),t.child}e=e.sibling}o.tail!==null&&Ie()>Dn&&(t.flags|=128,a=!0,Hn(o,!1),t.lanes=4194304)}else{if(!a)if(e=Ms(i),e!==null){if(t.flags|=128,a=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Hn(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!ve)return Ve(t),null}else 2*Ie()-o.renderingStartTime>Dn&&r!==1073741824&&(t.flags|=128,a=!0,Hn(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ie(),t.sibling=null,r=we.current,fe(we,a?r&1|2:r&1),t):(Ve(t),null);case 22:case 23:return Fl(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?pt&1073741824&&(Ve(t),t.subtreeFlags&6&&(t.flags|=8192)):Ve(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function Lp(e,t){switch(pl(t),t.tag){case 1:return ct(t.type)&&Cs(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sn(),be(lt),be(Je),jl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wl(t),null;case 13:if(be(we),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));jn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return be(we),null;case 4:return Sn(),null;case 10:return xl(t.type._context),null;case 22:case 23:return Fl(),null;case 24:return null;default:return null}}var Va=!1,Ke=!1,Op=typeof WeakSet=="function"?WeakSet:Set,J=null;function un(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(a){Ce(e,t,a)}else r.current=null}function Pi(e,t,r){try{r()}catch(a){Ce(e,t,a)}}var ed=!1;function _p(e,t){if(pi=ws,e=_u(),ml(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var s=a.anchorOffset,o=a.focusNode;a=a.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,c=-1,l=-1,d=0,h=0,u=e,f=null;t:for(;;){for(var g;u!==r||s!==0&&u.nodeType!==3||(c=i+s),u!==o||a!==0&&u.nodeType!==3||(l=i+a),u.nodeType===3&&(i+=u.nodeValue.length),(g=u.firstChild)!==null;)f=u,u=g;for(;;){if(u===e)break t;if(f===r&&++d===s&&(c=i),f===o&&++h===a&&(l=i),(g=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=g}r=c===-1||l===-1?null:{start:c,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(hi={focusedElem:e,selectionRange:r},ws=!1,J=t;J!==null;)if(t=J,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,J=e;else for(;J!==null;){t=J;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,D=m.memoizedState,y=t.stateNode,p=y.getSnapshotBeforeUpdate(t.elementType===t.type?v:Ft(t.type,v),D);y.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(k){Ce(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,J=e;break}J=t.return}return m=ed,ed=!1,m}function ra(e,t,r){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&Pi(t,r,o)}s=s.next}while(s!==a)}}function to(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function Ai(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Mm(e){var t=e.alternate;t!==null&&(e.alternate=null,Mm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gt],delete t[ya],delete t[xi],delete t[bp],delete t[vp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fm(e){return e.tag===5||e.tag===3||e.tag===4}function td(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Fm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Mi(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ss));else if(a!==4&&(e=e.child,e!==null))for(Mi(e,t,r),e=e.sibling;e!==null;)Mi(e,t,r),e=e.sibling}function Fi(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Fi(e,t,r),e=e.sibling;e!==null;)Fi(e,t,r),e=e.sibling}var Ge=null,Lt=!1;function or(e,t,r){for(r=r.child;r!==null;)Lm(e,t,r),r=r.sibling}function Lm(e,t,r){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(Vs,r)}catch{}switch(r.tag){case 5:Ke||un(r,t);case 6:var a=Ge,s=Lt;Ge=null,or(e,t,r),Ge=a,Lt=s,Ge!==null&&(Lt?(e=Ge,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ge.removeChild(r.stateNode));break;case 18:Ge!==null&&(Lt?(e=Ge,r=r.stateNode,e.nodeType===8?Do(e.parentNode,r):e.nodeType===1&&Do(e,r),ma(e)):Do(Ge,r.stateNode));break;case 4:a=Ge,s=Lt,Ge=r.stateNode.containerInfo,Lt=!0,or(e,t,r),Ge=a,Lt=s;break;case 0:case 11:case 14:case 15:if(!Ke&&(a=r.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){s=a=a.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Pi(r,t,i),s=s.next}while(s!==a)}or(e,t,r);break;case 1:if(!Ke&&(un(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(c){Ce(r,t,c)}or(e,t,r);break;case 21:or(e,t,r);break;case 22:r.mode&1?(Ke=(a=Ke)||r.memoizedState!==null,or(e,t,r),Ke=a):or(e,t,r);break;default:or(e,t,r)}}function rd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Op),t.forEach(function(a){var s=Wp.bind(null,e,a);r.has(a)||(r.add(a),a.then(s,s))})}}function Mt(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var s=r[a];try{var o=e,i=t,c=i;e:for(;c!==null;){switch(c.tag){case 5:Ge=c.stateNode,Lt=!1;break e;case 3:Ge=c.stateNode.containerInfo,Lt=!0;break e;case 4:Ge=c.stateNode.containerInfo,Lt=!0;break e}c=c.return}if(Ge===null)throw Error(W(160));Lm(o,i,s),Ge=null,Lt=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){Ce(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Om(t,e),t=t.sibling}function Om(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mt(t,e),zt(e),a&4){try{ra(3,e,e.return),to(3,e)}catch(v){Ce(e,e.return,v)}try{ra(5,e,e.return)}catch(v){Ce(e,e.return,v)}}break;case 1:Mt(t,e),zt(e),a&512&&r!==null&&un(r,r.return);break;case 5:if(Mt(t,e),zt(e),a&512&&r!==null&&un(r,r.return),e.flags&32){var s=e.stateNode;try{la(s,"")}catch(v){Ce(e,e.return,v)}}if(a&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=r!==null?r.memoizedProps:o,c=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&au(s,o),ai(c,i);var d=ai(c,o);for(i=0;i<l.length;i+=2){var h=l[i],u=l[i+1];h==="style"?cu(s,u):h==="dangerouslySetInnerHTML"?iu(s,u):h==="children"?la(s,u):Zi(s,h,u,d)}switch(c){case"input":Zo(s,o);break;case"textarea":su(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?pn(s,!!o.multiple,g,!1):f!==!!o.multiple&&(o.defaultValue!=null?pn(s,!!o.multiple,o.defaultValue,!0):pn(s,!!o.multiple,o.multiple?[]:"",!1))}s[ya]=o}catch(v){Ce(e,e.return,v)}}break;case 6:if(Mt(t,e),zt(e),a&4){if(e.stateNode===null)throw Error(W(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(v){Ce(e,e.return,v)}}break;case 3:if(Mt(t,e),zt(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{ma(t.containerInfo)}catch(v){Ce(e,e.return,v)}break;case 4:Mt(t,e),zt(e);break;case 13:Mt(t,e),zt(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Al=Ie())),a&4&&rd(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Ke=(d=Ke)||h,Mt(t,e),Ke=d):Mt(t,e),zt(e),a&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!h&&e.mode&1)for(J=e,h=e.child;h!==null;){for(u=J=h;J!==null;){switch(f=J,g=f.child,f.tag){case 0:case 11:case 14:case 15:ra(4,f,f.return);break;case 1:un(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){a=f,r=f.return;try{t=a,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(v){Ce(a,r,v)}}break;case 5:un(f,f.return);break;case 22:if(f.memoizedState!==null){ad(u);continue}}g!==null?(g.return=f,J=g):ad(u)}h=h.sibling}e:for(h=null,u=e;;){if(u.tag===5){if(h===null){h=u;try{s=u.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=u.stateNode,l=u.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,c.style.display=lu("display",i))}catch(v){Ce(e,e.return,v)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(v){Ce(e,e.return,v)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Mt(t,e),zt(e),a&4&&rd(e);break;case 21:break;default:Mt(t,e),zt(e)}}function zt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Fm(r)){var a=r;break e}r=r.return}throw Error(W(160))}switch(a.tag){case 5:var s=a.stateNode;a.flags&32&&(la(s,""),a.flags&=-33);var o=td(e);Fi(e,o,s);break;case 3:case 4:var i=a.stateNode.containerInfo,c=td(e);Mi(e,c,i);break;default:throw Error(W(161))}}catch(l){Ce(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $p(e,t,r){J=e,_m(e)}function _m(e,t,r){for(var a=(e.mode&1)!==0;J!==null;){var s=J,o=s.child;if(s.tag===22&&a){var i=s.memoizedState!==null||Va;if(!i){var c=s.alternate,l=c!==null&&c.memoizedState!==null||Ke;c=Va;var d=Ke;if(Va=i,(Ke=l)&&!d)for(J=s;J!==null;)i=J,l=i.child,i.tag===22&&i.memoizedState!==null?sd(s):l!==null?(l.return=i,J=l):sd(s);for(;o!==null;)J=o,_m(o),o=o.sibling;J=s,Va=c,Ke=d}nd(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,J=o):nd(e)}}function nd(e){for(;J!==null;){var t=J;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ke||to(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!Ke)if(r===null)a.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Ft(t.type,r.memoizedProps);a.componentDidUpdate(s,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&zc(t,o,a);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}zc(t,i,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&ma(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Ke||t.flags&512&&Ai(t)}catch(f){Ce(t,t.return,f)}}if(t===e){J=null;break}if(r=t.sibling,r!==null){r.return=t.return,J=r;break}J=t.return}}function ad(e){for(;J!==null;){var t=J;if(t===e){J=null;break}var r=t.sibling;if(r!==null){r.return=t.return,J=r;break}J=t.return}}function sd(e){for(;J!==null;){var t=J;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{to(4,t)}catch(l){Ce(t,r,l)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var s=t.return;try{a.componentDidMount()}catch(l){Ce(t,s,l)}}var o=t.return;try{Ai(t)}catch(l){Ce(t,o,l)}break;case 5:var i=t.return;try{Ai(t)}catch(l){Ce(t,i,l)}}}catch(l){Ce(t,t.return,l)}if(t===e){J=null;break}var c=t.sibling;if(c!==null){c.return=t.return,J=c;break}J=t.return}}var Rp=Math.ceil,Os=rr.ReactCurrentDispatcher,Il=rr.ReactCurrentOwner,Tt=rr.ReactCurrentBatchConfig,de=0,ze=null,Me=null,Ue=0,pt=0,mn=Tr(0),_e=0,ja=null,Vr=0,ro=0,Pl=0,na=null,ot=null,Al=0,Dn=1/0,Vt=null,_s=!1,Li=null,br=null,Ya=!1,gr=null,$s=0,aa=0,Oi=null,us=-1,ms=0;function et(){return de&6?Ie():us!==-1?us:us=Ie()}function vr(e){return e.mode&1?de&2&&Ue!==0?Ue&-Ue:wp.transition!==null?(ms===0&&(ms=ku()),ms):(e=pe,e!==0||(e=window.event,e=e===void 0?16:Tu(e.type)),e):1}function $t(e,t,r,a){if(50<aa)throw aa=0,Oi=null,Error(W(185));Da(e,r,a),(!(de&2)||e!==ze)&&(e===ze&&(!(de&2)&&(ro|=r),_e===4&&ur(e,Ue)),dt(e,a),r===1&&de===0&&!(t.mode&1)&&(Dn=Ie()+500,Xs&&Er()))}function dt(e,t){var r=e.callbackNode;w0(e,t);var a=ks(e,e===ze?Ue:0);if(a===0)r!==null&&pc(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(r!=null&&pc(r),t===1)e.tag===0?kp(od.bind(null,e)):Vu(od.bind(null,e)),yp(function(){!(de&6)&&Er()}),r=null;else{switch(wu(a)){case 1:r=al;break;case 4:r=bu;break;case 16:r=vs;break;case 536870912:r=vu;break;default:r=vs}r=qm(r,$m.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function $m(e,t){if(us=-1,ms=0,de&6)throw Error(W(327));var r=e.callbackNode;if(bn()&&e.callbackNode!==r)return null;var a=ks(e,e===ze?Ue:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Rs(e,a);else{t=a;var s=de;de|=2;var o=Bm();(ze!==e||Ue!==t)&&(Vt=null,Dn=Ie()+500,Hr(e,t));do try{Hp();break}catch(c){Rm(e,c)}while(!0);yl(),Os.current=o,de=s,Me!==null?t=0:(ze=null,Ue=0,t=_e)}if(t!==0){if(t===2&&(s=ci(e),s!==0&&(a=s,t=_i(e,s))),t===1)throw r=ja,Hr(e,0),ur(e,a),dt(e,Ie()),r;if(t===6)ur(e,a);else{if(s=e.current.alternate,!(a&30)&&!Bp(s)&&(t=Rs(e,a),t===2&&(o=ci(e),o!==0&&(a=o,t=_i(e,o))),t===1))throw r=ja,Hr(e,0),ur(e,a),dt(e,Ie()),r;switch(e.finishedWork=s,e.finishedLanes=a,t){case 0:case 1:throw Error(W(345));case 2:Or(e,ot,Vt);break;case 3:if(ur(e,a),(a&130023424)===a&&(t=Al+500-Ie(),10<t)){if(ks(e,0)!==0)break;if(s=e.suspendedLanes,(s&a)!==a){et(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=yi(Or.bind(null,e,ot,Vt),t);break}Or(e,ot,Vt);break;case 4:if(ur(e,a),(a&4194240)===a)break;for(t=e.eventTimes,s=-1;0<a;){var i=31-_t(a);o=1<<i,i=t[i],i>s&&(s=i),a&=~o}if(a=s,a=Ie()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Rp(a/1960))-a,10<a){e.timeoutHandle=yi(Or.bind(null,e,ot,Vt),a);break}Or(e,ot,Vt);break;case 5:Or(e,ot,Vt);break;default:throw Error(W(329))}}}return dt(e,Ie()),e.callbackNode===r?$m.bind(null,e):null}function _i(e,t){var r=na;return e.current.memoizedState.isDehydrated&&(Hr(e,t).flags|=256),e=Rs(e,t),e!==2&&(t=ot,ot=r,t!==null&&$i(t)),e}function $i(e){ot===null?ot=e:ot.push.apply(ot,e)}function Bp(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var a=0;a<r.length;a++){var s=r[a],o=s.getSnapshot;s=s.value;try{if(!Rt(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ur(e,t){for(t&=~Pl,t&=~ro,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-_t(t),a=1<<r;e[r]=-1,t&=~a}}function od(e){if(de&6)throw Error(W(327));bn();var t=ks(e,0);if(!(t&1))return dt(e,Ie()),null;var r=Rs(e,t);if(e.tag!==0&&r===2){var a=ci(e);a!==0&&(t=a,r=_i(e,a))}if(r===1)throw r=ja,Hr(e,0),ur(e,t),dt(e,Ie()),r;if(r===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Or(e,ot,Vt),dt(e,Ie()),null}function Ml(e,t){var r=de;de|=1;try{return e(t)}finally{de=r,de===0&&(Dn=Ie()+500,Xs&&Er())}}function Yr(e){gr!==null&&gr.tag===0&&!(de&6)&&bn();var t=de;de|=1;var r=Tt.transition,a=pe;try{if(Tt.transition=null,pe=1,e)return e()}finally{pe=a,Tt.transition=r,de=t,!(de&6)&&Er()}}function Fl(){pt=mn.current,be(mn)}function Hr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,fp(r)),Me!==null)for(r=Me.return;r!==null;){var a=r;switch(pl(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Cs();break;case 3:Sn(),be(lt),be(Je),jl();break;case 5:wl(a);break;case 4:Sn();break;case 13:be(we);break;case 19:be(we);break;case 10:xl(a.type._context);break;case 22:case 23:Fl()}r=r.return}if(ze=e,Me=e=kr(e.current,null),Ue=pt=t,_e=0,ja=null,Pl=ro=Vr=0,ot=na=null,Rr!==null){for(t=0;t<Rr.length;t++)if(r=Rr[t],a=r.interleaved,a!==null){r.interleaved=null;var s=a.next,o=r.pending;if(o!==null){var i=o.next;o.next=s,a.next=i}r.pending=a}Rr=null}return e}function Rm(e,t){do{var r=Me;try{if(yl(),ls.current=Ls,Fs){for(var a=je.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Fs=!1}if(Wr=0,Be=Le=je=null,ta=!1,va=0,Il.current=null,r===null||r.return===null){_e=1,ja=t,Me=null;break}e:{var o=e,i=r.return,c=r,l=t;if(t=Ue,c.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=c,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Vc(i);if(g!==null){g.flags&=-257,Yc(g,i,c,o,t),g.mode&1&&Wc(o,d,t),t=g,l=d;var m=t.updateQueue;if(m===null){var v=new Set;v.add(l),t.updateQueue=v}else m.add(l);break e}else{if(!(t&1)){Wc(o,d,t),Ll();break e}l=Error(W(426))}}else if(ve&&c.mode&1){var D=Vc(i);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Yc(D,i,c,o,t),hl(Cn(l,c));break e}}o=l=Cn(l,c),_e!==4&&(_e=2),na===null?na=[o]:na.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=wm(o,l,t);Bc(o,y);break e;case 1:c=l;var p=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof p.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(br===null||!br.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t;var k=jm(o,c,t);Bc(o,k);break e}}o=o.return}while(o!==null)}Hm(r)}catch(C){t=C,Me===r&&r!==null&&(Me=r=r.return);continue}break}while(!0)}function Bm(){var e=Os.current;return Os.current=Ls,e===null?Ls:e}function Ll(){(_e===0||_e===3||_e===2)&&(_e=4),ze===null||!(Vr&268435455)&&!(ro&268435455)||ur(ze,Ue)}function Rs(e,t){var r=de;de|=2;var a=Bm();(ze!==e||Ue!==t)&&(Vt=null,Hr(e,t));do try{zp();break}catch(s){Rm(e,s)}while(!0);if(yl(),de=r,Os.current=a,Me!==null)throw Error(W(261));return ze=null,Ue=0,_e}function zp(){for(;Me!==null;)zm(Me)}function Hp(){for(;Me!==null&&!g0();)zm(Me)}function zm(e){var t=Um(e.alternate,e,pt);e.memoizedProps=e.pendingProps,t===null?Hm(e):Me=t,Il.current=null}function Hm(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Lp(r,t),r!==null){r.flags&=32767,Me=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_e=6,Me=null;return}}else if(r=Fp(r,t,pt),r!==null){Me=r;return}if(t=t.sibling,t!==null){Me=t;return}Me=t=e}while(t!==null);_e===0&&(_e=5)}function Or(e,t,r){var a=pe,s=Tt.transition;try{Tt.transition=null,pe=1,Gp(e,t,r,a)}finally{Tt.transition=s,pe=a}return null}function Gp(e,t,r,a){do bn();while(gr!==null);if(de&6)throw Error(W(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(j0(e,o),e===ze&&(Me=ze=null,Ue=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ya||(Ya=!0,qm(vs,function(){return bn(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Tt.transition,Tt.transition=null;var i=pe;pe=1;var c=de;de|=4,Il.current=null,_p(e,r),Om(r,e),cp(hi),ws=!!pi,hi=pi=null,e.current=r,$p(r),p0(),de=c,pe=i,Tt.transition=o}else e.current=r;if(Ya&&(Ya=!1,gr=e,$s=s),o=e.pendingLanes,o===0&&(br=null),y0(r.stateNode),dt(e,Ie()),t!==null)for(a=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],a(s.value,{componentStack:s.stack,digest:s.digest});if(_s)throw _s=!1,e=Li,Li=null,e;return $s&1&&e.tag!==0&&bn(),o=e.pendingLanes,o&1?e===Oi?aa++:(aa=0,Oi=e):aa=0,Er(),null}function bn(){if(gr!==null){var e=wu($s),t=Tt.transition,r=pe;try{if(Tt.transition=null,pe=16>e?16:e,gr===null)var a=!1;else{if(e=gr,gr=null,$s=0,de&6)throw Error(W(331));var s=de;for(de|=4,J=e.current;J!==null;){var o=J,i=o.child;if(J.flags&16){var c=o.deletions;if(c!==null){for(var l=0;l<c.length;l++){var d=c[l];for(J=d;J!==null;){var h=J;switch(h.tag){case 0:case 11:case 15:ra(8,h,o)}var u=h.child;if(u!==null)u.return=h,J=u;else for(;J!==null;){h=J;var f=h.sibling,g=h.return;if(Mm(h),h===d){J=null;break}if(f!==null){f.return=g,J=f;break}J=g}}}var m=o.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var D=v.sibling;v.sibling=null,v=D}while(v!==null)}}J=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,J=i;else e:for(;J!==null;){if(o=J,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ra(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,J=y;break e}J=o.return}}var p=e.current;for(J=p;J!==null;){i=J;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,J=x;else e:for(i=p;J!==null;){if(c=J,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:to(9,c)}}catch(C){Ce(c,c.return,C)}if(c===i){J=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,J=k;break e}J=c.return}}if(de=s,Er(),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(Vs,e)}catch{}a=!0}return a}finally{pe=r,Tt.transition=t}}return!1}function id(e,t,r){t=Cn(r,t),t=wm(e,t,1),e=xr(e,t,1),t=et(),e!==null&&(Da(e,1,t),dt(e,t))}function Ce(e,t,r){if(e.tag===3)id(e,e,r);else for(;t!==null;){if(t.tag===3){id(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(br===null||!br.has(a))){e=Cn(r,e),e=jm(t,e,1),t=xr(t,e,1),e=et(),t!==null&&(Da(t,1,e),dt(t,e));break}}t=t.return}}function Up(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),t=et(),e.pingedLanes|=e.suspendedLanes&r,ze===e&&(Ue&r)===r&&(_e===4||_e===3&&(Ue&130023424)===Ue&&500>Ie()-Al?Hr(e,0):Pl|=r),dt(e,t)}function Gm(e,t){t===0&&(e.mode&1?(t=$a,$a<<=1,!($a&130023424)&&($a=4194304)):t=1);var r=et();e=er(e,t),e!==null&&(Da(e,t,r),dt(e,r))}function qp(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Gm(e,r)}function Wp(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(W(314))}a!==null&&a.delete(t),Gm(e,r)}var Um;Um=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||lt.current)it=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return it=!1,Mp(e,t,r);it=!!(e.flags&131072)}else it=!1,ve&&t.flags&1048576&&Yu(t,Es,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;ds(e,t),e=t.pendingProps;var s=wn(t,Je.current);xn(t,r),s=Sl(null,t,a,e,s,r);var o=Cl();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ct(a)?(o=!0,Ds(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vl(t),s.updater=eo,t.stateNode=s,s._reactInternals=t,Ni(t,a,e,r),t=Di(null,t,a,!0,o,r)):(t.tag=0,ve&&o&&gl(t),Ze(null,t,s,r),t=t.child),t;case 16:a=t.elementType;e:{switch(ds(e,t),e=t.pendingProps,s=a._init,a=s(a._payload),t.type=a,s=t.tag=Yp(a),e=Ft(a,e),s){case 0:t=Ci(null,t,a,e,r);break e;case 1:t=Jc(null,t,a,e,r);break e;case 11:t=Qc(null,t,a,e,r);break e;case 14:t=Kc(null,t,a,Ft(a.type,e),r);break e}throw Error(W(306,a,""))}return t;case 0:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ft(a,s),Ci(e,t,a,s,r);case 1:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ft(a,s),Jc(e,t,a,s,r);case 3:e:{if(Dm(t),e===null)throw Error(W(387));a=t.pendingProps,o=t.memoizedState,s=o.element,em(e,t),As(t,a,null,r);var i=t.memoizedState;if(a=i.element,o.isDehydrated)if(o={element:a,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Cn(Error(W(423)),t),t=Xc(e,t,a,r,s);break e}else if(a!==s){s=Cn(Error(W(424)),t),t=Xc(e,t,a,r,s);break e}else for(ht=yr(t.stateNode.containerInfo.firstChild),xt=t,ve=!0,Ot=null,r=Xu(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(jn(),a===s){t=tr(e,t,r);break e}Ze(e,t,a,r)}t=t.child}return t;case 5:return tm(t),e===null&&ki(t),a=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,fi(a,s)?i=null:o!==null&&fi(a,o)&&(t.flags|=32),Cm(e,t),Ze(e,t,i,r),t.child;case 6:return e===null&&ki(t),null;case 13:return Tm(e,t,r);case 4:return kl(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Nn(t,null,a,r):Ze(e,t,a,r),t.child;case 11:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ft(a,s),Qc(e,t,a,s,r);case 7:return Ze(e,t,t.pendingProps,r),t.child;case 8:return Ze(e,t,t.pendingProps.children,r),t.child;case 12:return Ze(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,fe(Is,a._currentValue),a._currentValue=i,o!==null)if(Rt(o.value,i)){if(o.children===s.children&&!lt.current){t=tr(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var c=o.dependencies;if(c!==null){i=o.child;for(var l=c.firstContext;l!==null;){if(l.context===a){if(o.tag===1){l=Jt(-1,r&-r),l.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),wi(o.return,r,t),c.lanes|=r;break}l=l.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(W(341));i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),wi(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Ze(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,a=t.pendingProps.children,xn(t,r),s=Et(s),a=a(s),t.flags|=1,Ze(e,t,a,r),t.child;case 14:return a=t.type,s=Ft(a,t.pendingProps),s=Ft(a.type,s),Kc(e,t,a,s,r);case 15:return Nm(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:Ft(a,s),ds(e,t),t.tag=1,ct(a)?(e=!0,Ds(t)):e=!1,xn(t,r),km(t,a,s),Ni(t,a,s,r),Di(null,t,a,!0,e,r);case 19:return Em(e,t,r);case 22:return Sm(e,t,r)}throw Error(W(156,t.tag))};function qm(e,t){return xu(e,t)}function Vp(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ct(e,t,r,a){return new Vp(e,t,r,a)}function Ol(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Yp(e){if(typeof e=="function")return Ol(e)?1:0;if(e!=null){if(e=e.$$typeof,e===tl)return 11;if(e===rl)return 14}return 2}function kr(e,t){var r=e.alternate;return r===null?(r=Ct(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function gs(e,t,r,a,s,o){var i=2;if(a=e,typeof e=="function")Ol(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case tn:return Gr(r.children,s,o,t);case el:i=8,s|=8;break;case Yo:return e=Ct(12,r,t,s|2),e.elementType=Yo,e.lanes=o,e;case Qo:return e=Ct(13,r,t,s),e.elementType=Qo,e.lanes=o,e;case Ko:return e=Ct(19,r,t,s),e.elementType=Ko,e.lanes=o,e;case tu:return no(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zd:i=10;break e;case eu:i=9;break e;case tl:i=11;break e;case rl:i=14;break e;case lr:i=16,a=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=Ct(i,r,t,s),t.elementType=e,t.type=a,t.lanes=o,t}function Gr(e,t,r,a){return e=Ct(7,e,a,t),e.lanes=r,e}function no(e,t,r,a){return e=Ct(22,e,a,t),e.elementType=tu,e.lanes=r,e.stateNode={isHidden:!1},e}function Lo(e,t,r){return e=Ct(6,e,null,t),e.lanes=r,e}function Oo(e,t,r){return t=Ct(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qp(e,t,r,a,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fo(0),this.expirationTimes=fo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fo(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _l(e,t,r,a,s,o,i,c,l){return e=new Qp(e,t,r,c,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ct(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},vl(o),e}function Kp(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:en,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}function Wm(e){if(!e)return Nr;e=e._reactInternals;e:{if(Kr(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ct(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var r=e.type;if(ct(r))return Wu(e,r,t)}return t}function Vm(e,t,r,a,s,o,i,c,l){return e=_l(r,a,!0,e,s,o,i,c,l),e.context=Wm(null),r=e.current,a=et(),s=vr(r),o=Jt(a,s),o.callback=t??null,xr(r,o,s),e.current.lanes=s,Da(e,s,a),dt(e,a),e}function ao(e,t,r,a){var s=t.current,o=et(),i=vr(s);return r=Wm(r),t.context===null?t.context=r:t.pendingContext=r,t=Jt(o,i),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=xr(s,t,i),e!==null&&($t(e,s,i,o),is(e,s,i)),i}function Bs(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ld(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function $l(e,t){ld(e,t),(e=e.alternate)&&ld(e,t)}function Jp(){return null}var Ym=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rl(e){this._internalRoot=e}so.prototype.render=Rl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));ao(e,t,null,null)};so.prototype.unmount=Rl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yr(function(){ao(null,e,null,null)}),t[Zt]=null}};function so(e){this._internalRoot=e}so.prototype.unstable_scheduleHydration=function(e){if(e){var t=Su();e={blockedOn:null,target:e,priority:t};for(var r=0;r<dr.length&&t!==0&&t<dr[r].priority;r++);dr.splice(r,0,e),r===0&&Du(e)}};function Bl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cd(){}function Xp(e,t,r,a,s){if(s){if(typeof a=="function"){var o=a;a=function(){var d=Bs(i);o.call(d)}}var i=Vm(t,a,e,0,null,!1,!1,"",cd);return e._reactRootContainer=i,e[Zt]=i.current,ha(e.nodeType===8?e.parentNode:e),Yr(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof a=="function"){var c=a;a=function(){var d=Bs(l);c.call(d)}}var l=_l(e,0,!1,null,null,!1,!1,"",cd);return e._reactRootContainer=l,e[Zt]=l.current,ha(e.nodeType===8?e.parentNode:e),Yr(function(){ao(t,l,r,a)}),l}function io(e,t,r,a,s){var o=r._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var c=s;s=function(){var l=Bs(i);c.call(l)}}ao(t,i,e,s)}else i=Xp(r,t,e,s,a);return Bs(i)}ju=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Yn(t.pendingLanes);r!==0&&(sl(t,r|1),dt(t,Ie()),!(de&6)&&(Dn=Ie()+500,Er()))}break;case 13:Yr(function(){var a=er(e,1);if(a!==null){var s=et();$t(a,e,1,s)}}),$l(e,1)}};ol=function(e){if(e.tag===13){var t=er(e,134217728);if(t!==null){var r=et();$t(t,e,134217728,r)}$l(e,134217728)}};Nu=function(e){if(e.tag===13){var t=vr(e),r=er(e,t);if(r!==null){var a=et();$t(r,e,t,a)}$l(e,t)}};Su=function(){return pe};Cu=function(e,t){var r=pe;try{return pe=e,t()}finally{pe=r}};oi=function(e,t,r){switch(t){case"input":if(Zo(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var s=Js(a);if(!s)throw Error(W(90));nu(a),Zo(a,s)}}}break;case"textarea":su(e,r);break;case"select":t=r.value,t!=null&&pn(e,!!r.multiple,t,!1)}};mu=Ml;gu=Yr;var Zp={usingClientEntryPoint:!1,Events:[Ea,sn,Js,du,uu,Ml]},Gn={findFiberByHostInstance:$r,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eh={bundleType:Gn.bundleType,version:Gn.version,rendererPackageName:Gn.rendererPackageName,rendererConfig:Gn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fu(e),e===null?null:e.stateNode},findFiberByHostInstance:Gn.findFiberByHostInstance||Jp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qa.isDisabled&&Qa.supportsFiber)try{Vs=Qa.inject(eh),Ut=Qa}catch{}}vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zp;vt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bl(t))throw Error(W(200));return Kp(e,t,null,r)};vt.createRoot=function(e,t){if(!Bl(e))throw Error(W(299));var r=!1,a="",s=Ym;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=_l(e,1,!1,null,null,r,!1,a,s),e[Zt]=t.current,ha(e.nodeType===8?e.parentNode:e),new Rl(t)};vt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=fu(t),e=e===null?null:e.stateNode,e};vt.flushSync=function(e){return Yr(e)};vt.hydrate=function(e,t,r){if(!oo(t))throw Error(W(200));return io(null,e,t,!0,r)};vt.hydrateRoot=function(e,t,r){if(!Bl(e))throw Error(W(405));var a=r!=null&&r.hydratedSources||null,s=!1,o="",i=Ym;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Vm(t,null,e,1,r??null,s,!1,o,i),e[Zt]=t.current,ha(e),a)for(e=0;e<a.length;e++)r=a[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new so(t)};vt.render=function(e,t,r){if(!oo(t))throw Error(W(200));return io(null,e,t,!1,r)};vt.unmountComponentAtNode=function(e){if(!oo(e))throw Error(W(40));return e._reactRootContainer?(Yr(function(){io(null,null,e,!1,function(){e._reactRootContainer=null,e[Zt]=null})}),!0):!1};vt.unstable_batchedUpdates=Ml;vt.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!oo(r))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return io(e,t,r,!1,a)};vt.version="18.3.1-next-f1338f8080-20240426";function Qm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Qm)}catch(e){console.error(e)}}Qm(),Qd.exports=vt;var th=Qd.exports,dd=th;Wo.createRoot=dd.createRoot,Wo.hydrateRoot=dd.hydrateRoot;var rh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const nh=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ah=(e,t)=>{const r=N.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,children:c,...l},d)=>N.createElement("svg",{ref:d,...rh,width:s,height:s,stroke:a,strokeWidth:i?Number(o)*24/Number(s):o,className:`lucide lucide-${nh(e)}`,...l},[...t.map(([h,u])=>N.createElement(h,u)),...(Array.isArray(c)?c:[c])||[]]));return r.displayName=`${e}`,r};var ee=ah;const Km=ee("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Na=ee("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),sa=ee("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),Jm=ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),sh=ee("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),oh=ee("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Ri=ee("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ud=ee("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),ih=ee("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),zr=ee("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),lh=ee("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),ch=ee("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),vn=ee("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),dh=ee("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),zl=ee("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),gn=ee("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),uh=ee("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Bi=ee("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),zi=ee("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Sr=ee("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),mh=ee("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),gh=ee("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Hl=ee("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ph=ee("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),hh=ee("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),fh=ee("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),yh=ee("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),xh=ee("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),ps=ee("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),zs=ee("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),bh=ee("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),vh=ee("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),kh=ee("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),wh=ee("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),jh=ee("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),md=ee("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Hs=ee("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Tn=ee("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Nh=ee("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),Dt=ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Xm=ee("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),gd=ee("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),_o=ee("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),Zm=ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),eg=ee("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Sh=ee("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),Gs=ee("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Ch=ee("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),pd=ee("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),hd=ee("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),oa=ee("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ft=ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Dh=ee("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),tg=ee("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),rg=ee("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Th=ee("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Eh=ee("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Ih=ee("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),Ph=ee("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Bt=ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/*! Capacitor: https://capacitorjs.com/ - MIT License */var En;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(En||(En={}));class $o extends Error{constructor(t,r,a){super(t),this.message=t,this.code=r,this.data=a}}const Ah=e=>{var t,r;return e!=null&&e.androidBridge?"android":!((r=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},Mh=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},a=r.Plugins=r.Plugins||{},s=()=>t!==null?t.name:Ah(e),o=()=>s()!=="web",i=u=>{const f=d.get(u);return!!(f!=null&&f.platforms.has(s())||c(u))},c=u=>{var f;return(f=r.PluginHeaders)===null||f===void 0?void 0:f.find(g=>g.name===u)},l=u=>e.console.error(u),d=new Map,h=(u,f={})=>{const g=d.get(u);if(g)return console.warn(`Capacitor plugin "${u}" already registered. Cannot register plugins twice.`),g.proxy;const m=s(),v=c(u);let D;const y=async()=>(!D&&m in f?D=typeof f[m]=="function"?D=await f[m]():D=f[m]:t!==null&&!D&&"web"in f&&(D=typeof f.web=="function"?D=await f.web():D=f.web),D),p=(j,S)=>{var w,_;if(v){const M=v==null?void 0:v.methods.find(F=>S===F.name);if(M)return M.rtype==="promise"?F=>r.nativePromise(u,S.toString(),F):(F,G)=>r.nativeCallback(u,S.toString(),F,G);if(j)return(w=j[S])===null||w===void 0?void 0:w.bind(j)}else{if(j)return(_=j[S])===null||_===void 0?void 0:_.bind(j);throw new $o(`"${u}" plugin is not implemented on ${m}`,En.Unimplemented)}},x=j=>{let S;const w=(..._)=>{const M=y().then(F=>{const G=p(F,j);if(G){const L=G(..._);return S=L==null?void 0:L.remove,L}else throw new $o(`"${u}.${j}()" is not implemented on ${m}`,En.Unimplemented)});return j==="addListener"&&(M.remove=async()=>S()),M};return w.toString=()=>`${j.toString()}() { [capacitor code] }`,Object.defineProperty(w,"name",{value:j,writable:!1,configurable:!1}),w},k=x("addListener"),C=x("removeListener"),T=(j,S)=>{const w=k({eventName:j},S),_=async()=>{const F=await w;C({eventName:j,callbackId:F},S)},M=new Promise(F=>w.then(()=>F({remove:_})));return M.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await _()},M},b=new Proxy({},{get(j,S){switch(S){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return v?T:k;case"removeListener":return C;default:return x(S)}}});return a[u]=b,d.set(u,{name:u,proxy:b,platforms:new Set([...Object.keys(f),...v?[m]:[]])}),b};return r.convertFileSrc||(r.convertFileSrc=u=>u),r.getPlatform=s,r.handleError=l,r.isNativePlatform=o,r.isPluginAvailable=i,r.registerPlugin=h,r.Exception=$o,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},Fh=e=>e.Capacitor=Mh(e),wr=Fh(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Gl=wr.registerPlugin;class ng{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let a=!1;this.listeners[t]||(this.listeners[t]=[],a=!0),this.listeners[t].push(r);const o=this.windowListeners[t];o&&!o.registered&&this.addWindowListener(o),a&&this.sendRetainedArgumentsForEvent(t);const i=async()=>this.removeListener(t,r);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,a){const s=this.listeners[t];if(!s){if(a){let o=this.retainedEventArguments[t];o||(o=[]),o.push(r),this.retainedEventArguments[t]=o}return}s.forEach(o=>o(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:a=>{this.notifyListeners(r,a)}}}unimplemented(t="not implemented"){return new wr.Exception(t,En.Unimplemented)}unavailable(t="not available"){return new wr.Exception(t,En.Unavailable)}async removeListener(t,r){const a=this.listeners[t];if(!a)return;const s=a.indexOf(r);this.listeners[t].splice(s,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(a=>{this.notifyListeners(t,a)}))}}const fd=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),yd=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Lh extends ng{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(a=>{if(a.length<=0)return;let[s,o]=a.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=yd(s).trim(),o=yd(o).trim(),r[s]=o}),r}async setCookie(t){try{const r=fd(t.key),a=fd(t.value),s=`; expires=${(t.expires||"").replace("expires=","")}`,o=(t.path||"/").replace("path=",""),i=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${a||""}${s}; path=${o}; ${i};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}Gl("CapacitorCookies",{web:()=>new Lh});const Oh=async e=>new Promise((t,r)=>{const a=new FileReader;a.onload=()=>{const s=a.result;t(s.indexOf(",")>=0?s.split(",")[1]:s)},a.onerror=s=>r(s),a.readAsDataURL(e)}),_h=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(s=>s.toLocaleLowerCase()).reduce((s,o,i)=>(s[o]=e[t[i]],s),{})},$h=(e,t=!0)=>e?Object.entries(e).reduce((a,s)=>{const[o,i]=s;let c,l;return Array.isArray(i)?(l="",i.forEach(d=>{c=t?encodeURIComponent(d):d,l+=`${o}=${c}&`}),l.slice(0,-1)):(c=t?encodeURIComponent(i):i,l=`${o}=${c}`),`${a}&${l}`},"").substr(1):null,Rh=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),s=_h(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(s.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[i,c]of Object.entries(e.data||{}))o.set(i,c);r.body=o.toString()}else if(s.includes("multipart/form-data")||e.data instanceof FormData){const o=new FormData;if(e.data instanceof FormData)e.data.forEach((c,l)=>{o.append(l,c)});else for(const c of Object.keys(e.data))o.append(c,e.data[c]);r.body=o;const i=new Headers(r.headers);i.delete("content-type"),r.headers=i}else(s.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class Bh extends ng{async request(t){const r=Rh(t,t.webFetchExtra),a=$h(t.params,t.shouldEncodeUrlParams),s=a?`${t.url}?${a}`:t.url,o=await fetch(s,r),i=o.headers.get("content-type")||"";let{responseType:c="text"}=o.ok?t:{};i.includes("application/json")&&(c="json");let l,d;switch(c){case"arraybuffer":case"blob":d=await o.blob(),l=await Oh(d);break;case"json":l=await o.json();break;case"document":case"text":default:l=await o.text()}const h={};return o.headers.forEach((u,f)=>{h[f]=u}),{data:l,headers:h,status:o.status,url:o.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}Gl("CapacitorHttp",{web:()=>new Bh});const zh={},xd=e=>{let t;const r=new Set,a=(h,u)=>{const f=typeof h=="function"?h(t):h;if(!Object.is(f,t)){const g=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(m=>m(t,g))}},s=()=>t,l={setState:a,getState:s,getInitialState:()=>d,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(zh?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(a,s,l);return l},Hh=e=>e?xd(e):xd;var ag={exports:{}},sg={},og={exports:{}},ig={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var In=N;function Gh(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Uh=typeof Object.is=="function"?Object.is:Gh,qh=In.useState,Wh=In.useEffect,Vh=In.useLayoutEffect,Yh=In.useDebugValue;function Qh(e,t){var r=t(),a=qh({inst:{value:r,getSnapshot:t}}),s=a[0].inst,o=a[1];return Vh(function(){s.value=r,s.getSnapshot=t,Ro(s)&&o({inst:s})},[e,r,t]),Wh(function(){return Ro(s)&&o({inst:s}),e(function(){Ro(s)&&o({inst:s})})},[e]),Yh(r),r}function Ro(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Uh(e,r)}catch{return!0}}function Kh(e,t){return t()}var Jh=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Kh:Qh;ig.useSyncExternalStore=In.useSyncExternalStore!==void 0?In.useSyncExternalStore:Jh;og.exports=ig;var Xh=og.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lo=N,Zh=Xh;function ef(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tf=typeof Object.is=="function"?Object.is:ef,rf=Zh.useSyncExternalStore,nf=lo.useRef,af=lo.useEffect,sf=lo.useMemo,of=lo.useDebugValue;sg.useSyncExternalStoreWithSelector=function(e,t,r,a,s){var o=nf(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=sf(function(){function l(g){if(!d){if(d=!0,h=g,g=a(g),s!==void 0&&i.hasValue){var m=i.value;if(s(m,g))return u=m}return u=g}if(m=u,tf(h,g))return m;var v=a(g);return s!==void 0&&s(m,v)?(h=g,m):(h=g,u=v)}var d=!1,h,u,f=r===void 0?null:r;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,r,a,s]);var c=rf(e,o[0],o[1]);return af(function(){i.hasValue=!0,i.value=c},[c]),of(c),c};ag.exports=sg;var lf=ag.exports;const cf=Od(lf),lg={},{useDebugValue:df}=Vd,{useSyncExternalStoreWithSelector:uf}=cf;let bd=!1;const mf=e=>e;function gf(e,t=mf,r){(lg?"production":void 0)!=="production"&&r&&!bd&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),bd=!0);const a=uf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return df(a),a}const vd=e=>{(lg?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Hh(e):e,r=(a,s)=>gf(t,a,s);return Object.assign(r,t),r},nr=e=>e?vd(e):vd,pf={};function hf(e,t){let r;try{r=e()}catch{return}return{getItem:s=>{var o;const i=l=>l===null?null:JSON.parse(l,void 0),c=(o=r.getItem(s))!=null?o:null;return c instanceof Promise?c.then(i):i(c)},setItem:(s,o)=>r.setItem(s,JSON.stringify(o,void 0)),removeItem:s=>r.removeItem(s)}}const Sa=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(a){return Sa(a)(r)},catch(a){return this}}}catch(r){return{then(a){return this},catch(a){return Sa(a)(r)}}}},ff=(e,t)=>(r,a,s)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:D=>D,version:0,merge:(D,y)=>({...y,...D}),...t},i=!1;const c=new Set,l=new Set;let d;try{d=o.getStorage()}catch{}if(!d)return e((...D)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),r(...D)},a,s);const h=Sa(o.serialize),u=()=>{const D=o.partialize({...a()});let y;const p=h({state:D,version:o.version}).then(x=>d.setItem(o.name,x)).catch(x=>{y=x});if(y)throw y;return p},f=s.setState;s.setState=(D,y)=>{f(D,y),u()};const g=e((...D)=>{r(...D),u()},a,s);let m;const v=()=>{var D;if(!d)return;i=!1,c.forEach(p=>p(a()));const y=((D=o.onRehydrateStorage)==null?void 0:D.call(o,a()))||void 0;return Sa(d.getItem.bind(d))(o.name).then(p=>{if(p)return o.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==o.version){if(o.migrate)return o.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var x;return m=o.merge(p,(x=a())!=null?x:g),r(m,!0),u()}).then(()=>{y==null||y(m,void 0),i=!0,l.forEach(p=>p(m))}).catch(p=>{y==null||y(void 0,p)})};return s.persist={setOptions:D=>{o={...o,...D},D.getStorage&&(d=D.getStorage())},clearStorage:()=>{d==null||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>v(),hasHydrated:()=>i,onHydrate:D=>(c.add(D),()=>{c.delete(D)}),onFinishHydration:D=>(l.add(D),()=>{l.delete(D)})},v(),m||g},yf=(e,t)=>(r,a,s)=>{let o={storage:hf(()=>localStorage),partialize:v=>v,version:0,merge:(v,D)=>({...D,...v}),...t},i=!1;const c=new Set,l=new Set;let d=o.storage;if(!d)return e((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),r(...v)},a,s);const h=()=>{const v=o.partialize({...a()});return d.setItem(o.name,{state:v,version:o.version})},u=s.setState;s.setState=(v,D)=>{u(v,D),h()};const f=e((...v)=>{r(...v),h()},a,s);s.getInitialState=()=>f;let g;const m=()=>{var v,D;if(!d)return;i=!1,c.forEach(p=>{var x;return p((x=a())!=null?x:f)});const y=((D=o.onRehydrateStorage)==null?void 0:D.call(o,(v=a())!=null?v:f))||void 0;return Sa(d.getItem.bind(d))(o.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==o.version){if(o.migrate)return[!0,o.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var x;const[k,C]=p;if(g=o.merge(C,(x=a())!=null?x:f),r(g,!0),k)return h()}).then(()=>{y==null||y(g,void 0),g=a(),i=!0,l.forEach(p=>p(g))}).catch(p=>{y==null||y(void 0,p)})};return s.persist={setOptions:v=>{o={...o,...v},v.storage&&(d=v.storage)},clearStorage:()=>{d==null||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:v=>(c.add(v),()=>{c.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},o.skipHydration||m(),g||f},xf=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((pf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ff(e,t)):yf(e,t),Ir=xf,bf=async(e,t)=>{const a=new TextEncoder().encode(e+t),s=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")},vf=()=>{const e=new Uint8Array(16);return crypto.getRandomValues(e),Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")},cg=async(e,t)=>{if(!/^\d{4}$/.test(e))throw new Error("Passcode must be exactly 4 digits");return await bf(e,t)},kf=async(e,t,r)=>{if(!/^\d{4}$/.test(e))return!1;try{return await cg(e,r)===t}catch(a){return console.error("Passcode validation error:",a),!1}},dg=e=>{switch(e){case"1min":return 60*1e3;case"5min":return 5*60*1e3;case"15min":return 15*60*1e3;case"30min":return 30*60*1e3;case"never":return-1;default:return 5*60*1e3}},wf={orange:"Orange",blue:"Cyan",green:"Emerald",purple:"Purple",red:"Bordeaux",yellow:"Corn"},Ka={notifications:{pushNotifications:!0,reminderTime:"08:00",achievementNotifications:!0,dailyReminders:!0,weeklyReports:!1},appearance:{theme:"light",accentColor:"orange",compactMode:!1,showProgressRings:!0},privacy:{analytics:!0,crashReporting:!0,dataSharing:!1,locationTracking:!1},premium:{aiAssistant:!1,advancedAnalytics:!1,cloudSync:!1,unlimitedGoals:!1,customThemes:!1},passcode:{enabled:!1,autoLockTimeout:"5min"},version:"1.0.0",firstLaunch:!0,onboardingCompleted:!1},ar=nr()(Ir((e,t)=>({settings:Ka,isLoading:!1,isJournalLocked:!1,updateNotificationSettings:r=>{e(a=>({settings:{...a.settings,notifications:{...a.settings.notifications,...r}}}))},updateAppearanceSettings:r=>{e(a=>({settings:{...a.settings,appearance:{...a.settings.appearance,...r}}}))},updatePrivacySettings:r=>{e(a=>({settings:{...a.settings,privacy:{...a.settings.privacy,...r}}}))},updatePremiumSettings:r=>{e(a=>({settings:{...a.settings,premium:{...a.settings.premium,...r}}}))},updatePasscodeSettings:r=>{e(a=>({settings:{...a.settings,passcode:{...a.settings.passcode,...r}}}))},setTheme:r=>{e(a=>({settings:{...a.settings,appearance:{...a.settings.appearance,theme:r}}})),r==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},setAccentColor:r=>{e(i=>({settings:{...i.settings,appearance:{...i.settings.appearance,accentColor:r}}}));const a={orange:{50:"#FFF7ED",100:"#FFEDD5",200:"#FED7AA",300:"#FDBA74",400:"#FB923C",500:"#FF7101",600:"#EA580C",700:"#C2410C",800:"#9A3412",900:"#7C2D12"},blue:{50:"#ECFEFF",100:"#CFFAFE",200:"#A5F3FC",300:"#67E8F9",400:"#22D3EE",500:"#06B6D4",600:"#0891B2",700:"#0E7490",800:"#155E75",900:"#164E63"},green:{50:"#ECFDF5",100:"#D1FAE5",200:"#A7F3D0",300:"#6EE7B7",400:"#34D399",500:"#10B981",600:"#059669",700:"#047857",800:"#065F46",900:"#064E3B"},purple:{50:"#FAF5FF",100:"#F3E8FF",200:"#E9D5FF",300:"#D8B4FE",400:"#C084FC",500:"#A855F7",600:"#9333EA",700:"#7C3AED",800:"#6B21A8",900:"#581C87"},red:{50:"#FEF2F2",100:"#FEE2E2",200:"#FECACA",300:"#FCA5A5",400:"#F87171",500:"#7C2D12",600:"#6D2813",700:"#5D2312",800:"#4E1E10",900:"#3F180D"},yellow:{50:"#FFFBEB",100:"#FEF3C7",200:"#FDE68A",300:"#FCD34D",400:"#FBBF24",500:"#EAB308",600:"#CA8A04",700:"#A16207",800:"#854D0E",900:"#713F12"}},s=document.documentElement,o=a[r];Object.entries(o).forEach(([i,c])=>{s.style.setProperty(`--accent-${i}`,c)}),s.style.setProperty("--accent-color",o[500]),s.style.setProperty("--accent-color-light",o[400]),s.style.setProperty("--accent-color-dark",o[600])},setReminderTime:r=>{e(a=>({settings:{...a.settings,notifications:{...a.settings.notifications,reminderTime:r}}}))},toggleNotifications:r=>{e(a=>({settings:{...a.settings,notifications:{...a.settings.notifications,[r]:!a.settings.notifications[r]}}}))},togglePrivacySetting:r=>{e(a=>({settings:{...a.settings,privacy:{...a.settings.privacy,[r]:!a.settings.privacy[r]}}}))},setupPasscode:async r=>{try{const a=vf(),s=await cg(r,a);return t().updatePasscodeSettings({enabled:!0,hash:s,salt:a,lastAccessTime:void 0}),e({isJournalLocked:!0}),console.log(" Passcode setup successful - journal locked immediately"),!0}catch(a){return console.error(" Passcode setup failed:",a),!1}},validatePasscode:async r=>{try{const{settings:a}=t();if(!a.passcode.enabled||!a.passcode.hash||!a.passcode.salt)return!1;const s=await kf(r,a.passcode.hash,a.passcode.salt);return s?(t().updateLastAccess(),console.log(" Passcode validation successful")):console.log(" Passcode validation failed"),s}catch(a){return console.error(" Passcode validation error:",a),!1}},disablePasscode:async r=>await t().validatePasscode(r)?(t().updatePasscodeSettings({enabled:!1,hash:void 0,salt:void 0,lastAccessTime:void 0}),console.log(" Passcode disabled successfully"),!0):!1,changePasscode:async(r,a)=>await t().validatePasscode(r)?await t().setupPasscode(a):!1,setAutoLockTimeout:r=>{t().updatePasscodeSettings({autoLockTimeout:r})},updateLastAccess:()=>{t().updatePasscodeSettings({lastAccessTime:Date.now()})},shouldAutoLock:()=>{const{settings:r}=t();if(!r.passcode.enabled||!r.passcode.lastAccessTime)return!1;const a=dg(r.passcode.autoLockTimeout);return a===-1?!1:Date.now()-r.passcode.lastAccessTime>=a},forceLock:()=>{t().updatePasscodeSettings({lastAccessTime:void 0}),e({isJournalLocked:!0}),console.log(" Journal force locked - lastAccessTime cleared")},lockJournal:()=>{e({isJournalLocked:!0}),console.log(" Journal locked globally")},unlockJournal:()=>{e({isJournalLocked:!1}),t().updateLastAccess(),console.log(" Journal unlocked globally")},checkAndUpdateLockState:()=>{const{settings:r}=t();return console.log(" checkAndUpdateLockState called:",{passcodeEnabled:r.passcode.enabled,hasHash:!!r.passcode.hash,hasSalt:!!r.passcode.salt,lastAccessTime:r.passcode.lastAccessTime,currentLockState:t().isJournalLocked,autoLockTimeout:r.passcode.autoLockTimeout}),r.passcode.enabled?r.passcode.lastAccessTime?t().shouldAutoLock()?(e({isJournalLocked:!0}),console.log(" Journal should be locked - timeout exceeded"),!0):(e({isJournalLocked:!1}),console.log(" Journal should remain unlocked"),!1):(e({isJournalLocked:!0}),console.log(" Journal should be locked - no lastAccessTime"),!0):(e({isJournalLocked:!1}),console.log(" Passcode not enabled - journal unlocked"),!1)},resetToDefaults:()=>{e({settings:{...Ka,firstLaunch:!1}})},exportSettings:()=>{const{settings:r}=t();return JSON.stringify(r,null,2)},importSettings:r=>{try{const a=JSON.parse(r);return a&&typeof a=="object"?(e(()=>({settings:{...Ka,...a,version:Ka.version}})),!0):!1}catch(a){return console.error("Failed to import settings:",a),!1}},completeOnboarding:()=>{e(r=>({settings:{...r.settings,onboardingCompleted:!0,firstLaunch:!1}}))},resetOnboarding:()=>{e(r=>({settings:{...r.settings,onboardingCompleted:!1}}))},isOnboardingCompleted:()=>t().settings.onboardingCompleted,getTheme:()=>t().settings.appearance.theme,getAccentColor:()=>t().settings.appearance.accentColor,getAccentColorName:()=>{const r=t().settings.appearance.accentColor;return wf[r]||"Orange"},isPremiumEnabled:()=>{const{premium:r}=t().settings;return Object.values(r).some(a=>a===!0)},areNotificationsEnabled:()=>t().settings.notifications.pushNotifications,initializeSettings:()=>{const{settings:r}=t();r.appearance.theme==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const a={orange:{50:"#FFF7ED",100:"#FFEDD5",200:"#FED7AA",300:"#FDBA74",400:"#FB923C",500:"#FF7101",600:"#EA580C",700:"#C2410C",800:"#9A3412",900:"#7C2D12"},blue:{50:"#ECFEFF",100:"#CFFAFE",200:"#A5F3FC",300:"#67E8F9",400:"#22D3EE",500:"#06B6D4",600:"#0891B2",700:"#0E7490",800:"#155E75",900:"#164E63"},green:{50:"#ECFDF5",100:"#D1FAE5",200:"#A7F3D0",300:"#6EE7B7",400:"#34D399",500:"#10B981",600:"#059669",700:"#047857",800:"#065F46",900:"#064E3B"},purple:{50:"#FAF5FF",100:"#F3E8FF",200:"#E9D5FF",300:"#D8B4FE",400:"#C084FC",500:"#A855F7",600:"#9333EA",700:"#7C3AED",800:"#6B21A8",900:"#581C87"},red:{50:"#FEF2F2",100:"#FEE2E2",200:"#FECACA",300:"#FCA5A5",400:"#F87171",500:"#7C2D12",600:"#6D2813",700:"#5D2312",800:"#4E1E10",900:"#3F180D"},yellow:{50:"#FFFBEB",100:"#FEF3C7",200:"#FDE68A",300:"#FCD34D",400:"#FBBF24",500:"#EAB308",600:"#CA8A04",700:"#A16207",800:"#854D0E",900:"#713F12"}},s=document.documentElement,o=a[r.appearance.accentColor];Object.entries(o).forEach(([i,c])=>{s.style.setProperty(`--accent-${i}`,c)}),s.style.setProperty("--accent-color",o[500]),s.style.setProperty("--accent-color-light",o[400]),s.style.setProperty("--accent-color-dark",o[600])}}),{name:"settings-store",version:1,partialize:e=>({settings:e.settings,isJournalLocked:e.isJournalLocked}),onRehydrateStorage:()=>e=>{if(e&&(e.initializeSettings(),e.settings.passcode.enabled)){console.log(" Settings rehydrated - checking journal lock state");const t=e.checkAndUpdateLockState();console.log(" Lock state after rehydration:",t)}}})),jf=()=>{const e=document.documentElement,a={orange:{50:"#FFF7ED",100:"#FFEDD5",200:"#FED7AA",300:"#FDBA74",400:"#FB923C",500:"#FF7101",600:"#EA580C",700:"#C2410C",800:"#9A3412",900:"#7C2D12"}}["orange"];Object.entries(a).forEach(([s,o])=>{e.style.setProperty(`--accent-${s}`,o)}),e.style.setProperty("--accent-color",a[500]),e.style.setProperty("--accent-color-light",a[400]),e.style.setProperty("--accent-color-dark",a[600])};typeof window<"u"&&jf();const ug=Object.freeze(Object.defineProperty({__proto__:null,useSettingsStore:ar},Symbol.toStringTag,{value:"Module"})),Nf=[{id:"health",name:"Health & Fitness",description:"Exercise, nutrition, wellness",icon:""},{id:"career",name:"Career & Business",description:"Skills, projects, growth",icon:""},{id:"learning",name:"Learning & Skills",description:"Education, languages, hobbies",icon:""},{id:"personal",name:"Personal Growth",description:"Mindfulness, relationships",icon:""},{id:"financial",name:"Financial",description:"Saving, budgeting, investing",icon:""},{id:"creative",name:"Creative & Hobbies",description:"Art, music, crafts",icon:""}],Sf={health:[{id:"get-fit-strong",icon:"",name:"Get Fit & Strong",duration:"3-6 months",description:"Build a consistent workout routine and develop healthy eating habits.",taskCount:8,habitCount:5,category:"health",tasks:[{name:"Set up gym membership",description:"Research and join a local gym",type:"standard",priority:"high"},{name:"Plan weekly workout schedule",description:"Create a 4-day workout routine",type:"standard",priority:"high"},{name:"Buy workout gear",description:"Get proper shoes and workout clothes",type:"to-buy",priority:"medium"},{name:"Schedule fitness assessment",description:"Book initial fitness evaluation",type:"deadline",priority:"medium"},{name:"Plan meal prep routine",description:"Design weekly meal planning system",type:"standard",priority:"high"},{name:"Buy healthy groceries",description:"Stock up on nutritious foods",type:"to-buy",priority:"medium"},{name:"Find workout buddy",description:"Connect with accountability partner",type:"standard",priority:"low"},{name:"Track first month progress",description:"Measure and document improvements",type:"standard",priority:"medium"}],habits:[{name:"Morning workout",description:"30-45 minutes of exercise",frequency:"daily",icon:""},{name:"Drink 8 glasses of water",description:"Stay hydrated throughout the day",frequency:"daily",icon:""},{name:"Take progress photos",description:"Document fitness journey",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Meal prep",description:"Prepare healthy meals for the week",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Sleep 8 hours",description:"Prioritize recovery and rest",frequency:"daily",icon:""}]},{id:"run-marathon",icon:"",name:"Run a Marathon",duration:"4-6 months",description:"Complete training plan to successfully finish your first marathon.",taskCount:12,habitCount:6,category:"health",tasks:[{name:"Get running shoes fitted",description:"Professional gait analysis and fitting",type:"standard",priority:"urgent"},{name:"Create training schedule",description:"16-week marathon training plan",type:"standard",priority:"high"},{name:"Register for marathon",description:"Sign up for target marathon event",type:"deadline",priority:"high"},{name:"Plan nutrition strategy",description:"Research race day fueling",type:"standard",priority:"medium"},{name:"Buy running gear",description:"Clothes, watch, accessories",type:"to-buy",priority:"medium"},{name:"Find running routes",description:"Map out various distance routes",type:"standard",priority:"medium"},{name:"Schedule long runs",description:"Plan weekend long run schedule",type:"standard",priority:"high"},{name:"Join running group",description:"Find local running community",type:"standard",priority:"low"},{name:"Practice race pace",description:"Train at target marathon pace",type:"standard",priority:"medium"},{name:"Plan taper strategy",description:"Reduce training before race",type:"standard",priority:"medium"},{name:"Prepare race day logistics",description:"Plan transportation and timing",type:"standard",priority:"high"},{name:"Celebrate completion",description:"Plan post-marathon celebration",type:"standard",priority:"low"}],habits:[{name:"Daily run",description:"Follow training plan schedule",frequency:"daily",icon:""},{name:"Stretching routine",description:"15 minutes of stretching",frequency:"daily",icon:""},{name:"Strength training",description:"Runner-specific strength work",frequency:"weekly",selectedDays:["tue","thu"],icon:""},{name:"Hydration tracking",description:"Monitor water intake",frequency:"daily",icon:""},{name:"Sleep optimization",description:"8+ hours quality sleep",frequency:"daily",icon:""},{name:"Recovery activities",description:"Foam rolling, massage, etc.",frequency:"weekly",selectedDays:["sun"],icon:""}]},{id:"healthy-eating",icon:"",name:"Healthy Eating",duration:"2-3 months",description:"Develop sustainable eating habits and meal planning skills.",taskCount:6,habitCount:7,category:"health",tasks:[{name:"Clean out pantry",description:"Remove processed and unhealthy foods",type:"standard",priority:"high"},{name:"Create healthy grocery list",description:"Plan nutritious shopping list",type:"standard",priority:"high"},{name:"Buy meal prep containers",description:"Get proper food storage containers",type:"to-buy",priority:"medium"},{name:"Learn healthy recipes",description:"Find 20 go-to healthy meals",type:"standard",priority:"medium"},{name:"Plan weekly menus",description:"Design weekly meal planning system",type:"standard",priority:"high"},{name:"Set up nutrition tracking",description:"Choose app or method to track intake",type:"standard",priority:"medium"}],habits:[{name:"Drink water before meals",description:"Stay hydrated and aid digestion",frequency:"daily",icon:""},{name:"Eat 5 servings of vegetables",description:"Prioritize vegetable intake",frequency:"daily",icon:""},{name:"Meal prep on Sunday",description:"Prepare meals for the week",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Cook dinner at home",description:"Avoid takeout and cook fresh meals",frequency:"daily",icon:""},{name:"Take vitamins",description:"Daily vitamin supplement",frequency:"daily",icon:""},{name:"Read nutrition labels",description:"Make informed food choices",frequency:"daily",icon:""},{name:"Plan next day meals",description:"Prepare mentally for healthy choices",frequency:"daily",icon:""}]}],career:[{id:"launch-side-project",icon:"",name:"Launch Side Project",duration:"3-4 months",description:"Take your idea from concept to launch with structured milestones.",taskCount:15,habitCount:4,category:"career",tasks:[{name:"Define project scope",description:"Clearly outline project goals and features",type:"standard",priority:"urgent"},{name:"Market research",description:"Research target audience and competitors",type:"standard",priority:"high"},{name:"Create project timeline",description:"Break down project into milestones",type:"standard",priority:"high"},{name:"Set up development environment",description:"Configure tools and workspace",type:"standard",priority:"high"},{name:"Design user interface",description:"Create mockups and user flow",type:"standard",priority:"medium"},{name:"Build MVP",description:"Develop minimum viable product",type:"standard",priority:"high"},{name:"Set up hosting",description:"Choose and configure hosting platform",type:"standard",priority:"medium"},{name:"Create landing page",description:"Build marketing website",type:"standard",priority:"medium"},{name:"Beta testing",description:"Get feedback from test users",type:"standard",priority:"medium"},{name:"Fix bugs and iterate",description:"Improve based on feedback",type:"standard",priority:"high"},{name:"Launch marketing plan",description:"Prepare launch strategy",type:"standard",priority:"medium"},{name:"Go live",description:"Official project launch",type:"deadline",priority:"urgent"},{name:"Monitor analytics",description:"Track project performance",type:"standard",priority:"medium"},{name:"Gather user feedback",description:"Collect post-launch insights",type:"standard",priority:"medium"},{name:"Plan next iteration",description:"Roadmap for future improvements",type:"standard",priority:"low"}],habits:[{name:"Daily coding",description:"2 hours of focused development work",frequency:"daily",icon:""},{name:"Weekly progress review",description:"Assess progress and adjust plans",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Learn new skills",description:"Study relevant technologies",frequency:"daily",icon:""},{name:"Network with creators",description:"Connect with other entrepreneurs",frequency:"weekly",selectedDays:["fri"],icon:""}]},{id:"get-promoted",icon:"",name:"Get Promoted",duration:"6-12 months",description:"Strategic career development plan to earn your next promotion.",taskCount:10,habitCount:5,category:"career",tasks:[{name:"Schedule career conversation",description:"Meet with manager to discuss goals",type:"deadline",priority:"urgent"},{name:"Identify skill gaps",description:"Assess areas for improvement",type:"standard",priority:"high"},{name:"Create development plan",description:"Outline specific growth activities",type:"standard",priority:"high"},{name:"Find internal mentor",description:"Connect with senior colleague",type:"standard",priority:"medium"},{name:"Take on stretch project",description:"Volunteer for challenging assignment",type:"standard",priority:"high"},{name:"Attend leadership training",description:"Enroll in professional development",type:"standard",priority:"medium"},{name:"Build cross-team relationships",description:"Network within organization",type:"standard",priority:"medium"},{name:"Document achievements",description:"Track accomplishments and impact",type:"standard",priority:"high"},{name:"Seek feedback regularly",description:"Request input from colleagues",type:"standard",priority:"medium"},{name:"Apply for promotion",description:"Submit formal promotion request",type:"deadline",priority:"urgent"}],habits:[{name:"Arrive early to work",description:"Show dedication and preparation",frequency:"daily",icon:""},{name:"Weekly skill learning",description:"Study industry trends and skills",frequency:"weekly",selectedDays:["sat"],icon:""},{name:"Network lunch meetings",description:"Build professional relationships",frequency:"weekly",selectedDays:["wed"],icon:""},{name:"Update achievements log",description:"Record daily accomplishments",frequency:"daily",icon:""},{name:"Volunteer for projects",description:"Show initiative and leadership",frequency:"weekly",selectedDays:["mon"],icon:""}]}],learning:[{id:"learn-spanish",icon:"",name:"Learn Spanish",duration:"6-12 months",description:"Achieve conversational fluency through daily practice and immersion.",taskCount:8,habitCount:6,category:"learning",tasks:[{name:"Choose learning platform",description:"Select app or course for structure",type:"standard",priority:"urgent"},{name:"Set up study space",description:"Create dedicated learning environment",type:"standard",priority:"medium"},{name:"Buy Spanish resources",description:"Get textbooks, dictionary, materials",type:"to-buy",priority:"medium"},{name:"Find conversation partner",description:"Connect with native Spanish speaker",type:"standard",priority:"high"},{name:"Join Spanish meetup",description:"Find local Spanish practice group",type:"standard",priority:"medium"},{name:"Plan immersion activities",description:"Spanish movies, music, podcasts",type:"standard",priority:"medium"},{name:"Schedule progress test",description:"Take proficiency assessment",type:"deadline",priority:"medium"},{name:"Plan Spanish trip",description:"Visit Spanish-speaking country",type:"standard",priority:"low"}],habits:[{name:"Daily Spanish lessons",description:"30 minutes of structured learning",frequency:"daily",icon:""},{name:"Spanish conversation practice",description:"Speak with tutor or partner",frequency:"weekly",selectedDays:["tue","thu"],icon:""},{name:"Watch Spanish content",description:"Movies, shows, or YouTube videos",frequency:"daily",icon:""},{name:"Spanish music listening",description:"Immerse in Spanish audio",frequency:"daily",icon:""},{name:"Vocabulary flashcards",description:"Review and learn new words",frequency:"daily",icon:""},{name:"Spanish journaling",description:"Write thoughts in Spanish",frequency:"daily",icon:""}]},{id:"master-programming",icon:"",name:"Master Programming",duration:"4-8 months",description:"Build coding skills from beginner to job-ready developer.",taskCount:12,habitCount:4,category:"learning",tasks:[{name:"Choose programming language",description:"Select primary language to focus on",type:"standard",priority:"urgent"},{name:"Set up development environment",description:"Install necessary tools and editors",type:"standard",priority:"high"},{name:"Complete beginner course",description:"Finish comprehensive online course",type:"standard",priority:"high"},{name:"Build first project",description:"Create simple application",type:"standard",priority:"high"},{name:"Learn version control",description:"Master Git and GitHub",type:"standard",priority:"high"},{name:"Study data structures",description:"Learn algorithms and data structures",type:"standard",priority:"medium"},{name:"Build portfolio projects",description:"Create 3-5 showcase projects",type:"standard",priority:"high"},{name:"Learn web frameworks",description:"Study popular frameworks",type:"standard",priority:"medium"},{name:"Practice coding challenges",description:"Solve problems on coding platforms",type:"standard",priority:"medium"},{name:"Create GitHub portfolio",description:"Showcase projects professionally",type:"standard",priority:"high"},{name:"Apply for internships",description:"Seek real-world experience",type:"standard",priority:"medium"},{name:"Prepare for interviews",description:"Practice technical interviews",type:"standard",priority:"high"}],habits:[{name:"Daily coding practice",description:"2-3 hours of programming",frequency:"daily",icon:""},{name:"Weekly project work",description:"Focus on portfolio projects",frequency:"weekly",selectedDays:["sat","sun"],icon:""},{name:"Algorithm practice",description:"Solve coding challenges",frequency:"daily",icon:""},{name:"Tech article reading",description:"Stay updated with industry trends",frequency:"daily",icon:""}]}],personal:[{id:"mindfulness-practice",icon:"",name:"Mindfulness Practice",duration:"2-4 months",description:"Develop a daily meditation practice for mental clarity and peace.",taskCount:5,habitCount:4,category:"personal",tasks:[{name:"Download meditation app",description:"Choose guided meditation platform",type:"standard",priority:"high"},{name:"Set up meditation space",description:"Create quiet, peaceful environment",type:"standard",priority:"medium"},{name:"Buy meditation cushion",description:"Get comfortable seating",type:"to-buy",priority:"low"},{name:"Read mindfulness book",description:"Learn meditation principles",type:"standard",priority:"medium"},{name:"Join meditation group",description:"Find local or online community",type:"standard",priority:"low"}],habits:[{name:"Daily meditation",description:"10-20 minutes of mindfulness",frequency:"daily",icon:""},{name:"Gratitude journaling",description:"Write 3 things you're grateful for",frequency:"daily",icon:""},{name:"Mindful walking",description:"Present-moment awareness during walks",frequency:"daily",icon:""},{name:"Breathing exercises",description:"Practice deep breathing techniques",frequency:"daily",icon:""}]},{id:"read-more-books",icon:"",name:"Read More Books",duration:"12 months",description:"Build a consistent reading habit and expand your knowledge.",taskCount:6,habitCount:3,category:"personal",tasks:[{name:"Create reading list",description:"Choose 24 books for the year",type:"standard",priority:"high"},{name:"Set up reading space",description:"Create comfortable reading environment",type:"standard",priority:"medium"},{name:"Join library",description:"Get library card and explore resources",type:"standard",priority:"medium"},{name:"Find reading time",description:"Block out daily reading schedule",type:"standard",priority:"high"},{name:"Join book club",description:"Connect with other readers",type:"standard",priority:"low"},{name:"Track reading progress",description:"Use app or journal to monitor",type:"standard",priority:"medium"}],habits:[{name:"Daily reading",description:"30 minutes of book reading",frequency:"daily",icon:""},{name:"Weekly book notes",description:"Summarize key insights",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Share book recommendations",description:"Discuss books with friends",frequency:"weekly",selectedDays:["fri"],icon:""}]}],financial:[{id:"build-emergency-fund",icon:"",name:"Build Emergency Fund",duration:"6-12 months",description:"Save 3-6 months of expenses for financial security.",taskCount:8,habitCount:5,category:"financial",tasks:[{name:"Calculate monthly expenses",description:"Determine exact emergency fund target",type:"standard",priority:"urgent"},{name:"Open high-yield savings",description:"Find best emergency fund account",type:"standard",priority:"high"},{name:"Set up automatic transfer",description:"Automate emergency fund savings",type:"standard",priority:"high"},{name:"Create monthly budget",description:"Plan income and expense allocation",type:"standard",priority:"high"},{name:"Find extra income",description:"Identify ways to increase earnings",type:"standard",priority:"medium"},{name:"Cut unnecessary expenses",description:"Reduce spending to save more",type:"standard",priority:"medium"},{name:"Set savings milestones",description:"Celebrate progress markers",type:"standard",priority:"medium"},{name:"Review and adjust plan",description:"Monthly progress assessment",type:"standard",priority:"medium"}],habits:[{name:"Daily expense tracking",description:"Record all spending",frequency:"daily",icon:""},{name:"Weekly budget review",description:"Check spending against budget",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Save spare change",description:"Add loose change to savings",frequency:"daily",icon:""},{name:"Cook meals at home",description:"Reduce food expenses",frequency:"daily",icon:""},{name:"Monthly savings review",description:"Assess emergency fund progress",frequency:"weekly",selectedDays:["sat"],icon:""}]},{id:"start-investing",icon:"",name:"Start Investing",duration:"3-6 months",description:"Learn investment basics and build a diversified portfolio.",taskCount:10,habitCount:4,category:"financial",tasks:[{name:"Learn investment basics",description:"Study stocks, bonds, and funds",type:"standard",priority:"urgent"},{name:"Assess risk tolerance",description:"Determine investment comfort level",type:"standard",priority:"high"},{name:"Open investment account",description:"Choose and set up brokerage account",type:"standard",priority:"high"},{name:"Set investment goals",description:"Define timeline and objectives",type:"standard",priority:"high"},{name:"Research investment options",description:"Compare stocks, ETFs, mutual funds",type:"standard",priority:"medium"},{name:"Create investment strategy",description:"Plan portfolio allocation",type:"standard",priority:"high"},{name:"Make first investment",description:"Purchase initial holdings",type:"standard",priority:"high"},{name:"Set up automatic investing",description:"Automate regular contributions",type:"standard",priority:"medium"},{name:"Monitor portfolio",description:"Track investment performance",type:"standard",priority:"medium"},{name:"Rebalance portfolio",description:"Adjust allocation as needed",type:"standard",priority:"low"}],habits:[{name:"Daily market reading",description:"Stay informed about market news",frequency:"daily",icon:""},{name:"Weekly portfolio review",description:"Check investment performance",frequency:"weekly",selectedDays:["sat"],icon:""},{name:"Monthly investing",description:"Add money to investment account",frequency:"weekly",selectedDays:["fri"],icon:""},{name:"Investment learning",description:"Study investment strategies",frequency:"weekly",selectedDays:["sun"],icon:""}]}],creative:[{id:"learn-digital-art",icon:"",name:"Learn Digital Art",duration:"4-8 months",description:"Master digital art tools and techniques for creative expression.",taskCount:9,habitCount:5,category:"creative",tasks:[{name:"Choose digital art software",description:"Select Photoshop, Procreate, or similar",type:"standard",priority:"urgent"},{name:"Buy digital drawing tablet",description:"Get proper drawing hardware",type:"to-buy",priority:"high"},{name:"Take online art course",description:"Enroll in structured learning program",type:"standard",priority:"high"},{name:"Set up art workspace",description:"Create comfortable drawing environment",type:"standard",priority:"medium"},{name:"Study art fundamentals",description:"Learn color theory, composition, etc.",type:"standard",priority:"medium"},{name:"Create first digital piece",description:"Complete initial artwork",type:"standard",priority:"high"},{name:"Join art community",description:"Connect with other digital artists",type:"standard",priority:"low"},{name:"Build art portfolio",description:"Create collection of best work",type:"standard",priority:"medium"},{name:"Share art online",description:"Post work on social platforms",type:"standard",priority:"low"}],habits:[{name:"Daily art practice",description:"1-2 hours of drawing/painting",frequency:"daily",icon:""},{name:"Study art tutorials",description:"Watch technique videos",frequency:"daily",icon:""},{name:"Sketch observations",description:"Draw from life and reference",frequency:"daily",icon:""},{name:"Art community engagement",description:"Share and get feedback",frequency:"weekly",selectedDays:["fri"],icon:""},{name:"Experiment with styles",description:"Try new techniques and approaches",frequency:"weekly",selectedDays:["sat"],icon:""}]},{id:"photography-skills",icon:"",name:"Photography Skills",duration:"3-6 months",description:"Improve photography skills and build a portfolio.",taskCount:7,habitCount:4,category:"creative",tasks:[{name:"Learn camera basics",description:"Master aperture, shutter speed, ISO",type:"standard",priority:"urgent"},{name:"Practice composition rules",description:"Study rule of thirds, leading lines",type:"standard",priority:"high"},{name:"Buy photography gear",description:"Get camera, lenses, tripod",type:"to-buy",priority:"medium"},{name:"Find photo subjects",description:"Identify interesting locations/themes",type:"standard",priority:"medium"},{name:"Learn photo editing",description:"Master Lightroom or similar software",type:"standard",priority:"high"},{name:"Build photo portfolio",description:"Curate best work collection",type:"standard",priority:"medium"},{name:"Share photos online",description:"Create Instagram or website",type:"standard",priority:"low"}],habits:[{name:"Daily photo taking",description:"Capture at least 10 photos",frequency:"daily",icon:""},{name:"Photo editing practice",description:"Edit and enhance photos",frequency:"daily",icon:""},{name:"Photography study",description:"Study other photographers' work",frequency:"weekly",selectedDays:["sun"],icon:""},{name:"Share weekly favorites",description:"Post best photos from the week",frequency:"weekly",selectedDays:["fri"],icon:""}]}]},Un=["welcome","category","template","ai","ready"],Fn=nr()(Ir((e,t)=>({currentStep:"welcome",isOnboardingActive:!1,onboardingData:{selectedCategory:null,selectedTemplate:null,userName:"",userEmail:"",skipAI:!1},setCurrentStep:r=>e({currentStep:r}),setSelectedCategory:r=>e(a=>({onboardingData:{...a.onboardingData,selectedCategory:r,selectedTemplate:null}})),setSelectedTemplate:r=>e(a=>({onboardingData:{...a.onboardingData,selectedTemplate:r}})),setUserInfo:(r,a)=>e(s=>({onboardingData:{...s.onboardingData,userName:r,userEmail:a}})),setSkipAI:r=>e(a=>({onboardingData:{...a.onboardingData,skipAI:r}})),startOnboarding:()=>e({isOnboardingActive:!0,currentStep:"welcome"}),completeOnboarding:async()=>{const r=t();try{if(r.onboardingData.selectedTemplate){console.log(" Creating goal from onboarding template:",r.onboardingData.selectedTemplate.name);const{useGoalStore:a}=await ge(async()=>{const{useGoalStore:i}=await Promise.resolve().then(()=>Qe);return{useGoalStore:i}},void 0,import.meta.url),o=await a.getState().createGoalFromTemplate(r.onboardingData.selectedTemplate.id,{name:r.onboardingData.userName?`${r.onboardingData.selectedTemplate.name} - ${r.onboardingData.userName}`:r.onboardingData.selectedTemplate.name});o.success?(console.log(" Successfully created goal from onboarding template"),console.log(` Created: ${o.tasksCreated} tasks, ${o.habitsCreated} habits`)):console.error(" Failed to create goal from onboarding template:",o.error)}else console.log(" No template selected during onboarding, skipping goal creation")}catch(a){console.error(" Error during onboarding template processing:",a)}try{const{useSettingsStore:a}=await ge(async()=>{const{useSettingsStore:s}=await Promise.resolve().then(()=>ug);return{useSettingsStore:s}},void 0,import.meta.url);a.getState().completeOnboarding()}catch(a){console.warn(" Could not complete onboarding in settings store:",a)}e({isOnboardingActive:!1,currentStep:"welcome",onboardingData:{selectedCategory:null,selectedTemplate:null,userName:"",userEmail:"",skipAI:!1}}),console.log(" Onboarding completed successfully")},resetOnboarding:()=>e({currentStep:"welcome",isOnboardingActive:!0,onboardingData:{selectedCategory:null,selectedTemplate:null,userName:"",userEmail:"",skipAI:!1}}),nextStep:()=>{const r=Un.indexOf(t().currentStep);r<Un.length-1&&e({currentStep:Un[r+1]})},previousStep:()=>{const r=Un.indexOf(t().currentStep);r>0&&e({currentStep:Un[r-1]})},getCategories:()=>Nf,getTemplatesForCategory:r=>Sf[r]||[]}),{name:"onboarding-storage",partialize:e=>({onboardingData:e.onboardingData})})),Cf=()=>Date.now().toString()+Math.random().toString(36).substring(2,9),Df={id:Cf(),name:"Alex Chen",email:"alex.chen@example.com",isPremium:!1,memberSince:new Date,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",language:"en"},kd={totalGoals:0,completedGoals:0,currentStreak:0,longestStreak:0,totalTasks:0,completedTasks:0,totalHabits:0,activeHabits:0,journalEntries:0,timeBlocks:0},Tf={startOfWeek:"monday",dateFormat:"MM/DD/YYYY",timeFormat:"12h",defaultTaskPriority:"medium",defaultHabitFrequency:"daily",autoArchiveCompleted:!0,showTutorials:!0},Pa=nr()(Ir((e,t)=>({profile:Df,stats:kd,preferences:Tf,achievements:[],isAuthenticated:!0,isLoading:!1,setProfile:r=>{e({profile:r,isAuthenticated:!0})},updateProfile:r=>{e(a=>({profile:a.profile?{...a.profile,...r}:null}))},updatePreferences:r=>{e(a=>({preferences:{...a.preferences,...r}}))},updateStats:r=>{e(a=>({stats:{...a.stats,...r}}))},addAchievement:r=>{e(a=>({achievements:[r,...a.achievements]}))},signIn:r=>{e({profile:r,isAuthenticated:!0,isLoading:!1})},signOut:()=>{e({profile:null,isAuthenticated:!1,stats:kd,achievements:[]})},calculateStats:()=>({...t().stats,totalGoals:4,completedGoals:2,currentStreak:23,longestStreak:45,totalTasks:127,completedTasks:89,totalHabits:8,activeHabits:6,journalEntries:42,timeBlocks:15}),getDisplayName:()=>{const{profile:r}=t();return(r==null?void 0:r.name)||"User"},getProfileInitials:()=>{const{profile:r}=t();if(!(r!=null&&r.name))return"U";const a=r.name.split(" ");return a.length===1?a[0].charAt(0).toUpperCase():(a[0].charAt(0)+a[a.length-1].charAt(0)).toUpperCase()},isPremiumUser:()=>{const{profile:r}=t();return(r==null?void 0:r.isPremium)||!1},getCurrentStreak:()=>t().stats.currentStreak,getTotalCompletedItems:()=>{const{stats:r}=t();return r.completedGoals+r.completedTasks+r.journalEntries},initializeApp:async()=>{try{const{indexedDB:r}=await ge(async()=>{const{indexedDB:s}=await import("./indexedDB-Cri0QGyQ.js");return{indexedDB:s}},[],import.meta.url),a=await r.initializeAppMetadata("1.0.0");if(a.isFirstRun){const s=t().profile;s&&e({profile:{...s,id:a.installationId,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC"}})}(a.isUpdate||a.isFirstRun)&&setTimeout(()=>{r.createAutoBackup().catch(console.warn)},2e3),console.log(" App initialized:",{isFirstRun:a.isFirstRun,isUpdate:a.isUpdate,migrationNeeded:a.migrationNeeded,installationId:a.installationId})}catch(r){console.error("Failed to initialize app:",r)}}}),{name:"user-store",version:1}));function Ul(e,t=!0){const[r,a]=N.useState(null),[s,o]=N.useState(null);N.useEffect(()=>{if(!t)return;const i=l=>{const d=l.touches[0];d.clientX<30&&(a(d.clientX),o(d.clientY))},c=l=>{if(!r||!s)return;const d=l.changedTouches[0].clientX,h=l.changedTouches[0].clientY,u=d-r,f=Math.abs(h-s);u>100&&f<50&&e(),a(null),o(null)};return document.addEventListener("touchstart",i),document.addEventListener("touchend",c),()=>{document.removeEventListener("touchstart",i),document.removeEventListener("touchend",c)}},[r,s,e,t])}const Mr=()=>Date.now().toString()+Math.random().toString(36).substring(2,9),wd=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`},Fr=e=>{if(!e)return!1;const t=new Date,r=new Date(e);return r.toDateString()!==t.toDateString()&&r<t},qn=e=>{if(!e)return!1;const t=new Date;return new Date(e).toDateString()===t.toDateString()},Bo=e=>{if(!e)return!1;const t=new Date,r=new Date(e);if(r.toDateString()===t.toDateString())return!1;const a=r.getTime()-t.getTime(),s=Math.ceil(a/(1e3*60*60*24));return s>0&&s<=7},wt=e=>{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(t.getTime()+30*24*60*60*1e3),s=new Map,o=[];e.forEach(c=>{if(c.isRecurring||c.originalTaskId){const l=c.originalTaskId||c.id;s.has(l)||s.set(l,[]),s.get(l).push(c)}else o.push(c)});const i=[];return s.forEach((c,l)=>{c.sort((h,u)=>!h.dueDate&&!u.dueDate?0:h.dueDate?u.dueDate?new Date(h.dueDate).getTime()-new Date(u.dueDate).getTime():-1:1),console.log(" filterNextOccurrenceOnly - processing group:",{groupKey:l,groupSize:c.length,taskNames:c.map(h=>`${h.name} (${h.dueDate})`),today:r.toISOString(),oneMonthFromNow:a.toISOString()});const d=c.find(h=>{if(!h.dueDate)return!1;const u=new Date(h.dueDate),f=u>=r&&u<=a;return console.log(" filterNextOccurrenceOnly - checking task:",{taskName:h.name,dueDate:u.toISOString(),isWithinRange:f,comparison:`${u.toISOString()} >= ${r.toISOString()} && ${u.toISOString()} <= ${a.toISOString()}`}),f});d?(console.log(" filterNextOccurrenceOnly - selected next occurrence:",d.name),i.push(d)):console.log(" filterNextOccurrenceOnly - no next occurrence found for group:",l)}),[...o,...i]},Oe=nr()(Ir((e,t)=>({tasks:[],currentFilter:"all",isModalOpen:!1,selectedTask:void 0,addTask:r=>{var o;const a=Mr(),s={id:a,name:r.name,description:r.description,type:r.type,status:"pending",priority:r.priority,dueDate:r.dueDate?new Date(r.dueDate):void 0,createdAt:new Date,updatedAt:new Date,goalId:r.goalId||void 0,estimatedTime:r.estimatedTime?parseInt(r.estimatedTime.toString()):void 0,location:r.location||void 0,reminderTime:r.reminderTime?new Date(r.reminderTime):void 0,notes:r.notes||void 0,tags:r.tags||[],subtasks:r.subtasks.filter(i=>i&&i.trim()!=="").map(i=>({id:Mr(),name:i.trim(),completed:!1,createdAt:new Date})),shoppingItems:((o=r.shoppingItems)==null?void 0:o.map(i=>({id:Mr(),name:i.name,quantity:i.quantity,completed:!1})))||[],isRecurring:r.isRecurring||!1,recurrenceType:r.recurrenceType,recurrenceInterval:r.recurrenceInterval,recurrenceStartDate:r.recurrenceStartDate,recurrenceEndDate:r.recurrenceEndDate||(r.isRecurring?(()=>{const i=r.recurrenceStartDate?new Date(r.recurrenceStartDate):new Date,c=new Date(i);return c.setFullYear(c.getFullYear()+1),console.log(" Set default 1-year end date for new recurring task:",r.name,"End date:",c.toISOString().split("T")[0]),c})():void 0),addToCalendar:r.addToCalendar||!1,calendarStartTime:r.calendarStartTime,calendarDuration:r.calendarDuration,calendarDate:r.calendarDate,allDayTask:r.allDayTask||!1};return e(i=>({tasks:[s,...i.tasks],isModalOpen:!1})),s.isRecurring?(console.log(" Generating recurring tasks for:",s.name),t().generateRecurringTasks(s),console.log(" Repetitive task created, instances will appear as all-day event cards")):s.addToCalendar?(console.log(" Creating calendar entry for non-recurring task:",s.name),t().createCalendarEntryForTask(s)):console.log(" No calendar integration for task:",s.name),s.goalId&&ge(async()=>{const{useGoalStore:i}=await Promise.resolve().then(()=>Qe);return{useGoalStore:i}},void 0,import.meta.url).then(({useGoalStore:i})=>{i.getState().updateGoalProgress(s.goalId)}).catch(console.warn),a},updateTask:(r,a)=>{console.log(" Task Store: Updating task",r,a);const s=t().tasks.find(i=>i.id===r);e(i=>({tasks:i.tasks.map(c=>{if(c.id===r){const l={...c,...a,updatedAt:new Date};if(l.isRecurring&&!l.recurrenceEndDate&&!c.isRecurring){const d=l.recurrenceStartDate?new Date(l.recurrenceStartDate):new Date,h=new Date(d);h.setFullYear(h.getFullYear()+1),l.recurrenceEndDate=h,console.log(" Set default 1-year end date for recurring task:",l.name,"End date:",h.toISOString().split("T")[0])}return a.subtasks&&(l.subtasks=a.subtasks.map((d,h)=>typeof d=="string"?{id:`${r}-${h}-${Date.now()}`,name:d,completed:!1,createdAt:new Date}:d&&typeof d=="object"?{id:d.id||`${r}-${h}-${Date.now()}`,name:d.name,completed:d.completed!==void 0?d.completed:!1,createdAt:d.createdAt||new Date}:d)),a.shoppingItems&&(l.shoppingItems=a.shoppingItems.map((d,h)=>d&&typeof d=="object"?{id:d.id||`${r}-shop-${h}-${Date.now()}`,name:d.name,quantity:d.quantity||"1",completed:d.completed!==void 0?d.completed:!1}:d)),console.log(" Task Store: Updated task structure",l),l}return c})}));const o=t().tasks.find(i=>i.id===r);if(o&&s){const i=s.isRecurring,c=o.isRecurring;!i&&c?(console.log(" Task became recurring, generating instances for:",o.name),t().generateRecurringTasks(o),console.log(" Task converted to repetitive, instances will appear as all-day event cards")):i&&!c?(console.log(" Task stopped being recurring, cleaning up instances for:",o.name),t().cleanupRecurringTasks(r)):i&&c&&(s.recurrenceType!==o.recurrenceType||s.recurrenceInterval!==o.recurrenceInterval||s.recurrenceStartDate!==o.recurrenceStartDate||s.recurrenceEndDate!==o.recurrenceEndDate)&&(console.log(" Recurring parameters changed, regenerating instances for:",o.name),t().cleanupRecurringTasks(r),t().generateRecurringTasks(o)),new Set([s==null?void 0:s.goalId,o.goalId].filter(Boolean)).forEach(d=>{d&&ge(async()=>{const{useGoalStore:h}=await Promise.resolve().then(()=>Qe);return{useGoalStore:h}},void 0,import.meta.url).then(({useGoalStore:h})=>{h.getState().updateGoalProgress(d)}).catch(console.warn)})}},deleteTask:r=>{const a=t().tasks.find(s=>s.id===r);a!=null&&a.isRecurring&&t().cleanupRecurringTasks(r),e(s=>({tasks:s.tasks.filter(o=>o.id!==r)})),a!=null&&a.goalId&&ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a.goalId)}).catch(console.warn)},deleteSingleRecurringTask:r=>{const a=t().tasks.find(s=>s.id===r);e(s=>({tasks:s.tasks.filter(o=>o.id!==r)})),a!=null&&a.goalId&&ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a.goalId)}).catch(console.warn)},deleteAllRecurringTasks:r=>{const a=t().tasks.find(o=>o.id===r),s=a==null?void 0:a.goalId;e(o=>({tasks:o.tasks.filter(i=>i.id!==r)})),t().cleanupRecurringTasks(r),s&&ge(async()=>{const{useGoalStore:o}=await Promise.resolve().then(()=>Qe);return{useGoalStore:o}},void 0,import.meta.url).then(({useGoalStore:o})=>{o.getState().updateGoalProgress(s)}).catch(console.warn)},toggleTask:r=>{const a=t().tasks.find(s=>s.id===r);e(s=>({tasks:s.tasks.map(o=>{if(o.id===r){const i=o.status==="completed"?"pending":"completed";return{...o,status:i,updatedAt:new Date}}return o})})),a!=null&&a.goalId&&ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a.goalId)}).catch(console.warn)},toggleSubtask:(r,a)=>{console.log(" Task Store: Toggling subtask",{taskId:r,subtaskId:a}),e(s=>({tasks:s.tasks.map(o=>{if(o.id===r){const i=o.subtasks.map(c=>{if(typeof c=="string"){const l=`${r}-${o.subtasks.indexOf(c)}`;return l===a?{id:l,name:c,completed:!0,createdAt:new Date}:{id:l,name:c,completed:!1,createdAt:new Date}}else if(c.id===a)return{...c,completed:!c.completed};return c});return console.log(" Task Store: Updated subtasks for task",r,i),{...o,subtasks:i,updatedAt:new Date}}return o})}))},toggleShoppingItem:(r,a)=>{e(s=>({tasks:s.tasks.map(o=>{var i;return o.id===r?{...o,shoppingItems:((i=o.shoppingItems)==null?void 0:i.map(c=>c.id===a?{...c,completed:!c.completed}:c))||[],updatedAt:new Date}:o})}))},setFilter:r=>{e({currentFilter:r})},openModal:()=>{e({isModalOpen:!0})},closeModal:()=>{e({isModalOpen:!1,selectedTask:void 0})},selectTask:r=>{e({selectedTask:r})},getFilteredTasks:()=>{const{tasks:r,currentFilter:a}=t();switch(a){case"today":const s=r.filter(i=>qn(i.dueDate)&&!Fr(i.dueDate)&&i.status!=="completed");console.log(" Today filter - before filterNextOccurrenceOnly:",{totalTasks:r.length,todayTasksFound:s.length,todayTaskNames:s.map(i=>`${i.name} (${i.dueDate}) recurring:${i.isRecurring||!!i.originalTaskId}`)});const o=wt(s);return console.log(" Today filter - after filterNextOccurrenceOnly:",{filteredCount:o.length,filteredTaskNames:o.map(i=>`${i.name} (${i.dueDate})`)}),o;case"upcoming":return wt(r.filter(i=>Bo(i.dueDate)&&!Fr(i.dueDate)&&!qn(i.dueDate)&&i.status!=="completed"));case"repetitive":return t().getRepetitiveTasks();case"overdue":return wt(r.filter(i=>Fr(i.dueDate)&&i.status!=="completed"));case"completed":return wt(r.filter(i=>i.status==="completed"));default:return wt(r)}},getTasksBySection:()=>{const{tasks:r}=t(),a=wt(r.filter(s=>s.status!=="completed"));return{overdue:a.filter(s=>Fr(s.dueDate)),today:a.filter(s=>qn(s.dueDate)&&!Fr(s.dueDate)),upcoming:a.filter(s=>Bo(s.dueDate)&&!Fr(s.dueDate)&&!qn(s.dueDate)),noDueDate:a.filter(s=>!s.dueDate)}},getTaskCounts:()=>{const{tasks:r}=t();return{all:wt(r).length,today:wt(r.filter(a=>qn(a.dueDate)&&a.status!=="completed")).length,upcoming:wt(r.filter(a=>Bo(a.dueDate)&&a.status!=="completed")).length,repetitive:t().getRepetitiveTasks().length,overdue:wt(r.filter(a=>Fr(a.dueDate)&&a.status!=="completed")).length,completed:wt(r.filter(a=>a.status==="completed")).length}},getRepetitiveTasks:()=>{const{tasks:r}=t(),a=new Date,s=new Date(a.getTime()+90*24*60*60*1e3),o=r.filter(l=>(l.isRecurring||l.originalTaskId)&&l.status!=="completed"),i=new Map;o.forEach(l=>{const d=l.originalTaskId||l.id;i.has(d)||i.set(d,[]),i.get(d).push(l)});const c=[];return i.forEach((l,d)=>{l.sort((u,f)=>!u.dueDate&&!f.dueDate?0:u.dueDate?f.dueDate?new Date(u.dueDate).getTime()-new Date(f.dueDate).getTime():-1:1),l.filter(u=>{if(!u.dueDate)return!1;const f=new Date(u.dueDate);return f>=a&&f<=s}).forEach(u=>{const f=u.dueDate?new Date(u.dueDate):null;let g=!1;if(f){const v=new Date(a.getFullYear(),a.getMonth(),a.getDate()),D=new Date(f.getFullYear(),f.getMonth(),f.getDate()),y=Math.ceil((D.getTime()-v.getTime())/(1e3*60*60*24));g=y>0&&y<=14}const m={...u,_repetitiveGroup:{isUpcoming:g,monthGroup:u.dueDate?new Date(u.dueDate).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"No Due Date",allInstances:l.length}};c.push(m)})}),c.sort((l,d)=>{const h=l._repetitiveGroup,u=d._repetitiveGroup;return h.isUpcoming&&!u.isUpcoming?-1:!h.isUpcoming&&u.isUpcoming?1:!l.dueDate&&!d.dueDate?0:l.dueDate?d.dueDate?new Date(l.dueDate).getTime()-new Date(d.dueDate).getTime():-1:1})},filterNextOccurrenceOnly:r=>wt(r),linkTaskToGoal:(r,a)=>{e(s=>({tasks:s.tasks.map(o=>o.id===r?{...o,goalId:a,updatedAt:new Date}:o)})),ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a)}).catch(console.warn)},unlinkTaskFromGoal:(r,a)=>{e(s=>({tasks:s.tasks.map(o=>o.id===r&&o.goalId===a?{...o,goalId:void 0,updatedAt:new Date}:o)})),ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a)}).catch(console.warn)},getTasksByGoal:r=>{const{tasks:a}=t();return a.filter(s=>s.goalId===r)},cleanupEmptySubtasks:()=>{e(r=>({tasks:r.tasks.map(a=>({...a,subtasks:a.subtasks.filter(s=>typeof s=="string"?s.trim()!=="":s.id&&s.name!==void 0&&s.name!==null).map(s=>typeof s=="string"?{id:Mr(),name:s,completed:!1,createdAt:new Date}:s)}))}))},generateRecurringTasks:r=>{var l,d;if(!r.isRecurring)return;const{tasks:a}=t();let s;r.recurrenceStartDate?s=new Date(r.recurrenceStartDate):r.dueDate?s=new Date(r.dueDate):s=new Date;const o=r.recurrenceEndDate?new Date(r.recurrenceEndDate):new Date(s.getTime()+365*24*60*60*1e3),i=[],c=new Date(s);for(;c<=o;){const h=wd(c);if(!((l=r.recurrenceExceptions)!=null&&l.includes(h))){const u={...r,id:Mr(),dueDate:new Date(c),originalTaskId:r.id,isRecurring:!1,allDayTask:r.allDayTask,createdAt:new Date,updatedAt:new Date,subtasks:r.subtasks.map(f=>({...f,id:Mr(),completed:!1,createdAt:new Date})),shoppingItems:((d=r.shoppingItems)==null?void 0:d.map(f=>({...f,id:Mr(),completed:!1})))||[]};if(i.push(u),i.length>=100)break}r.recurrenceType==="daily"?c.setDate(c.getDate()+(r.recurrenceInterval||1)):r.recurrenceType==="weekly"?c.setDate(c.getDate()+7*(r.recurrenceInterval||1)):r.recurrenceType==="monthly"&&c.setMonth(c.getMonth()+(r.recurrenceInterval||1))}e(h=>({tasks:[...h.tasks,...i]})),console.log(" Generated",i.length,"recurring instances, will appear as all-day event cards")},cleanupRecurringTasks:r=>{e(a=>({tasks:a.tasks.filter(s=>s.originalTaskId!==r)}))},createCalendarEntryForTask:r=>{if(console.log(" createCalendarEntryForTask called with task:",{taskId:r.id,taskName:r.name,addToCalendar:r.addToCalendar,calendarStartTime:r.calendarStartTime,calendarDate:r.calendarDate,isRecurring:r.isRecurring,dueDate:r.dueDate}),!r.addToCalendar){console.log(" Task calendar integration disabled");return}if(!r.allDayTask&&!r.calendarStartTime){console.log(" Missing calendarStartTime for timed task");return}let a=null;if(r.isRecurring&&r.dueDate?(a=new Date(r.dueDate),console.log(" Using dueDate for recurring task:",r.dueDate)):!r.isRecurring&&r.calendarDate?(a=new Date(r.calendarDate),console.log(" Using calendarDate for non-recurring task:",r.calendarDate)):r.dueDate?(a=new Date(r.dueDate),console.log(" Using dueDate as fallback:",r.dueDate)):r.isRecurring||(a=new Date,console.log(" Defaulting to today for non-recurring task without calendar date")),!a){console.log(" No valid date found for calendar entry",{isRecurring:r.isRecurring,hasCalendarDate:!!r.calendarDate,hasDueDate:!!r.dueDate,calendarDate:r.calendarDate,dueDate:r.dueDate});return}Promise.all([ge(()=>Promise.resolve().then(()=>Ef),void 0,import.meta.url),ge(()=>Promise.resolve().then(()=>ug),void 0,import.meta.url),ge(()=>Promise.resolve().then(()=>Gy),void 0,import.meta.url)]).then(([{useCalendarStore:s},{useSettingsStore:o},{getAccentColorValue:i}])=>{console.log(" Calendar store imported successfully");const c=s.getState(),l=o.getState(),d=i(l.accentColor),h=wd(a);console.log(" Creating calendar entry with dateString:",h);const u={title:r.name,description:r.description||"Task reminder",date:h,startTime:r.allDayTask?"00:00":r.calendarStartTime,durationMinutes:r.allDayTask?1440:r.calendarDuration||60,blockType:r.allDayTask?"all-day-task":"admin",icon:"",color:r.allDayTask?`linear-gradient(135deg, ${d}, ${d}dd)`:r.type==="deadline"?"linear-gradient(135deg, #EF4444, #DC2626)":r.type==="to-buy"?"linear-gradient(135deg, #F59E0B, #D97706)":"linear-gradient(135deg, #8B5CF6, #7C3AED)",linkedItemType:"task",linkedItemId:r.id,allDay:r.allDayTask||!1,isRecurring:r.isRecurring&&r.recurrenceType!=="daily",recurrenceType:r.recurrenceType==="daily"?void 0:r.recurrenceType,recurrenceInterval:r.recurrenceType==="daily"?void 0:r.recurrenceInterval,recurrenceEndDate:r.recurrenceType==="daily"?void 0:r.recurrenceEndDate};console.log(" Time block data:",u);try{console.log(" About to call calendarStore.addTimeBlock..."),c.addTimeBlock(u),console.log(" Calendar entry created successfully");const f=c.timeBlocks;console.log(" Current time blocks count:",f.length);const g=f.find(m=>m.title===r.name&&m.linkedItemId===r.id);g?console.log(" Verified: Time block found in calendar store:",g.id):console.log(" Warning: Time block not found in calendar store after addition")}catch(f){console.error(" Error creating calendar entry:",f),console.error(" Error details:",{message:f instanceof Error?f.message:"Unknown error",stack:f instanceof Error?f.stack:void 0,timeBlockData:u})}}).catch(s=>{console.error(" Failed to import calendar store:",s)})}}),{name:"task-store",version:1})),jd=Object.freeze(Object.defineProperty({__proto__:null,useTaskStore:Oe},Symbol.toStringTag,{value:"Module"})),Nd=()=>Math.random().toString(36).substr(2,9),zo=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`},Ja=(e,t)=>{const[r,a]=e.split(":").map(Number),s=r*60+a+t,o=Math.floor(s/60)%24,i=s%60;return`${o.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},yt=nr()(Ir((e,t)=>({timeBlocks:[],currentView:"day",currentDate:new Date,addTimeBlock:async r=>{console.log(" Calendar Store: Adding time block:",r.title);const a={id:Nd(),...r,status:"scheduled",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{e(s=>{const o={...s,timeBlocks:[...s.timeBlocks,a]};return console.log(" Calendar Store: Updated timeBlocks count:",o.timeBlocks.length),o}),a.isRecurring&&(console.log(" Calendar Store: Generating recurring events for:",a.title),t().generateRecurringEvents(a)),console.log(" Calendar Store: Successfully added time block:",a.title)}catch(s){throw console.error(" Calendar Store: Failed to add time block:",s),s}},updateTimeBlock:async(r,a)=>{console.log(" Calendar Store: Updating time block:",r);try{e(s=>({timeBlocks:s.timeBlocks.map(o=>o.id===r?{...o,...a,updatedAt:new Date().toISOString()}:o)})),console.log(" Calendar Store: Successfully updated time block:",r)}catch(s){throw console.error(" Calendar Store: Failed to update time block:",s),s}},deleteTimeBlock:r=>{console.log(" Calendar Store: Deleting time block with ID:",r);const{timeBlocks:a}=t(),s=a.find(o=>o.id===r);s!=null&&s.isRecurring&&t().cleanupRecurringEvents(r),e(o=>{const i=o.timeBlocks.filter(c=>c.id!==r);return console.log(" Calendar Store: Blocks before deletion:",o.timeBlocks.length),console.log(" Calendar Store: Blocks after deletion:",i.length),{timeBlocks:i}})},toggleTimeBlockCompletion:r=>{e(a=>({timeBlocks:a.timeBlocks.map(s=>s.id===r?{...s,status:s.status==="completed"?"scheduled":"completed",updatedAt:new Date().toISOString()}:s)}))},setCurrentView:r=>{e({currentView:r})},setCurrentDate:r=>{e({currentDate:new Date(r)})},navigateToDay:r=>{e({currentView:"day",currentDate:new Date(r)})},navigatePrevious:()=>{const{currentDate:r}=t(),a=new Date(r);a.setDate(a.getDate()-1),e({currentDate:a})},navigateNext:()=>{const{currentDate:r}=t(),a=new Date(r);a.setDate(a.getDate()+1),e({currentDate:a})},getDayViewData:r=>{const{timeBlocks:a}=t(),s=zo(r);console.log("Calendar getDayViewData:",{requestedDate:s,totalTimeBlocks:a.length,allBlockDates:a.map(l=>l.date)});const o=a.filter(l=>l.date===s);console.log("Filtered timeBlocks for date:",{date:s,foundBlocks:o.length,blocks:o});const i=o.map(l=>({id:l.id,title:l.title,description:l.description,date:l.date,startTime:l.startTime,endTime:Ja(l.startTime,l.durationMinutes),type:l.blockType==="milestone"?"milestone":l.blockType==="all-day-task"?"repetitive-task":"timeblock",icon:l.icon,color:l.color,completed:l.status==="completed",linkedId:l.id,allDay:l.allDay,goalId:l.goalId,milestoneId:l.milestoneId})),c={totalTasks:o.filter(l=>l.linkedItemType==="task").length,totalHabits:o.filter(l=>l.linkedItemType==="habit").length,completedItems:i.filter(l=>l.completed).length};return{date:s,events:i,stats:c}},getEventsForDate:r=>{const a=zo(r);return t().getAllEventsForDate(a)},getAllEventsForDate:r=>{const{timeBlocks:a}=t();return a.filter(s=>s.date===r).map(s=>({id:s.id,title:s.title,description:s.description,date:s.date,startTime:s.startTime,endTime:Ja(s.startTime,s.durationMinutes),type:"timeblock",icon:s.icon,color:s.color,completed:s.status==="completed",linkedId:s.id}))},checkTimeConflict:(r,a,s,o)=>{const{timeBlocks:i}=t(),c=Ja(a,s);return i.some(l=>{if(l.id===o||l.date!==r)return!1;const d=Ja(l.startTime,l.durationMinutes);return a>=l.startTime&&a<d||c>l.startTime&&c<=d||a<=l.startTime&&c>=d})},generateRecurringEvents:r=>{var l;if(!r.isRecurring)return;console.log(" Generating recurring events for:",r.title,{recurrenceType:r.recurrenceType,recurrenceInterval:r.recurrenceInterval,startDate:r.date,endDate:r.recurrenceEndDate});const{timeBlocks:a}=t(),s=new Date(r.date),o=r.recurrenceEndDate?new Date(r.recurrenceEndDate):new Date(s.getTime()+365*24*60*60*1e3),i=[],c=new Date(s);for(;c<=o&&i.length<100&&(r.recurrenceType==="weekly"?c.setDate(c.getDate()+7*(r.recurrenceInterval||1)):r.recurrenceType==="monthly"?c.setMonth(c.getMonth()+(r.recurrenceInterval||1)):r.recurrenceType==="daily"&&c.setDate(c.getDate()+(r.recurrenceInterval||1)),!(c>o));){const d=zo(c);if((l=r.recurrenceExceptions)!=null&&l.includes(d))continue;console.log(" Creating instance for date:",d);const h={...r,id:Nd(),date:d,originalEventId:r.id,isRecurring:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};i.push(h)}console.log(" Generated",i.length,"recurring instances"),i.length>0&&e(d=>({timeBlocks:[...d.timeBlocks,...i]}))},isRecurringEvent:r=>{const{timeBlocks:a}=t(),s=a.find(o=>o.id===r);return!!(s!=null&&s.isRecurring||s!=null&&s.originalEventId)},getOriginalEventId:r=>{const{timeBlocks:a}=t(),s=a.find(o=>o.id===r);return(s==null?void 0:s.originalEventId)||(s!=null&&s.isRecurring?r:null)},deleteSingleRecurringEvent:r=>{console.log(" Calendar Store: Deleting single recurring event:",r),e(a=>({timeBlocks:a.timeBlocks.filter(s=>s.id!==r)}))},deleteRecurringSeries:r=>{console.log(" Calendar Store: Deleting entire recurring series:",r),e(a=>({timeBlocks:a.timeBlocks.filter(s=>s.id!==r&&s.originalEventId!==r)}))},toggleSingleRecurringCompletion:r=>{console.log(" Calendar Store: Toggling single recurring completion:",r),e(a=>({timeBlocks:a.timeBlocks.map(s=>s.id===r?{...s,status:s.status==="completed"?"scheduled":"completed",updatedAt:new Date().toISOString()}:s)}))},toggleRecurringSeriesCompletion:(r,a)=>{console.log(" Calendar Store: Toggling recurring series completion:",r,a),e(s=>({timeBlocks:s.timeBlocks.map(o=>o.id===r||o.originalEventId===r?{...o,status:a?"completed":"scheduled",updatedAt:new Date().toISOString()}:o)}))},cleanupRecurringEvents:r=>{e(a=>({timeBlocks:a.timeBlocks.filter(s=>s.originalEventId!==r)}))}}),{name:"calendar-store",version:1,partialize:e=>(console.log(" Calendar Store: Partializing state - timeBlocks count:",e.timeBlocks.length),{timeBlocks:e.timeBlocks,currentView:e.currentView,currentDate:e.currentDate}),onRehydrateStorage:()=>e=>{var t;e&&(console.log(" Calendar Store: Rehydrated - timeBlocks count:",((t=e.timeBlocks)==null?void 0:t.length)||0),e.currentDate&&typeof e.currentDate=="string"&&(e.currentDate=new Date(e.currentDate)))},storage:{getItem:e=>{try{const t=localStorage.getItem(e);return console.log(" Calendar Store: Retrieved from storage:",e,t?"success":"empty"),t}catch(t){return console.error(" Calendar Store: Storage getItem failed:",t),null}},setItem:(e,t)=>{try{localStorage.setItem(e,t),console.log(" Calendar Store: Saved to storage:",e,"success")}catch(r){console.error(" Calendar Store: Storage setItem failed:",r)}},removeItem:e=>{try{localStorage.removeItem(e),console.log(" Calendar Store: Removed from storage:",e)}catch(t){console.error(" Calendar Store: Storage removeItem failed:",t)}}}})),Ef=Object.freeze(Object.defineProperty({__proto__:null,useCalendarStore:yt},Symbol.toStringTag,{value:"Module"})),Xa=()=>Math.random().toString(36).substr(2,9),Ye=e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`},If=Ye(new Date),hs=e=>{const t=[];if(!e.calendarIntegration||!e.startDate||!e.scheduledTime)return t;const r=new Date(e.startDate),a=new Date,s=new Date(a.getTime()+8*7*24*60*60*1e3);if(e.frequency==="daily"){const o=Math.ceil((s.getTime()-r.getTime())/864e5);for(let i=0;i<=o;i++){const c=new Date(r.getTime()+i*24*60*60*1e3),l=Ye(c);t.push({title:e.name,description:e.description||"",date:l,startTime:e.scheduledTime,durationMinutes:30,blockType:"focus",icon:e.icon,color:e.color,linkedItemType:"habit",linkedItemId:e.id})}}else if(e.frequency==="weekly"&&e.selectedDays){const o={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},i=e.selectedDays.map(l=>o[l]),c=Math.ceil((s.getTime()-r.getTime())/(24*60*60*1e3));for(let l=0;l<=c;l++){const d=new Date(r.getTime()+l*24*60*60*1e3),h=d.getDay(),u=Ye(d);i.includes(h)&&t.push({title:e.name,description:e.description||"",date:u,startTime:e.scheduledTime,durationMinutes:30,blockType:"focus",icon:e.icon,color:e.color,linkedItemType:"habit",linkedItemId:e.id})}}return t};new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();const Pf=()=>{const e=He.getState(),t=yt.getState();t.timeBlocks.filter(a=>a.linkedItemType==="habit").forEach(a=>{t.deleteTimeBlock(a.id)}),e.habits.forEach(a=>{a.calendarIntegration&&hs(a).forEach(o=>{t.addTimeBlock(o)})})},He=nr()(Ir((e,t)=>({habits:[],completions:[],viewMode:"list",addHabit:r=>{const a="createdAt"in r,s=a?r.id:Xa(),o=r,i=a?{...r,completions:[]}:{id:s,...o,useGoalColor:o.goalId?o.useGoalColor??!0:!1,customColor:o.customColor||o.color,streak:0,completions:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(e(c=>({habits:[...c.habits,i]})),i.calendarIntegration){const c=hs(i),l=yt.getState();c.forEach(d=>{l.addTimeBlock(d)})}return i.goalId&&ge(async()=>{const{useGoalStore:c}=await Promise.resolve().then(()=>Qe);return{useGoalStore:c}},void 0,import.meta.url).then(({useGoalStore:c})=>{c.getState().updateGoalProgress(i.goalId)}).catch(console.warn),s},addHabitCompletion:r=>{e(a=>({completions:[...a.completions,r]}))},updateHabit:(r,a)=>{const{habits:s}=t(),o=s.find(l=>l.id===r);if(!o)return;const i={...o,...a,updatedAt:new Date().toISOString()};if(e(l=>({habits:l.habits.map(d=>d.id===r?i:d)})),a.calendarIntegration!==void 0||a.startDate||a.scheduledTime||a.frequency||a.selectedDays){const l=yt.getState();l.timeBlocks.filter(h=>h.linkedItemType==="habit"&&h.linkedItemId===r).forEach(h=>{l.deleteTimeBlock(h.id)}),i.calendarIntegration&&hs(i).forEach(u=>{l.addTimeBlock(u)})}new Set([o==null?void 0:o.goalId,i.goalId].filter(Boolean)).forEach(l=>{l&&ge(async()=>{const{useGoalStore:d}=await Promise.resolve().then(()=>Qe);return{useGoalStore:d}},void 0,import.meta.url).then(({useGoalStore:d})=>{d.getState().updateGoalProgress(l)}).catch(console.warn)})},deleteHabit:r=>{const a=t().habits.find(i=>i.id===r);e(i=>({habits:i.habits.filter(c=>c.id!==r),completions:i.completions.filter(c=>c.habitId!==r)}));const s=yt.getState();s.timeBlocks.filter(i=>i.linkedItemType==="habit"&&i.linkedItemId===r).forEach(i=>{s.deleteTimeBlock(i.id)}),a!=null&&a.goalId&&ge(async()=>{const{useGoalStore:i}=await Promise.resolve().then(()=>Qe);return{useGoalStore:i}},void 0,import.meta.url).then(({useGoalStore:i})=>{i.getState().updateGoalProgress(a.goalId)}).catch(console.warn)},toggleCompletion:(r,a)=>{const{completions:s,habits:o}=t(),i=o.find(l=>l.id===r);if(s.find(l=>l.habitId===r&&l.date===a))e(l=>({completions:l.completions.filter(d=>!(d.habitId===r&&d.date===a))}));else{const l={id:Xa(),habitId:r,date:a,completed:!0,completedAt:new Date().toISOString()};e(d=>({completions:[...d.completions,l]}))}i!=null&&i.goalId&&ge(async()=>{const{useGoalStore:l}=await Promise.resolve().then(()=>Qe);return{useGoalStore:l}},void 0,import.meta.url).then(({useGoalStore:l})=>{l.getState().updateGoalProgress(i.goalId)}).catch(console.warn)},setViewMode:r=>{e({viewMode:r})},getHabitCompletions:r=>{const{completions:a}=t();return a.filter(s=>s.habitId===r)},getHabitStreak:r=>{const{habits:a,completions:s}=t(),o=a.find(c=>c.id===r);return!o||s.filter(c=>c.habitId===r&&c.completed).sort((c,l)=>new Date(l.date).getTime()-new Date(c.date).getTime()).length===0?0:t().calculateStreakForFrequency(r,o.frequency)},calculateStreakForFrequency:(r,a)=>{const{habits:s,completions:o}=t(),i=s.find(d=>d.id===r);if(!i)return 0;const c=o.filter(d=>d.habitId===r&&d.completed).sort((d,h)=>new Date(h.date).getTime()-new Date(d.date).getTime());if(c.length===0)return 0;const l=new Date;switch(l.setHours(0,0,0,0),a){case"daily":return t().calculateDailyStreak(c,l,i);case"weekly":return t().calculateWeeklyStreak(c,i.selectedDays||[],l);case"custom":return t().calculateCustomStreak(c,i.customFrequency,l);default:return 0}},calculateDailyStreak:(r,a,s)=>{let o=0;const i=new Date(a);for(;;){const c=Ye(i),l=r.find(h=>h.date===c),d=l?l.completed:!1;if(d)o++;else if(c===Ye(a)){if(r.find(u=>u.date===c)&&!d)break}else break;i.setDate(i.getDate()-1)}return o},calculateWeeklyStreak:(r,a,s)=>{if(!a||a.length===0)return 0;const o={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},i=a.map(u=>o[u]);let c=0;const l=new Date(s),h=-l.getDay();for(l.setDate(l.getDate()+h);;){const u=new Date(l);u.setDate(u.getDate()+6);const f=s>=l&&s<=u;let g=0;for(const v of i){const D=new Date(l);D.setDate(D.getDate()+v);const y=Ye(D);r.find(x=>x.date===y&&x.completed)&&g++}const m=a.length;if(g===m)c++;else if(!f)break;l.setDate(l.getDate()-7)}return c},calculateCustomStreak:(r,a,s)=>{if(!a)return 0;let o=0;const{times:i,period:c}=a,l=new Date(s);if(l.setHours(0,0,0,0),c==="week"){const h=-l.getDay();l.setDate(l.getDate()+h)}else l.setDate(1);for(;;){const d=new Date(l);c==="week"?(d.setDate(d.getDate()+6),d.setHours(23,59,59,999)):(d.setMonth(d.getMonth()+1),d.setDate(0),d.setHours(23,59,59,999));const h=new Date(s);h.setHours(0,0,0,0);const u=h>=l&&h<=d;let f=0;for(const g of r){if(!g.completed)continue;const m=new Date(g.date+"T00:00:00");m.setHours(0,0,0,0),m>=l&&m<=d&&f++}if(console.log(`Custom Streak Debug - Period: ${Ye(l)} to ${Ye(d)}`),console.log(`  - Is Current Period: ${u}`),console.log(`  - Completions Found: ${f}/${i}`),console.log(`  - Current Streak: ${o}`),f>=i)o++;else if(!u)break;c==="week"?l.setDate(l.getDate()-7):l.setMonth(l.getMonth()-1)}return o},toggleDayCompletion:(r,a)=>{const{completions:s,habits:o}=t(),i=o.find(l=>l.id===r),c=s.find(l=>l.habitId===r&&l.date===a);if(c)e(l=>({completions:l.completions.map(d=>d.id===c.id?{...d,completed:!d.completed,completedAt:d.completed?void 0:new Date().toISOString()}:d)}));else{const l={id:Xa(),habitId:r,date:a,completed:!0,completedAt:new Date().toISOString()};e(d=>({completions:[...d.completions,l]}))}i!=null&&i.goalId&&ge(async()=>{const{useGoalStore:l}=await Promise.resolve().then(()=>Qe);return{useGoalStore:l}},void 0,import.meta.url).then(({useGoalStore:l})=>{l.getState().updateGoalProgress(i.goalId)}).catch(console.warn)},isRequiredDay:(r,a)=>{const{habits:s}=t(),o=s.find(l=>l.id===r);if(!o)return!1;const c=new Date(a).getDay();switch(o.frequency){case"daily":return!0;case"weekly":if(!o.selectedDays)return!1;const l={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};return o.selectedDays.map(h=>l[h]).includes(c);case"custom":return!0;default:return!1}},getCompletionRate:(r,a=30)=>{const{habits:s,completions:o}=t();if(!s.find(f=>f.id===r))return 0;const c=new Date,l=new Date(c);l.setDate(l.getDate()-a);const d=o.filter(f=>f.habitId===r);let h=0,u=0;for(let f=new Date(l);f<=c;f.setDate(f.getDate()+1)){const g=Ye(f);if(t().isRequiredDay(r,g)){h++;const m=d.find(D=>D.date===g);(m?m.completed:!1)&&u++}}return h>0?Math.round(u/h*100):0},getLastTwoWeeksProgress:r=>{const{habits:a}=t();if(!a.find(d=>d.id===r))return[];const o=new Date,i=new Date(o);i.setDate(i.getDate()-13);const c=[],l=t().getHabitCompletions(r);for(let d=0;d<14;d++){const h=new Date(i);h.setDate(h.getDate()+d);const u=Ye(h),f=l.find(D=>D.date===u),g=u===Ye(o),m=t().isRequiredDay(r,u),v=f?f.completed:!1;c.push({date:u,completed:v,isToday:g,isRequired:m,value:f==null?void 0:f.value})}return c},isHabitCompletedToday:r=>{const{completions:a,habits:s}=t();s.find(i=>i.id===r);const o=a.find(i=>i.habitId===r&&i.date===If);return o?o.completed:!1},linkHabitToGoal:(r,a)=>{e(s=>({habits:s.habits.map(o=>o.id===r?{...o,goalId:a,updatedAt:new Date().toISOString()}:o)})),ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a)}).catch(console.warn)},unlinkHabitFromGoal:(r,a)=>{e(s=>({habits:s.habits.map(o=>o.id===r&&o.goalId===a?{...o,goalId:void 0,updatedAt:new Date().toISOString()}:o)})),ge(async()=>{const{useGoalStore:s}=await Promise.resolve().then(()=>Qe);return{useGoalStore:s}},void 0,import.meta.url).then(({useGoalStore:s})=>{s.getState().updateGoalProgress(a)}).catch(console.warn)},getHabitsByGoal:r=>{const{habits:a}=t();return a.filter(s=>s.goalId===r)},regenerateAllTimeBlocks:()=>{Pf()},changeHabitFrequency:(r,a,s,o,i)=>{const{habits:c}=t(),l=c.find(g=>g.id===r);if(!l)return;const d=t().getHabitStreak(r),h=l.frequency==="weekly"?"weeks":l.frequency==="custom"?"periods":"days",u={id:Xa(),changeDate:new Date().toISOString(),previousFrequency:{type:l.frequency,selectedDays:l.selectedDays,customFrequency:l.customFrequency},newFrequency:{type:a,selectedDays:s,customFrequency:o},streakAtChange:{value:d,type:h,label:`${d} ${h}`},reason:i};e(g=>({habits:g.habits.map(m=>m.id===r?{...m,frequency:a,selectedDays:s,customFrequency:o,frequencyHistory:[...m.frequencyHistory||[],u],updatedAt:new Date().toISOString()}:m)}));const f=t().habits.find(g=>g.id===r);if(f&&f.calendarIntegration){const g=yt.getState();g.timeBlocks.filter(D=>D.linkedItemType==="habit"&&D.linkedItemId===r).forEach(D=>{g.deleteTimeBlock(D.id)}),hs(f).forEach(D=>{g.addTimeBlock(D)})}},getHabitFrequencyHistory:r=>{const{habits:a}=t(),s=a.find(o=>o.id===r);return(s==null?void 0:s.frequencyHistory)||[]},getTotalStreakContext:r=>{const{habits:a}=t(),s=a.find(d=>d.id===r);if(!s)return{current:0,historical:0,label:"0 days"};const o=t().getHabitStreak(r),c=(s.frequencyHistory||[]).reduce((d,h)=>d+h.streakAtChange.value,0),l=s.frequency==="weekly"?"weeks":s.frequency==="custom"?"periods":"days";return c>0?{current:o,historical:c,label:`${o} ${l} (${c} total)`}:{current:o,historical:0,label:`${o} ${l}`}},getTotalCompletions:r=>{const{completions:a}=t();return a.filter(s=>s.habitId===r&&s.completed).length},getBestStreak:r=>{const{habits:a,completions:s}=t(),o=a.find(i=>i.id===r);return o?o.frequency==="daily"?t().calculateBestDailyStreak(r):o.frequency==="weekly"?t().calculateBestWeeklyStreak(r):t().calculateBestCustomStreak(r):0},calculateBestDailyStreak:r=>{const{completions:a}=t(),s=a.filter(l=>l.habitId===r&&l.completed).sort((l,d)=>new Date(l.date).getTime()-new Date(d.date).getTime());if(s.length===0)return 0;let o=0,i=0,c=null;for(const l of s){const d=new Date(l.date);c?Math.floor((d.getTime()-c.getTime())/864e5)===1?i++:(o=Math.max(o,i),i=1):i=1,c=d}return Math.max(o,i)},calculateBestWeeklyStreak:r=>{const{habits:a}=t(),s=a.find(c=>c.id===r);if(!s||!s.selectedDays)return 0;const o=new Date;let i=0;for(let c=0;c<52;c++){const l=new Date(o);l.setDate(l.getDate()-c*7);const d=t().calculateWeeklyStreak(t().getHabitCompletions(r),s.selectedDays,l);i=Math.max(i,d)}return i},calculateBestCustomStreak:r=>{const{habits:a}=t(),s=a.find(c=>c.id===r);if(!s||!s.customFrequency)return 0;const o=new Date;let i=0;s.customFrequency.period;for(let c=0;c<52;c++){const l=new Date(o);s.customFrequency.period==="week"?l.setDate(l.getDate()-c*7):l.setMonth(l.getMonth()-c);const d=t().calculateCustomStreak(t().getHabitCompletions(r),s.customFrequency,l);i=Math.max(i,d)}return i},getMonthlyProgress:r=>{const{completions:a}=t(),s=new Date,o=new Date(s.getFullYear(),s.getMonth(),1);return a.filter(i=>i.habitId===r&&new Date(i.date)>=o).map(i=>({date:i.date,completed:i.completed}))},isHabitCompletedOnDate:(r,a)=>{const{completions:s,habits:o}=t(),i=s.find(c=>c.habitId===r&&c.date===a);return i?i.completed:!1}}),{name:"habit-store",version:1})),Sd=Object.freeze(Object.defineProperty({__proto__:null,formatDateToString:Ye,useHabitStore:He},Symbol.toStringTag,{value:"Module"})),Af=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),Mf=e=>{const t=new Date;return(typeof e=="string"?new Date(e):e).toDateString()===t.toDateString()},Ff=e=>{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()+6),s=typeof e=="string"?new Date(e):e;return s>=r&&s<=a},Lf=e=>{const t=new Date,r=typeof e=="string"?new Date(e):e;return r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear()},Cr=nr()(Ir((e,t)=>({entries:[],currentFilter:"all",isModalOpen:!1,selectedEntry:void 0,searchQuery:"",isAutoSaving:!1,lastSaved:void 0,addEntry:r=>{const a={id:Af(),content:r.content,mood:r.mood||"neutral",createdAt:new Date,updatedAt:new Date,tags:r.tags.filter(s=>s.trim()!==""),linkedGoals:r.linkedGoals||[],linkedTasks:r.linkedTasks||[],linkedHabits:r.linkedHabits||[],characterCount:r.content.length};e(s=>({entries:[a,...s.entries],isModalOpen:!1,lastSaved:new Date}))},importEntry:r=>{const a={...r,createdAt:typeof r.createdAt=="string"?new Date(r.createdAt):r.createdAt,updatedAt:typeof r.updatedAt=="string"?new Date(r.updatedAt):r.updatedAt,characterCount:r.content.length};e(s=>({entries:[a,...s.entries],lastSaved:new Date}))},updateEntry:(r,a)=>{e(s=>({entries:s.entries.map(o=>o.id===r?{...o,...a,updatedAt:new Date,characterCount:a.content?a.content.length:o.characterCount}:o),lastSaved:new Date}))},deleteEntry:r=>{e(a=>({entries:a.entries.filter(s=>s.id!==r)}))},setFilter:r=>{e({currentFilter:r})},setSearchQuery:r=>{e({searchQuery:r})},openModal:()=>{e({isModalOpen:!0,selectedEntry:void 0})},closeModal:()=>{e({isModalOpen:!1,selectedEntry:void 0})},selectEntry:r=>{e({selectedEntry:r,isModalOpen:!0})},setAutoSaving:r=>{e({isAutoSaving:r})},autoSaveEntry:(r,a)=>{e(s=>s.entries.find(i=>i.id===r)?{entries:s.entries.map(i=>i.id===r?{...i,content:a,updatedAt:new Date,characterCount:a.length}:i),isAutoSaving:!0}:s),setTimeout(()=>{e(s=>({...s,isAutoSaving:!1,lastSaved:new Date}))},1e3)},getFilteredEntries:()=>{const{entries:r,currentFilter:a,searchQuery:s}=t();let o=r;switch(a){case"today":o=r.filter(i=>Mf(i.createdAt));break;case"this-week":o=r.filter(i=>Ff(i.createdAt));break;case"this-month":o=r.filter(i=>Lf(i.createdAt));break;default:o=r}if(s.trim()){const i=s.toLowerCase();o=o.filter(c=>c.content.toLowerCase().includes(i)||c.tags.some(l=>l.toLowerCase().includes(i)))}return o.sort((i,c)=>new Date(c.createdAt).getTime()-new Date(i.createdAt).getTime())},getEntriesByDate:()=>{const{entries:r}=t(),a={};return r.forEach(s=>{const i=(typeof s.createdAt=="string"?new Date(s.createdAt):s.createdAt).toISOString().split("T")[0];a[i]||(a[i]=[]),a[i].push(s)}),Object.keys(a).forEach(s=>{a[s].sort((o,i)=>{const c=typeof o.createdAt=="string"?new Date(o.createdAt):o.createdAt;return(typeof i.createdAt=="string"?new Date(i.createdAt):i.createdAt).getTime()-c.getTime()})}),a},getMoodStats:()=>{const{entries:r}=t(),a={"very-low":0,low:0,neutral:0,good:0,great:0};return r.forEach(s=>{a[s.mood]++}),a},getTagUsage:()=>{const{entries:r}=t(),a={};return r.forEach(s=>{s.tags.forEach(o=>{a[o]=(a[o]||0)+1})}),a}}),{name:"journal-store",version:1})),Of=Object.freeze(Object.defineProperty({__proto__:null,useJournalStore:Cr},Symbol.toStringTag,{value:"Module"})),_f=[{id:"marathon-training",name:"Run a Marathon",description:"Complete a full marathon (26.2 miles) with a structured 16-week training program designed for intermediate runners",category:"health",icon:"",color:"linear-gradient(135deg, #10B981, #22C55E)",estimatedDuration:"16-20 weeks",difficulty:"intermediate",popularity:"high",isPopular:!0,tags:["running","endurance","fitness","marathon","training"],realWorldValidation:{expertValidated:!0,basedOnProgram:"Hal Higdon Novice 1 Marathon Training",prerequisites:["Ability to run 3 miles continuously","No current injuries","Basic cardiovascular fitness","Medical clearance for intense exercise"],successRate:"85%",averageCompletionTime:"16 weeks",difficultyJustification:"Requires consistent training, gradual mileage buildup, and significant time commitment"},templateTasks:[{id:"week-1-schedule",name:"Week 1: Establish Base Training (12 miles total)",description:"Begin with manageable weekly mileage to build running base. Focus on consistency over speed.",priority:"high",estimatedTime:240,category:"training",weekNumber:1,details:"3 runs: 3mi easy, 3mi easy, 6mi long run at conversational pace"},{id:"week-2-schedule",name:"Week 2: Build Endurance (14 miles total)",description:"Increase weekly mileage gradually. Focus on comfortable effort level.",priority:"high",estimatedTime:280,category:"training",weekNumber:2,details:"3 runs: 3mi easy, 4mi easy, 7mi long run at conversational pace"},{id:"week-3-schedule",name:"Week 3: Expand Long Run (15 miles total)",description:"Continue building endurance with longer weekend run.",priority:"high",estimatedTime:300,category:"training",weekNumber:3,details:"3 runs: 3mi easy, 4mi easy, 8mi long run at conversational pace"},{id:"week-4-schedule",name:"Week 4: Recovery Week (11 miles total)",description:"Reduce mileage to allow body to adapt and recover from previous weeks.",priority:"high",estimatedTime:220,category:"training",weekNumber:4,details:"3 runs: 3mi easy, 3mi easy, 5mi long run at easy pace"},{id:"week-5-schedule",name:"Week 5: Resume Building (17 miles total)",description:"Return to building phase with increased weekly volume.",priority:"high",estimatedTime:340,category:"training",weekNumber:5,details:"3 runs: 4mi easy, 4mi easy, 9mi long run at conversational pace"},{id:"week-6-schedule",name:"Week 6: Double Digit Long Run (19 miles total)",description:"First double-digit long run - milestone achievement in training.",priority:"high",estimatedTime:380,category:"training",weekNumber:6,details:"3 runs: 4mi easy, 5mi easy, 10mi long run at conversational pace"},{id:"week-7-schedule",name:"Week 7: Peak Base Building (21 miles total)",description:"Highest mileage week in base building phase.",priority:"high",estimatedTime:420,category:"training",weekNumber:7,details:"3 runs: 5mi easy, 5mi easy, 11mi long run at conversational pace"},{id:"week-8-schedule",name:"Week 8: Recovery Week (13 miles total)",description:"Important recovery week before entering peak training phase.",priority:"high",estimatedTime:260,category:"training",weekNumber:8,details:"3 runs: 4mi easy, 3mi easy, 6mi long run at easy pace"},{id:"week-9-schedule",name:"Week 9: Enter Peak Phase (23 miles total)",description:"Begin peak training phase with longest long runs.",priority:"high",estimatedTime:460,category:"training",weekNumber:9,details:"3 runs: 5mi easy, 6mi easy, 12mi long run at marathon pace for middle 8mi"},{id:"week-10-schedule",name:"Week 10: Half Marathon Distance (25 miles total)",description:"Complete half marathon distance in long run - major milestone.",priority:"high",estimatedTime:500,category:"training",weekNumber:10,details:"3 runs: 6mi easy, 6mi easy, 13.1mi long run with race pace segments"},{id:"week-11-schedule",name:"Week 11: Peak Long Run (27 miles total)",description:"Longest training run - builds confidence for marathon distance.",priority:"high",estimatedTime:540,category:"training",weekNumber:11,details:"3 runs: 6mi easy, 7mi easy, 14mi long run with marathon pace practice"},{id:"week-12-schedule",name:"Week 12: Recovery Week (15 miles total)",description:"Recovery week after peak training phase to prepare for taper.",priority:"high",estimatedTime:300,category:"training",weekNumber:12,details:"3 runs: 5mi easy, 4mi easy, 6mi long run at easy pace"},{id:"week-13-schedule",name:"Week 13: Taper Begins (19 miles total)",description:"Begin 4-week taper to arrive fresh and strong for marathon.",priority:"high",estimatedTime:380,category:"training",weekNumber:13,details:"3 runs: 6mi easy, 5mi easy, 8mi long run with some marathon pace"},{id:"week-14-schedule",name:"Week 14: Continue Taper (15 miles total)",description:"Reduce training volume while maintaining fitness and sharpness.",priority:"high",estimatedTime:300,category:"training",weekNumber:14,details:"3 runs: 5mi easy, 4mi easy, 6mi long run at easy pace"},{id:"week-15-schedule",name:"Week 15: Final Preparation (11 miles total)",description:"Light training week focusing on staying loose and confident.",priority:"high",estimatedTime:220,category:"training",weekNumber:15,details:"3 runs: 4mi easy, 3mi easy, 4mi easy with some strides"},{id:"week-16-schedule",name:"Week 16: Marathon Week (29 miles total)",description:"Race week - minimal training, maximum preparation. Marathon day!",priority:"high",estimatedTime:300,category:"training",weekNumber:16,details:"2 easy runs (2mi, 1mi) plus 26.2mi MARATHON RACE DAY!"},{id:"gear-running-shoes",name:"Purchase Proper Running Shoes",description:"Get professionally fitted for running shoes at specialty running store. Replace every 300-500 miles.",priority:"high",estimatedTime:120,category:"preparation",dependsOn:[],details:"Visit running specialty store, get gait analysis, try multiple brands, break in gradually"},{id:"gear-clothing",name:"Acquire Appropriate Running Clothing",description:"Invest in moisture-wicking, chafe-resistant clothing for long runs and race day.",priority:"medium",estimatedTime:90,category:"preparation",details:"Moisture-wicking shirts, running shorts/tights, compression socks, weather-appropriate layers"},{id:"gear-accessories",name:"Get Training Accessories",description:"Essential accessories for training monitoring and comfort during long runs.",priority:"medium",estimatedTime:60,category:"preparation",details:"GPS watch or smartphone app, hydration belt/handheld, energy gels/snacks, anti-chafe products"},{id:"nutrition-plan",name:"Develop Marathon Nutrition Strategy",description:"Plan fueling strategy for training and race day. Practice during long runs.",priority:"high",estimatedTime:180,category:"preparation",details:"Research fueling options, practice during long runs, plan race day nutrition timeline"},{id:"race-registration",name:"Register for Target Marathon",description:"Choose and register for marathon race. Consider location, time of year, and difficulty.",priority:"high",estimatedTime:60,category:"preparation",details:"Research marathons, consider travel logistics, register early, plan accommodation if needed"},{id:"training-log",name:"Set Up Training Log System",description:"Establish system to track daily runs, weekly mileage, and how you feel.",priority:"medium",estimatedTime:30,category:"preparation",details:"Choose app or journal system, track distance, time, pace, effort level, how you felt"},{id:"recovery-plan",name:"Establish Recovery Protocols",description:"Plan for adequate sleep, rest days, and injury prevention strategies.",priority:"high",estimatedTime:90,category:"preparation",details:"Plan rest days, stretching routine, sleep schedule, foam rolling, when to see doctor"},{id:"backup-plan",name:"Create Contingency Plans",description:"Plan for weather, injury, illness, or other issues that could affect training or race.",priority:"medium",estimatedTime:45,category:"preparation",details:"Bad weather training options, injury protocol, backup race options, missed training adjustments"}],templateHabits:[{id:"daily-run",name:"Complete Scheduled Training Run",description:"Follow the weekly training schedule consistently. Quality over quantity - listen to your body.",icon:"",measurementType:"simple",frequency:"custom",customFrequency:{times:3,period:"week"},category:"training",priority:"high"},{id:"hydration",name:"Drink Adequate Water Daily",description:"Stay properly hydrated for optimal performance and recovery. Increase intake on run days.",icon:"",measurementType:"count",frequency:"daily",targetAmount:8,targetUnit:"glasses",category:"health",priority:"high"},{id:"sleep-quality",name:"Get 7-9 Hours of Quality Sleep",description:"Prioritize sleep for muscle recovery and adaptation. Most important for training adaptation.",icon:"",measurementType:"time",frequency:"daily",targetAmount:480,targetUnit:"minutes",category:"recovery",priority:"high"},{id:"stretching-mobility",name:"Post-Run Stretching & Mobility",description:"Spend 10-15 minutes on stretching and mobility work after each run to prevent injury.",icon:"",measurementType:"time",frequency:"custom",customFrequency:{times:3,period:"week"},targetAmount:15,targetUnit:"minutes",category:"recovery",priority:"medium"},{id:"nutrition-fueling",name:"Eat Balanced, Performance-Supporting Meals",description:"Focus on carbohydrates for fuel, protein for recovery, and vegetables for nutrients.",icon:"",measurementType:"simple",frequency:"daily",category:"nutrition",priority:"medium"},{id:"training-log-entry",name:"Log Training Data",description:"Record daily run details: distance, time, how you felt, any issues or improvements.",icon:"",measurementType:"simple",frequency:"custom",customFrequency:{times:3,period:"week"},category:"tracking",priority:"medium"},{id:"rest-day",name:"Take Scheduled Rest Days",description:"Complete rest or light cross-training. Rest days are when your body adapts and gets stronger.",icon:"",measurementType:"simple",frequency:"custom",customFrequency:{times:4,period:"week"},category:"recovery",priority:"high"},{id:"injury-prevention",name:"Body Awareness & Injury Prevention",description:"Daily check-in with your body. Note any pain, stiffness, or issues early.",icon:"",measurementType:"simple",frequency:"daily",category:"health",priority:"medium"}]}],$f={version:"1.0.0",lastUpdated:"2025-01-05",totalTemplates:1,categories:["health"],expertValidation:{marathonTemplate:{validator:"Hal Higdon Training Programs",source:"Proven marathon training methodology",validationDate:"2025-01-05",notes:"Based on Novice 1 program, adapted for Kage app structure"}}},Rf={templates:_f,metadata:$f};class Bf{constructor(){sr(this,"templates",[]);sr(this,"isLoaded",!1);sr(this,"loadingPromise",null)}async loadTemplates(){if(this.loadingPromise)return this.loadingPromise;if(!this.isLoaded)return this.loadingPromise=this._performLoad(),this.loadingPromise}async _performLoad(){try{console.log(" Loading goal templates from static import...");const t=Rf,r=this.validateTemplateCollection(t);if(!r.isValid){console.error(" Template validation failed:",r.errors),this.templates=this.getFallbackTemplates();return}this.templates=t.templates.map(a=>this.processTemplate(a)),this.isLoaded=!0,console.log(` Successfully loaded ${this.templates.length} goal templates`),console.log(" Template categories:",[...new Set(this.templates.map(a=>a.category))])}catch(t){console.error(" Error loading templates:",t),console.log(" Using fallback templates..."),this.templates=this.getFallbackTemplates()}finally{this.loadingPromise=null}}validateTemplateCollection(t){const r=[],a=[];if(!t||typeof t!="object")return r.push("Invalid template collection structure"),{isValid:!1,errors:r,warnings:a};if(!Array.isArray(t.templates))return r.push("Templates array is missing or invalid"),{isValid:!1,errors:r,warnings:a};t.templates.forEach((i,c)=>{const l=this.validateTemplate(i,c);r.push(...l)});const s=t.templates.map(i=>i.id).filter(Boolean),o=s.filter((i,c)=>s.indexOf(i)!==c);return o.length>0&&r.push(`Duplicate template IDs found: ${o.join(", ")}`),{isValid:r.length===0,errors:r,warnings:a}}validateTemplate(t,r){const a=[],s=`Template ${r+1}`;["id","name","description","category","icon","color"].forEach(c=>{(!t[c]||typeof t[c]!="string")&&a.push(`${s}: Missing or invalid ${c}`)}),Array.isArray(t.templateTasks)||a.push(`${s}: templateTasks must be an array`),Array.isArray(t.templateHabits)||a.push(`${s}: templateHabits must be an array`);const i=["health","career","learning","finance","relationships","personal","creative"];return t.category&&!i.includes(t.category)&&a.push(`${s}: Invalid category "${t.category}"`),t.templateTasks&&t.templateTasks.forEach((c,l)=>{c.priority&&(["low","medium","high","critical"].includes(c.priority)||a.push(`${s}, Task ${l+1}: Invalid priority "${c.priority}"`))}),a}processTemplate(t){return{id:t.id,name:t.name,description:t.description,category:t.category,icon:t.icon,color:t.color,estimatedDuration:t.estimatedDuration||"Not specified",difficulty:t.difficulty||"intermediate",popularity:t.popularity||"medium",isPopular:t.isPopular||!1,tags:t.tags||[],templateTasks:t.templateTasks||[],templateHabits:t.templateHabits||[],userCount:t.userCount,realWorldValidation:t.realWorldValidation}}async getTemplates(){return await this.loadTemplates(),[...this.templates]}async getTemplateById(t){return await this.loadTemplates(),this.templates.find(r=>r.id===t)}async getTemplatesByCategory(t){return await this.loadTemplates(),this.templates.filter(r=>r.category===t)}async getPopularTemplates(){return await this.loadTemplates(),this.templates.filter(t=>t.isPopular)}getFallbackTemplates(){return[{id:"health-fitness-fallback",name:"Get Fit & Strong",description:"Build a consistent workout routine and develop healthy eating habits.",category:"health",icon:"",color:"linear-gradient(135deg, #10B981, #22C55E)",estimatedDuration:"3-6 months",difficulty:"intermediate",popularity:"high",isPopular:!0,tags:["fitness","health","strength"],templateTasks:[{id:"1",name:"Set up workout routine",priority:"high",description:"Create a structured workout schedule",category:"preparation"}],templateHabits:[{id:"1",name:"Daily exercise",icon:"",measurementType:"simple",frequency:"daily",description:"Complete daily workout or physical activity"}]}]}async reloadTemplates(){this.isLoaded=!1,this.loadingPromise=null,this.templates=[],await this.loadTemplates()}async getTemplateStats(){await this.loadTemplates();const t=[...new Set(this.templates.map(a=>a.category))],r=this.templates.reduce((a,s)=>(a[s.difficulty]=(a[s.difficulty]||0)+1,a),{});return{totalTemplates:this.templates.length,categories:t.length,popularTemplates:this.templates.filter(a=>a.isPopular).length,byDifficulty:r,byCategory:t.reduce((a,s)=>(a[s]=this.templates.filter(o=>o.category===s).length,a),{})}}}const _r=new Bf,Cd=()=>Date.now().toString()+Math.random().toString(36).substring(2,9),zf=async()=>{try{if(console.log(" Initializing templates in goalStore..."),await _r.loadTemplates(),console.log(" Templates loaded successfully in goalStore"),typeof window<"u"){const e=await _r.getTemplates();console.log(` Loaded ${e.length} templates from templateLoader`)}}catch(e){console.error(" Failed to load templates in goalStore:",e),console.log(" Using legacy templates as fallback")}};try{zf()}catch(e){console.error(" Failed to initialize templates:",e)}const Dd=[{id:"health-fitness",name:"Get Fit & Strong",description:"Build a consistent workout routine and develop healthy eating habits for long-term fitness.",category:"health",icon:"",color:"linear-gradient(135deg, #10B981, #22C55E)",estimatedDuration:"3-6 months",difficulty:"intermediate",popularity:"high",isPopular:!0,tags:["fitness","health","strength"],templateTasks:[{id:"1",name:"Join a gym or set up home workout space",priority:"high"},{id:"2",name:"Create workout schedule",priority:"high"},{id:"3",name:"Plan healthy meal prep routine",priority:"medium"},{id:"4",name:"Buy workout clothes and equipment",priority:"medium"},{id:"5",name:"Set fitness goals and track progress",priority:"high"},{id:"6",name:"Find workout buddy or trainer",priority:"low"}],templateHabits:[{id:"1",name:"Morning workout",icon:"",measurementType:"simple",frequency:"daily"},{id:"2",name:"Drink 8 glasses of water",icon:"",measurementType:"count",frequency:"daily",targetAmount:8},{id:"3",name:"Eat healthy breakfast",icon:"",measurementType:"simple",frequency:"daily"},{id:"4",name:"Track calories",icon:"",measurementType:"simple",frequency:"daily"}]},{id:"career-sideproject",name:"Launch Side Project",description:"Take your side project idea from concept to launch with structured milestones.",category:"career",icon:"",color:"linear-gradient(135deg, #3B82F6, #60A5FA)",estimatedDuration:"3-4 months",difficulty:"advanced",popularity:"high",isPopular:!0,tags:["entrepreneurship","project","launch"],templateTasks:[{id:"1",name:"Define project scope and requirements",priority:"critical"},{id:"2",name:"Create project timeline and milestones",priority:"high"},{id:"3",name:"Set up development environment",priority:"high"},{id:"4",name:"Design user interface and experience",priority:"high"},{id:"5",name:"Develop MVP features",priority:"critical"},{id:"6",name:"Test with beta users",priority:"high"},{id:"7",name:"Create landing page and marketing materials",priority:"medium"},{id:"8",name:"Launch and gather feedback",priority:"critical"}],templateHabits:[{id:"1",name:"Daily coding/development",icon:"",measurementType:"time",frequency:"daily",targetAmount:120},{id:"2",name:"Research competitors",icon:"",measurementType:"simple",frequency:"weekly"}]},{id:"learning-spanish",name:"Learn Spanish",description:"Achieve conversational Spanish fluency through structured learning and practice.",category:"learning",icon:"",color:"linear-gradient(135deg, #F59E0B, #FBBF24)",estimatedDuration:"6-12 months",difficulty:"intermediate",popularity:"medium",isPopular:!1,tags:["language","spanish","fluency"],templateTasks:[{id:"1",name:"Choose learning platform or course",priority:"high"},{id:"2",name:"Set up study schedule",priority:"high"},{id:"3",name:"Find conversation partner",priority:"medium"},{id:"4",name:"Download language learning apps",priority:"low"},{id:"5",name:"Join Spanish learning community",priority:"medium"},{id:"6",name:"Plan trip to Spanish-speaking country",priority:"low"}],templateHabits:[{id:"1",name:"Daily Spanish lessons",icon:"",measurementType:"time",frequency:"daily",targetAmount:30},{id:"2",name:"Practice speaking",icon:"",measurementType:"time",frequency:"daily",targetAmount:15},{id:"3",name:"Learn new vocabulary",icon:"",measurementType:"count",frequency:"daily",targetAmount:10}]}],Ho={isOpen:!1,mode:"template",currentStep:0,formData:{}},Hf={category:"all",status:"all",priority:"all"},De=nr()(Ir((e,t)=>({goals:[],templates:Dd,currentFilter:Hf,viewMode:"list",modalState:Ho,selectedGoal:void 0,addGoal:r=>{const a=Cd(),s={id:a,name:r.name,description:r.description,category:r.category,icon:r.icon,color:r.color,targetDate:r.targetDate,isCompleted:!1,priority:r.priority,motivation:r.motivation,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),progress:{percentage:0,tasksCompleted:0,tasksTotal:0,habitsActive:0,habitCompletionRate:0,currentStreak:0,longestStreak:0,lastUpdated:new Date().toISOString()},milestones:[],progressSettings:{calculationMode:"tasks",timeframe:"30days"},linkedTaskIds:[],linkedHabitIds:[],linkedJournalIds:[],tags:r.tags||[],isArchived:!1};return e(o=>({goals:[...o.goals,s],modalState:{...Ho}})),setTimeout(()=>{t().updateGoalProgress(a)},100),a},updateGoal:(r,a)=>{e(s=>{var o;return{goals:s.goals.map(i=>i.id===r?{...i,...a,updatedAt:new Date().toISOString()}:i),selectedGoal:((o=s.selectedGoal)==null?void 0:o.id)===r?{...s.selectedGoal,...a,updatedAt:new Date().toISOString()}:s.selectedGoal}})},deleteGoal:r=>{e(a=>{var s;return{goals:a.goals.filter(o=>o.id!==r),selectedGoal:((s=a.selectedGoal)==null?void 0:s.id)===r?void 0:a.selectedGoal}})},toggleGoalCompletion:r=>{const a=t().goals.find(o=>o.id===r);if(!a)return;const s={isCompleted:!a.isCompleted,completedAt:a.isCompleted?void 0:new Date().toISOString(),updatedAt:new Date().toISOString()};a.isCompleted||(s.progress={...a.progress,percentage:100,lastUpdated:new Date().toISOString()}),t().updateGoal(r,s)},archiveGoal:r=>{console.log(" Goal Store: Archiving goal:",r),t().updateGoal(r,{isArchived:!0,updatedAt:new Date().toISOString()})},unarchiveGoal:r=>{console.log(" Goal Store: Unarchiving goal:",r),t().updateGoal(r,{isArchived:!1,updatedAt:new Date().toISOString()})},updateGoalProgress:async r=>{var g,m;const a=t().goals.find(v=>v.id===r);if(!a)return;let s=0,o=0,i=0,c=0;try{let v,D;try{const{useTaskStore:T}=await ge(async()=>{const{useTaskStore:j}=await Promise.resolve().then(()=>jd);return{useTaskStore:j}},void 0,import.meta.url),{useHabitStore:b}=await ge(async()=>{const{useHabitStore:j}=await Promise.resolve().then(()=>Sd);return{useHabitStore:j}},void 0,import.meta.url);v=T.getState(),D=b.getState()}catch(T){return console.warn(" Could not load task/habit stores, using fallback:",T),{success:!1,error:"Store initialization failed"}}const p=((v==null?void 0:v.tasks)||[]).filter(T=>T.goalId===r);s=p.length,o=p.filter(T=>T.status==="completed").length;const x=(D==null?void 0:D.habits)||[],k=(D==null?void 0:D.completions)||[],C=x.filter(T=>T.goalId===r);if(i=C.length,C.length>0){const T=new Date;T.setDate(T.getDate()-7);const b=C.reduce((j,S)=>{const _=k.filter(M=>M.habitId===S.id).filter(M=>new Date(M.date)>=T&&M.completed);return j+_.length/7*100},0);c=Math.round(b/C.length)}}catch(v){console.warn("Could not calculate goal progress:",v)}let l=0;const d=a.progressSettings||{calculationMode:"tasks"},h=((g=a.milestones)==null?void 0:g.filter(v=>v.completed).length)||0,u=((m=a.milestones)==null?void 0:m.length)||0;switch(d.calculationMode){case"tasks":l=s>0?o/s*100:0;break;case"habits":l=i>0?c:0;break;case"milestones":l=u>0?h/u*100:0;break;case"mixed":const v=d.mixedWeights||{tasks:40,habits:40,milestones:20};let D=s>0?o/s*100:0,y=i>0?c:0,p=u>0?h/u*100:0;l=D*(v.tasks/100)+y*(v.habits/100)+p*(v.milestones/100);break;default:l=s>0?o/s*100:0}const f={...a.progress,percentage:Math.min(l,100),tasksCompleted:o,tasksTotal:s,habitsActive:i,habitCompletionRate:c,lastUpdated:new Date().toISOString()};console.log(`Goal Progress Update for "${a.name}":`,{goalId:r,tasksTotal:s,tasksCompleted:o,habitsActive:i,habitCompletionRate:c,percentage:l,updatedProgress:f}),t().updateGoal(r,{progress:f})},linkTaskToGoal:(r,a)=>{const s=t().goals.find(o=>o.id===r);!s||s.linkedTaskIds.includes(a)||(e(o=>({goals:o.goals.map(i=>i.id===r?{...i,linkedTaskIds:[...i.linkedTaskIds,a],updatedAt:new Date().toISOString()}:i)})),t().updateGoalProgress(r))},unlinkTaskFromGoal:(r,a)=>{t().goals.find(o=>o.id===r)&&(e(o=>({goals:o.goals.map(i=>i.id===r?{...i,linkedTaskIds:i.linkedTaskIds.filter(c=>c!==a),updatedAt:new Date().toISOString()}:i)})),t().updateGoalProgress(r))},linkHabitToGoal:(r,a)=>{const s=t().goals.find(o=>o.id===r);!s||s.linkedHabitIds.includes(a)||(e(o=>({goals:o.goals.map(i=>i.id===r?{...i,linkedHabitIds:[...i.linkedHabitIds,a],updatedAt:new Date().toISOString()}:i)})),t().updateGoalProgress(r))},unlinkHabitFromGoal:(r,a)=>{t().goals.find(o=>o.id===r)&&(e(o=>({goals:o.goals.map(i=>i.id===r?{...i,linkedHabitIds:i.linkedHabitIds.filter(c=>c!==a),updatedAt:new Date().toISOString()}:i)})),t().updateGoalProgress(r))},addMilestone:(r,a,s)=>{var i;const o={id:Cd(),description:a,completed:!1,createdAt:new Date().toISOString(),order:((i=t().goals.find(c=>c.id===r))==null?void 0:i.milestones.length)||0,dueDate:s};e(c=>({goals:c.goals.map(l=>l.id===r?{...l,milestones:[...l.milestones,o],updatedAt:new Date().toISOString()}:l)})),s?console.log(" Milestone created with due date, will appear as all-day event card:",o.description):console.log(" Milestone has no due date, will not appear in calendar"),t().updateGoalProgress(r)},updateMilestone:(r,a,s)=>{const o=t().goals.find(c=>c.id===r),i=o==null?void 0:o.milestones.find(c=>c.id===a);e(c=>({goals:c.goals.map(l=>l.id===r?{...l,milestones:l.milestones.map(d=>d.id===a?{...d,...s}:d),updatedAt:new Date().toISOString()}:l)})),s.dueDate&&s.dueDate!==(i==null?void 0:i.dueDate)&&console.log(" Milestone due date updated, will appear as all-day event card on:",s.dueDate),t().updateGoalProgress(r)},deleteMilestone:(r,a)=>{e(s=>({goals:s.goals.map(o=>o.id===r?{...o,milestones:o.milestones.filter(i=>i.id!==a),updatedAt:new Date().toISOString()}:o)})),t().updateGoalProgress(r)},toggleMilestoneCompletion:(r,a)=>{const s=t().goals.find(c=>c.id===r),o=s==null?void 0:s.milestones.find(c=>c.id===a);if(!o)return;const i={completed:!o.completed,completedAt:o.completed?void 0:new Date().toISOString()};t().updateMilestone(r,a,i),!o.completed&&s&&t().triggerMilestoneJournalPrompt(r,a,s,o)},reorderMilestones:(r,a)=>{e(s=>({goals:s.goals.map(o=>o.id===r?{...o,milestones:a.map((i,c)=>{const l=o.milestones.find(d=>d.id===i);return l?{...l,order:c}:null}).filter(Boolean),updatedAt:new Date().toISOString()}:o)}))},updateProgressSettings:(r,a)=>{e(s=>({goals:s.goals.map(o=>o.id===r?{...o,progressSettings:{...o.progressSettings,...a},updatedAt:new Date().toISOString()}:o)})),t().updateGoalProgress(r)},createGoalFromTemplate:async(r,a)=>{try{console.log(` Creating goal from template: ${r}`);const s=await _r.getTemplateById(r);if(!s)return console.error(` Template not found: ${r}`),{success:!1,taskIds:[],habitIds:[],error:`Template with ID '${r}' not found`};console.log(` Found template: ${s.name}`),console.log(` Template has ${s.templateTasks.length} tasks and ${s.templateHabits.length} habits`);const o={name:(a==null?void 0:a.name)||s.name,description:(a==null?void 0:a.description)||s.description,category:s.category,icon:(a==null?void 0:a.icon)||s.icon,color:(a==null?void 0:a.color)||s.color,priority:(a==null?void 0:a.priority)||"medium",targetDate:a==null?void 0:a.targetDate,motivation:(a==null?void 0:a.motivation)||`Based on ${s.name} template`,tags:(a==null?void 0:a.tags)||s.tags,templateId:r},i=t().addGoal(o);console.log(` Created goal with ID: ${i}`);const c=[],l=[];let d,h;try{const{useTaskStore:u}=await ge(async()=>{const{useTaskStore:g}=await Promise.resolve().then(()=>jd);return{useTaskStore:g}},void 0,import.meta.url),{useHabitStore:f}=await ge(async()=>{const{useHabitStore:g}=await Promise.resolve().then(()=>Sd);return{useHabitStore:g}},void 0,import.meta.url);d=u.getState(),h=f.getState()}catch(u){return console.warn(" Could not load stores for template creation:",u),{success:!1,error:"Store import failed during template creation"}}if(s.templateTasks&&s.templateTasks.length>0){console.log(` Creating ${s.templateTasks.length} tasks...`);for(const u of s.templateTasks){const f={name:u.name,description:u.description||"",type:"standard",priority:u.priority,goalId:i,notes:u.details||"",tags:[s.name,...s.tags||[]],subtasks:[],status:"pending",dueDate:u.weekNumber?new Date(Date.now()+u.weekNumber*7*24*60*60*1e3).toISOString().split("T")[0]:void 0};try{const g=d.addTask(f);c.push(g),t().linkTaskToGoal(g,i),console.log(` Created task: ${u.name}`)}catch(g){console.error(` Failed to create task: ${u.name}`,g)}}}if(s.templateHabits&&s.templateHabits.length>0){console.log(` Creating ${s.templateHabits.length} habits...`);for(const u of s.templateHabits){const f={name:u.name,description:u.description||"",icon:u.icon,color:s.color,measurementType:u.measurementType,frequency:u.frequency,selectedDays:u.selectedDays,customFrequency:u.customFrequency,targetAmount:u.targetAmount,targetUnit:u.targetUnit,calendarIntegration:!1,startDate:new Date().toISOString().split("T")[0],goalId:i};try{const g=h.addHabit(f);l.push(g),t().linkHabitToGoal(g,i),console.log(` Created habit: ${u.name}`)}catch(g){console.error(` Failed to create habit: ${u.name}`,g)}}}return t().updateGoalProgress(i),console.log(" Successfully created goal from template!"),console.log(` Summary: 1 goal, ${c.length} tasks, ${l.length} habits`),{success:!0,goalId:i,taskIds:c,habitIds:l}}catch(s){return console.error(" Error creating goal from template:",s),{success:!1,taskIds:[],habitIds:[],error:s instanceof Error?s.message:"Unknown error occurred"}}},getTemplatesByCategory:async r=>{try{return await _r.getTemplatesByCategory(r)}catch(a){return console.error("Error getting templates by category:",a),t().templates.filter(s=>s.category===r)}},getAllTemplates:async()=>{try{return await _r.getTemplates()||[]}catch(r){return console.error("Error getting all templates:",r),t().templates||Dd||[]}},getTemplateById:async r=>{try{return await _r.getTemplateById(r)}catch(a){return console.error("Error getting template by ID:",a),t().templates.find(s=>s.id===r)}},refreshTemplates:async()=>{try{await _r.reloadTemplates(),console.log(" Templates refreshed successfully")}catch(r){console.error(" Error refreshing templates:",r)}},setFilter:r=>{e(a=>({currentFilter:{...a.currentFilter,...r}}))},setViewMode:r=>{e({viewMode:r})},getFilteredGoals:()=>{const{goals:r,currentFilter:a}=t();return r.filter(s=>{if(a.status!=="archived"&&s.isArchived||a.category!=="all"&&s.category!==a.category)return!1;if(a.status!=="all")switch(a.status){case"active":return!s.isCompleted&&!s.isArchived;case"completed":return s.isCompleted&&!s.isArchived;case"archived":return s.isArchived;case"overdue":return!s.isCompleted&&!s.isArchived&&s.targetDate&&new Date(s.targetDate)<new Date;default:return!s.isArchived}return!(a.priority!=="all"&&s.priority!==a.priority)})},getActiveGoals:()=>{const{goals:r}=t();return r.filter(a=>!a.isArchived)},getArchivedGoals:()=>{const{goals:r}=t();return r.filter(a=>a.isArchived)},openModal:()=>{e(r=>({modalState:{...r.modalState,isOpen:!0,currentStep:0,formData:{}}}))},closeModal:()=>{e(()=>({modalState:{...Ho}}))},setModalStep:r=>{e(a=>({modalState:{...a.modalState,currentStep:r}}))},updateModalFormData:r=>{e(a=>({modalState:{...a.modalState,formData:{...a.modalState.formData,...r}}}))},selectGoal:r=>{e({selectedGoal:r})},clearSelection:()=>{e({selectedGoal:void 0})},getGoalStats:()=>{const r=t().goals,a=r.filter(l=>!l.isCompleted&&!l.isArchived),s=r.filter(l=>l.isCompleted),o=r.reduce((l,d)=>l+d.progress.percentage,0),i=r.length>0?o/r.length:0,c=r.reduce((l,d)=>(l[d.category]||(l[d.category]={count:0,averageProgress:0,completionRate:0}),l[d.category].count++,l[d.category].averageProgress+=d.progress.percentage,l),{});return Object.keys(c).forEach(l=>{const d=c[l];d.averageProgress=d.averageProgress/d.count,d.completionRate=r.filter(h=>h.category===l&&h.isCompleted).length/d.count*100}),{totalGoals:r.length,activeGoals:a.length,completedGoals:s.length,averageProgress:i,totalTasksLinked:r.reduce((l,d)=>l+d.linkedTaskIds.length,0),totalHabitsLinked:r.reduce((l,d)=>l+d.linkedHabitIds.length,0),overallCompletionRate:r.length>0?s.length/r.length*100:0,categoryBreakdown:c,currentActiveStreak:0,longestActiveStreak:0,goalsCompletedThisMonth:s.filter(l=>l.completedAt&&new Date(l.completedAt).getMonth()===new Date().getMonth()).length,goalsCompletedThisYear:s.filter(l=>l.completedAt&&new Date(l.completedAt).getFullYear()===new Date().getFullYear()).length}},getGoalDetailData:r=>{const a=t().goals.find(s=>s.id===r);if(a)return{goal:a,linkedTasks:[],linkedHabits:[],linkedJournalEntries:[],progressHistory:[],milestones:[]}},getGoalProgress:r=>{const a=t().goals.find(s=>s.id===r);return a==null?void 0:a.progress},getCompletedGoals:()=>t().goals.filter(r=>r.isCompleted),getOverdueGoals:()=>{const r=new Date;return t().goals.filter(a=>!a.isCompleted&&a.targetDate&&new Date(a.targetDate)<r)},getGoalsByCategory:r=>t().goals.filter(a=>a.category===r),recalculateAllGoalProgress:async()=>{const r=t().goals;for(const a of r)await t().updateGoalProgress(a.id)},triggerMilestoneJournalPrompt:async(r,a,s,o)=>{try{const{useJournalStore:i}=await ge(async()=>{const{useJournalStore:u}=await Promise.resolve().then(()=>Of);return{useJournalStore:u}},void 0,import.meta.url),c=i.getState(),l=new Date().toISOString().split("T")[0],d=` Milestone Achievement!

I just completed the milestone "${o.description}" for my goal "${s.name}".

What I learned from this milestone:

How this brings me closer to my goal:

Next steps:

`,h=c.getEntry(l);if(h){const u=`${h.content}

${d}`;c.updateEntry(l,{content:u})}else c.addEntry({date:l,content:d,mood:"positive",tags:[`goal:${s.name}`,"milestone","achievement"]});console.log(` Journal entry created for milestone completion: ${o.description}`)}catch(i){console.error(" Error creating milestone journal entry:",i)}}}),{name:"goal-store",partialize:e=>({goals:e.goals,currentFilter:e.currentFilter,viewMode:e.viewMode}),onRehydrateStorage:()=>e=>{e!=null&&e.goals&&(e.goals=e.goals.map(t=>({...t,milestones:t.milestones||[],progressSettings:t.progressSettings||{calculationMode:"tasks",timeframe:"30days"}})),console.log(" Migrated",e.goals.length,"goals to include milestone support"))}})),Qe=Object.freeze(Object.defineProperty({__proto__:null,useGoalStore:De},Symbol.toStringTag,{value:"Module"})),Gf=e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Uf=()=>{const e=new Date().getHours();return e<12?"Good morning!":e<17?"Good afternoon!":"Good evening!"},qf=()=>new Date().toISOString().split("T")[0],Wf=e=>{const t=e instanceof Date?e:new Date(e),r=new Date,a=new Date(r.setDate(r.getDate()-r.getDay())),s=new Date(a);return s.setDate(a.getDate()+6),t>=a&&t<=s},Vf=e=>{const t=e instanceof Date?e:new Date(e),r=new Date;return t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear()},Hi=nr(()=>({getDashboardStats:()=>{const e=Oe.getState(),t=He.getState(),r=Cr.getState(),a=De.getState(),s=qf(),o=e.tasks.filter(p=>p.dueDate?(p.dueDate instanceof Date?p.dueDate.toISOString().split("T")[0]:String(p.dueDate).split("T")[0])===s:p.type==="standard"),i=o.filter(p=>p.status==="completed"),c=o.length>0?i.length/o.length*100:0,l=t.habits.filter(p=>{var x;if(p.frequency==="daily")return!0;if(p.frequency==="weekly"){const k=new Date().getDay(),C=["sun","mon","tue","wed","thu","fri","sat"];return(x=p.selectedDays)==null?void 0:x.includes(C[k])}return!1}),d=l.filter(p=>{const x=p.completions.find(k=>k.date===s);return x&&x.completed}),h=l.length>0?d.length/l.length*100:0,u=t.habits.reduce((p,x)=>Math.max(p,x.streak||0),0),f=a.goals.filter(p=>!p.isCompleted&&!p.isArchived),g=a.goals.length,m=g>0&&Math.round(f.reduce((p,x)=>p+x.progress.percentage,0)/f.length)||0,v=r.entries.filter(p=>Wf(p.createdAt)).length,D=r.entries.filter(p=>Vf(p.createdAt)).length,y=r.entries.sort((p,x)=>new Date(x.createdAt).getTime()-new Date(p.createdAt).getTime())[0];return{goals:{total:g,averageProgress:m,activeGoals:f.length},tasks:{total:e.tasks.length,completedToday:i.length,remaining:o.length-i.length,completionRate:c},habits:{total:t.habits.length,completedToday:d.length,remaining:l.length-d.length,completionRate:h,bestStreak:u},journal:{totalEntries:r.entries.length,entriesThisWeek:v,entriesThisMonth:D,lastEntryDate:y?(y.createdAt instanceof Date?y.createdAt:new Date(y.createdAt)).toISOString().split("T")[0]:void 0}}},getDashboardCards:e=>{const r=Hi.getState().getDashboardStats();return[{id:"goals",title:"Goals",icon:"",value:r.goals.activeGoals.toString(),subtitle:"active goals",progress:r.goals.averageProgress,progressText:r.goals.averageProgress>0?`${r.goals.averageProgress}% average progress`:"No goals yet",colorClass:"goals-card",onClick:()=>e("goals")},{id:"tasks",title:"Tasks",icon:"",value:`${r.tasks.completedToday}/${r.tasks.completedToday+r.tasks.remaining}`,subtitle:"completed today",progress:r.tasks.completionRate,progressText:r.tasks.remaining>0?`${r.tasks.remaining} tasks remaining`:"All tasks completed!",colorClass:"tasks-card",onClick:()=>e("tasks")},{id:"habits",title:"Habits",icon:"",value:`${r.habits.completedToday}/${r.habits.completedToday+r.habits.remaining}`,subtitle:"completed today",progress:r.habits.completionRate,progressText:r.habits.bestStreak>0?` ${r.habits.bestStreak}-day streak`:"Start your streak!",colorClass:"habits-card",onClick:()=>e("habits")}]},hasAnyData:()=>{const e=Oe.getState(),t=He.getState(),r=Cr.getState(),a=De.getState();return e.tasks.length>0||t.habits.length>0||r.entries.length>0||a.goals.length>0},getGreeting:()=>Uf(),getCurrentDate:()=>Gf(new Date),getUrgentTasks:()=>{const t=Oe.getState().getTasksBySection(),r=new Date,a=new Date(r);return a.setDate(a.getDate()+1),[...t.overdue,...t.today.filter(i=>i.priority==="urgent"),...t.upcoming.filter(i=>i.priority==="urgent"),...t.noDueDate.filter(i=>i.priority==="urgent"),...t.today.filter(i=>i.type==="deadline"&&i.dueDate&&new Date(i.dueDate)<=a&&i.priority!=="urgent"),...t.upcoming.filter(i=>i.type==="deadline"&&i.dueDate&&new Date(i.dueDate)<=a&&i.priority!=="urgent")].filter((i,c,l)=>l.findIndex(d=>d.id===i.id)===c).filter(i=>i.status!=="completed")},getTodayTasks:()=>{const e=Oe.getState(),t=e.getTasksBySection(),r=new Date;r.setHours(0,0,0,0);const a=Hi.getState().getUrgentTasks(),s=new Set(a.map(i=>i.id));let o=t.today.filter(i=>!s.has(i.id));if(o.length<5){const c=e.filterNextOccurrenceOnly(e.tasks).filter(f=>f.status!=="completed"&&!s.has(f.id)),l=c.filter(f=>!f.dueDate),d=c.filter(f=>{if(!f.dueDate)return!1;const g=new Date(f.dueDate);return g.setHours(0,0,0,0),g>r}).sort((f,g)=>new Date(f.dueDate).getTime()-new Date(g.dueDate).getTime());o=[...o,...l,...d].filter((f,g,m)=>m.findIndex(v=>v.id===f.id)===g).slice(0,5)}return o.filter(i=>i.status!=="completed")},getTodayHabits:()=>{const e=He.getState(),t=new Date().getDay(),a=["sun","mon","tue","wed","thu","fri","sat"][t];return e.habits.filter(o=>o.frequency==="daily"?!0:o.frequency==="weekly"&&o.selectedDays?o.selectedDays.includes(a):o.frequency==="custom").map(o=>({habit:o,isCompleted:e.isHabitCompletedToday(o.id)}))},getGroceryTasks:()=>Oe.getState().tasks.filter(t=>t.type==="to-buy"&&t.status!=="completed"&&t.shoppingItems&&t.shoppingItems.length>0&&t.shoppingItems.some(r=>r.name&&r.name.trim()!==""))})),St=[{id:"health",name:"Health & Fitness",icon:"",description:"Physical wellness, exercise, nutrition",color:"#10B981",gradientStart:"#10B981",gradientEnd:"#22C55E",templateCount:8},{id:"career",name:"Career & Business",icon:"",description:"Professional growth, projects, skills",color:"#3B82F6",gradientStart:"#3B82F6",gradientEnd:"#60A5FA",templateCount:12},{id:"learning",name:"Learning & Skills",icon:"",description:"Education, new skills, knowledge",color:"#F59E0B",gradientStart:"#F59E0B",gradientEnd:"#FBBF24",templateCount:10},{id:"personal",name:"Personal Growth",icon:"",description:"Self-improvement, mindfulness, habits",color:"#8B5CF6",gradientStart:"#8B5CF6",gradientEnd:"#A855F7",templateCount:6},{id:"financial",name:"Financial",icon:"",description:"Savings, investments, budgeting",color:"#10B981",gradientStart:"#10B981",gradientEnd:"#059669",templateCount:7},{id:"creative",name:"Creative & Hobbies",icon:"",description:"Art, music, writing, crafts",color:"#EC4899",gradientStart:"#EC4899",gradientEnd:"#F472B6",templateCount:9}],Yf=["","","","","","","","","","","","","","","",""],Za=["#FF7101","#3B82F6","#22C55E","#A855F7","#EC4899","#F59E0B","#EF4444","#14B8A6"];function Qf({linkedTasks:e,linkedHabits:t,onAddTask:r,onAddHabit:a,onEditTask:s,onEditHabit:o,onDeleteTask:i,onDeleteHabit:c}){const[l,d]=N.useState(!1),h=e.length+t.length;return n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{onClick:()=>d(!l),className:`flex items-center justify-between p-4 border-2 rounded-xl cursor-pointer transition-all ${l?"bg-gray-100 dark:bg-gray-800 accent-border-500 rounded-b-none":"bg-gray-50 dark:bg-gray-800/50 border-gray-300 dark:border-gray-700 hover:border-gray-400 dark:hover:border-gray-600"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Tasks & Habits"}),h>0&&n.jsx("span",{className:"accent-bg-500 text-white text-xs px-2 py-1 rounded-full font-semibold",children:h})]}),n.jsx(gn,{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${l?"rotate-180":""}`})]}),l&&n.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 border-2 border-t-0 accent-border-500 rounded-b-xl p-5 animate-slideDown",children:[n.jsxs("div",{className:"flex gap-3 mb-5",children:[n.jsxs("button",{onClick:r,className:"flex-1 flex items-center justify-center gap-2 p-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover-accent-border hover:bg-gray-200 dark:hover:bg-gray-700 transition-all group",children:[n.jsx(Dt,{className:"w-4 h-4 text-gray-400 group-hover:accent-text-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-400 group-hover:accent-text-500",children:"Add Task"})]}),n.jsxs("button",{onClick:a,className:"flex-1 flex items-center justify-center gap-2 p-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover-accent-border hover:bg-gray-200 dark:hover:bg-gray-700 transition-all group",children:[n.jsx(Dt,{className:"w-4 h-4 text-gray-400 group-hover:accent-text-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-400 group-hover:accent-text-500",children:"Add Habit"})]})]}),n.jsx("div",{className:"space-y-3",children:h===0?n.jsxs("div",{className:"text-center py-6 text-gray-400",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("p",{className:"text-sm",children:"No tasks or habits added yet."}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add tasks and habits to help achieve your goal!"})]}):n.jsxs(n.Fragment,{children:[e.map(u=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-200 dark:bg-gray-700/50 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",children:[n.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center text-white flex-shrink-0",style:{background:u.color},children:u.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-gray-900 dark:text-white truncate",children:u.name}),n.jsx("div",{className:"text-xs text-gray-400",children:"Task"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>s(u),className:"w-7 h-7 flex items-center justify-center rounded-md bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:n.jsx(Tn,{className:"w-3 h-3 text-gray-600 dark:text-gray-300"})}),n.jsx("button",{onClick:()=>i(u.id),className:"w-7 h-7 flex items-center justify-center rounded-md bg-red-600/20 hover:bg-red-600/30 transition-colors",children:n.jsx(ft,{className:"w-3 h-3 text-red-400"})})]})]},u.id)),t.map(u=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-700/50 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors",children:[n.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center text-white flex-shrink-0",style:{background:u.color},children:u.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-white truncate",children:u.name}),n.jsx("div",{className:"text-xs text-gray-400",children:"Habit"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>o(u),className:"w-7 h-7 flex items-center justify-center rounded-md bg-gray-600 hover:bg-gray-500 transition-colors",children:n.jsx(Tn,{className:"w-3 h-3 text-gray-300"})}),n.jsx("button",{onClick:()=>c(u.id),className:"w-7 h-7 flex items-center justify-center rounded-md bg-red-600/20 hover:bg-red-600/30 transition-colors",children:n.jsx(ft,{className:"w-3 h-3 text-red-400"})})]})]},u.id))]})})]})]})}function Kf({isOpen:e,onClose:t,onSave:r,editingTask:a,goalColor:s="#FF7101"}){const[o,i]=N.useState("standard"),[c,l]=N.useState({name:"",description:"",type:"standard",priority:"medium"});N.useEffect(()=>{e&&(a?(i(a.type||"standard"),l({name:a.name,description:a.description||"",type:a.type||"standard",priority:a.priority||"medium"})):(i("standard"),l({name:"",description:"",type:"standard",priority:"medium"})))},[e,a,s]);const d=u=>{u.preventDefault(),c.name.trim()&&(r({name:c.name.trim(),description:c.description.trim()||void 0,type:o,priority:c.priority}),t())},h=()=>{i("standard"),l({name:"",description:"",type:"standard",priority:"medium"}),t()};return e?n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a?"Edit Task":"Add Task"}),n.jsx("button",{onClick:h,className:"w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center justify-center transition-colors",children:n.jsx(Bt,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}),n.jsxs("form",{onSubmit:d,className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Task Type"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{id:"standard",label:"Standard",icon:Sr,color:"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/20 dark:border-blue-800 dark:text-blue-300"},{id:"to-buy",label:"To-Buy",icon:Gs,color:"bg-amber-50 border-amber-200 text-amber-700 dark:bg-amber-900/20 dark:border-amber-800 dark:text-amber-300"},{id:"deadline",label:"Deadline",icon:Na,color:"bg-red-50 border-red-200 text-red-700 dark:bg-red-900/20 dark:border-red-800 dark:text-red-300"}].map(u=>{const f=u.icon;return n.jsxs("button",{type:"button",onClick:()=>i(u.id),className:`p-2 rounded-lg border-2 transition-all text-center flex flex-col justify-center items-center ${o===u.id?`${u.color} border-opacity-100`:"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[n.jsx(f,{className:"w-4 h-4 mx-auto mb-1"}),n.jsx("div",{className:"text-xs font-medium",children:u.label})]},u.id)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Task Name *"}),n.jsx("input",{type:"text",value:c.name,onChange:u=>l({...c,name:u.target.value}),placeholder:"What needs to be done?",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors",autoFocus:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{value:c.description,onChange:u=>l({...c,description:u.target.value}),placeholder:"Additional details...",rows:2,spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Priority"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{id:"low",label:"Low",color:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"},{id:"medium",label:"Medium",color:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300"},{id:"high",label:"High",color:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"},{id:"urgent",label:"Urgent",color:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"}].map(u=>n.jsx("button",{type:"button",onClick:()=>l(f=>({...f,priority:u.id})),className:`py-2 px-2 rounded-lg text-xs font-medium transition-all text-center ${c.priority===u.id?`${u.color} ring-2 ring-offset-1 accent-ring-300`:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:u.label},u.id))})]}),n.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700/50 border border-gray-300 dark:border-gray-600 rounded-lg p-3",children:[n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Preview"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"w-8 h-8 rounded-lg bg-gray-200 dark:bg-gray-600 flex items-center justify-center",children:[o==="standard"&&n.jsx(Sr,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"}),o==="to-buy"&&n.jsx(Gs,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"}),o==="deadline"&&n.jsx(Na,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:c.name||"Task name"}),n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[o.charAt(0).toUpperCase()+o.slice(1),"  ",c.priority.charAt(0).toUpperCase()+c.priority.slice(1)," Priority"]})]})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:h,className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg transition-colors",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:!c.name.trim(),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${c.name.trim()?"accent-bg-500 hover-accent-bg-dark text-white":"bg-gray-400 dark:bg-gray-600 text-gray-600 dark:text-gray-400 cursor-not-allowed"}`,children:a?"Update Task":"Add Task"})]})]})]})}):null}const Jf=["#FF7101","#3B82F6","#22C55E","#A855F7","#EF4444","#F59E0B","#6B7280","#10B981"],Xf=["","","","","","","","","","","",""],Td=[{id:"simple",icon:"",name:"Simple",desc:"Yes/No daily"},{id:"count",icon:"",name:"Count",desc:"Track number"},{id:"time",icon:"",name:"Time",desc:"Track duration"},{id:"custom",icon:"",name:"Custom",desc:"Custom units"}],Zf=[{id:"daily",name:"Daily",desc:"Every day"},{id:"weekly",name:"Weekly",desc:"Select days"},{id:"custom",name:"Custom",desc:"X times per period"}],ey=[{id:"mon",label:"M",full:"Monday"},{id:"tue",label:"T",full:"Tuesday"},{id:"wed",label:"W",full:"Wednesday"},{id:"thu",label:"T",full:"Thursday"},{id:"fri",label:"F",full:"Friday"},{id:"sat",label:"S",full:"Saturday"},{id:"sun",label:"S",full:"Sunday"}];function ty({isOpen:e,onClose:t,onSave:r,editingHabit:a,goalColor:s="#FF7101"}){var u,f,g;const[o,i]=N.useState({name:"",description:"",icon:"",color:s,measurementType:"simple",frequency:"daily",selectedDays:[],customFrequency:{times:1,period:"day"},targetAmount:1,targetUnit:"units"});N.useEffect(()=>{e&&i(a?{name:a.name,description:a.description||"",icon:a.icon,color:a.color,measurementType:a.measurementType,frequency:a.frequency,selectedDays:a.selectedDays||[],customFrequency:a.customFrequency||{times:1,period:"day"},targetAmount:a.targetAmount||1,targetUnit:a.targetUnit||"units"}:{name:"",description:"",icon:"",color:s,measurementType:"simple",frequency:"daily",selectedDays:[],customFrequency:{times:1,period:"day"},targetAmount:1,targetUnit:"units"})},[e,a,s]);const c=m=>{m.preventDefault(),o.name.trim()&&(r({name:o.name.trim(),description:o.description.trim()||void 0,icon:o.icon,color:o.color,measurementType:o.measurementType,frequency:o.frequency,selectedDays:o.selectedDays,customFrequency:o.customFrequency,targetAmount:o.targetAmount,targetUnit:o.targetUnit}),t())},l=()=>{i({name:"",description:"",icon:"",color:s,measurementType:"simple",frequency:"daily",selectedDays:[],customFrequency:{times:1,period:"day"},targetAmount:1,targetUnit:"units"}),t()},d=m=>{const v=o.selectedDays||[];if(v.includes(m)){const D=v.filter(y=>y!==m);i({...o,selectedDays:D})}else{const D=[...v,m];i({...o,selectedDays:D})}},h=()=>{switch(o.measurementType){case"count":return"times";case"time":return"minutes";case"custom":return o.targetUnit||"units";default:return""}};return e?n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[n.jsx("h3",{className:"text-xl font-bold text-white",children:a?"Edit Habit":"Add Habit"}),n.jsx("button",{onClick:l,className:"w-8 h-8 rounded-lg bg-gray-700 hover:bg-gray-600 flex items-center justify-center transition-colors",children:n.jsx(Bt,{className:"w-4 h-4 text-gray-300"})})]}),n.jsxs("form",{onSubmit:c,className:"p-6 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Habit Name *"}),n.jsx("input",{type:"text",value:o.name,onChange:m=>i({...o,name:m.target.value}),placeholder:"What habit do you want to build?",className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus-accent-border transition-colors",autoFocus:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Description"}),n.jsx("textarea",{value:o.description,onChange:m=>i({...o,description:m.target.value}),placeholder:"Why is this habit important?",rows:2,className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus-accent-border transition-colors resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Icon"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Xf.map(m=>n.jsx("button",{type:"button",onClick:()=>i({...o,icon:m}),className:`w-10 h-10 rounded-lg flex items-center justify-center text-lg transition-all ${o.icon===m?"accent-bg-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:m},m))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Color"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Jf.map(m=>n.jsx("button",{type:"button",onClick:()=>i({...o,color:m}),className:`w-8 h-8 rounded-lg border-2 transition-all ${o.color===m?"border-white scale-110":"border-transparent hover:scale-105"}`,style:{background:m},children:o.color===m&&n.jsx("span",{className:"text-white text-xs",children:""})},m))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Measurement Type"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:Td.map(m=>n.jsxs("button",{type:"button",onClick:()=>i({...o,measurementType:m.id}),className:`p-2 rounded-lg text-xs transition-all ${o.measurementType===m.id?"accent-bg-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:[n.jsxs("div",{className:"font-medium",children:[m.icon," ",m.name]}),n.jsx("div",{className:"opacity-75",children:m.desc})]},m.id))})]}),o.measurementType!=="simple"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:["Target ",h()]}),n.jsx("input",{type:"number",min:"1",value:o.targetAmount||1,onChange:m=>i({...o,targetAmount:parseInt(m.target.value)||1}),className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus-accent-border transition-colors"}),o.measurementType==="custom"&&n.jsx("input",{type:"text",value:o.targetUnit,onChange:m=>i({...o,targetUnit:m.target.value}),placeholder:"Custom unit (e.g., pages, cups)",className:"w-full p-3 mt-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus-accent-border transition-colors"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Frequency"}),n.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:Zf.map(m=>n.jsxs("button",{type:"button",onClick:()=>i({...o,frequency:m.id}),className:`p-2 rounded-lg text-xs transition-all ${o.frequency===m.id?"accent-bg-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:[n.jsx("div",{className:"font-medium",children:m.name}),n.jsx("div",{className:"opacity-75",children:m.desc})]},m.id))}),o.frequency==="weekly"&&n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Select days:"}),n.jsx("div",{className:"flex gap-1 justify-center",children:ey.map(m=>{var v;return n.jsx("button",{type:"button",onClick:()=>d(m.id),className:`w-8 h-8 rounded-lg text-xs font-medium transition-all ${(v=o.selectedDays)!=null&&v.includes(m.id)?"accent-bg-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:m.label},m.id)})})]}),o.frequency==="custom"&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",min:"1",value:((u=o.customFrequency)==null?void 0:u.times)||1,onChange:m=>i({...o,customFrequency:{...o.customFrequency,times:parseInt(m.target.value)||1}}),className:"w-16 p-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-center focus:outline-none focus-accent-border transition-colors"}),n.jsx("span",{className:"p-2 text-gray-400 text-sm",children:"times per"}),n.jsxs("select",{value:((f=o.customFrequency)==null?void 0:f.period)||"day",onChange:m=>i({...o,customFrequency:{...o.customFrequency,period:m.target.value}}),className:"flex-1 p-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus-accent-border transition-colors",children:[n.jsx("option",{value:"day",children:"Day"}),n.jsx("option",{value:"week",children:"Week"}),n.jsx("option",{value:"month",children:"Month"})]})]})]}),n.jsxs("div",{className:"bg-gray-700/50 border border-gray-600 rounded-lg p-3",children:[n.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Preview"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-white",style:{background:o.color},children:o.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-white",children:o.name||"Habit name"}),n.jsxs("div",{className:"text-xs text-gray-400",children:[(g=Td.find(m=>m.id===o.measurementType))==null?void 0:g.name,"  ",o.frequency.charAt(0).toUpperCase()+o.frequency.slice(1),o.measurementType!=="simple"&&`  ${o.targetAmount} ${h()}`]})]})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:!o.name.trim()||o.frequency==="weekly"&&o.selectedDays.length===0||o.measurementType!=="simple"&&(!o.targetAmount||o.targetAmount<1),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${o.name.trim()?"accent-bg-500 hover-accent-bg-dark text-white":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:a?"Update Habit":"Add Habit"})]})]})]})}):null}const ry=[{id:"low",name:"Low",icon:"",desc:"Nice to have"},{id:"medium",name:"Medium",icon:"",desc:"Important"},{id:"high",name:"High",icon:"",desc:"Very important"},{id:"critical",name:"Critical",icon:"",desc:"Must achieve"}],Ed=()=>Date.now().toString()+Math.random().toString(36).substring(2,9);function ql({isOpen:e,onClose:t,goalToEdit:r}){var A,X,re;const{templates:a,addGoal:s,createGoalFromTemplate:o,getTemplatesByCategory:i,getAllTemplates:c,updateGoal:l,linkTaskToGoal:d,linkHabitToGoal:h}=De(),{addTask:u}=Oe(),{addHabit:f}=He(),[g,m]=N.useState("template"),[v,D]=N.useState("categories"),[y,p]=N.useState(null),[x,k]=N.useState(null),[C,T]=N.useState(!1),[b,j]=N.useState([]),[S,w]=N.useState(!1),[_,M]=N.useState([]),[F,G]=N.useState([]),[L,H]=N.useState(!1),[P,O]=N.useState(!1),[q,U]=N.useState(),[Z,$]=N.useState(),[R,Y]=N.useState({name:"",description:"",category:"health",icon:"",color:Za[0],priority:"medium",tags:[]});N.useEffect(()=>{e&&(r?(m("custom"),D("custom"),p(r.category),k(null),Y({name:r.name||"",description:r.description||"",category:r.category||"health",icon:r.icon||"",color:r.color||Za[0],priority:r.priority||"medium",targetDate:r.targetDate||void 0,motivation:r.motivation||"",tags:r.tags||[]})):(m("template"),D("categories"),p(null),k(null),Y({name:"",description:"",category:"health",icon:"",color:Za[0],priority:"medium",tags:[]})))},[e,r]);const oe=()=>{m("template"),D("categories"),p(null),k(null),M([]),G([]),H(!1),O(!1),U(void 0),$(void 0),t()},ae=z=>{m(z),D(z==="template"?"categories":"custom"),p(null),k(null)},Pe=async z=>{p(z),D("templates"),w(!0);try{const te=await i(z);j(te)}catch(te){console.error("Error loading templates for category:",te),j([])}finally{w(!1)}},$e=z=>{k(z);const te=b.find(K=>K.id===z);te&&Y({...R,name:te.name,description:te.description,category:te.category,icon:te.icon,color:te.color})},Re=async()=>{if(x)try{console.log("Creating goal from template:",x);const z=await o(x,R);z.success?(console.log("Goal created successfully:",z),oe()):console.error("Failed to create goal from template:",z.error)}catch(z){console.error("Error creating goal from template:",z)}},Te=()=>{if(Ee()){if(r)l(r.id,R);else{const z=s(R);_.forEach(te=>{const K={name:te.name,description:te.description||"",type:te.type,priority:te.priority,goalId:z,notes:"",tags:[],subtasks:[],shoppingItems:te.type==="to-buy"?[]:void 0},Fe=u(K);d(Fe,z)}),F.forEach(te=>{const K={name:te.name,description:te.description,icon:te.icon,color:te.color,measurementType:te.measurementType,frequency:te.frequency,selectedDays:te.selectedDays,customFrequency:te.customFrequency,targetAmount:te.targetAmount,targetUnit:te.targetUnit,calendarIntegration:!1,startDate:new Date().toISOString().split("T")[0]},Fe=f(K);h(Fe,z)})}oe()}},Ee=()=>R.name.trim().length>0&&R.description.trim().length>0,nt=()=>{U(void 0),H(!0)},ut=()=>{$(void 0),O(!0)},at=z=>{U(z),H(!0)},ce=z=>{$(z),O(!0)},mt=z=>{M(te=>te.filter(K=>K.id!==z))},st=z=>{G(te=>te.filter(K=>K.id!==z))},B=z=>{if(q)M(te=>te.map(K=>K.id===q.id?{...K,...z}:K));else{const te={id:Ed(),...z};M(K=>[...K,te])}H(!1),U(void 0)},V=z=>{if(Z)G(te=>te.map(K=>K.id===Z.id?{...K,...z}:K));else{const te={id:Ed(),...z};G(K=>[...K,te])}O(!1),$(void 0)};if(!e)return null;const Q=b;return n.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-3 sm:p-4 md:p-5",children:[n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl max-h-[90vh] overflow-hidden text-gray-900 dark:text-white flex flex-col shadow-2xl",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[v==="templates"&&n.jsx("button",{onClick:()=>D("categories"),className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center transition-colors",children:n.jsx(Jm,{className:"w-4 h-4"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r?"Edit Goal":"New Goal"})]}),n.jsx("button",{onClick:oe,className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white transition-colors",children:n.jsx(Bt,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-2xl p-1.5 flex",children:[n.jsx("button",{onClick:()=>ae("template"),className:`flex-1 py-3 px-4 rounded-xl font-semibold transition-all duration-300 ${g==="template"?"accent-gradient text-white shadow-lg shadow-accent":"text-gray-400 hover:text-white"}`,children:"Templates"}),n.jsx("button",{onClick:()=>ae("custom"),className:`flex-1 py-3 px-4 rounded-xl font-semibold transition-all duration-300 ${g==="custom"?"accent-gradient text-white shadow-lg shadow-accent":"text-gray-400 hover:text-white"}`,children:"Custom"})]})]}),n.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[g==="template"&&n.jsxs(n.Fragment,{children:[v==="categories"&&n.jsx("div",{className:"space-y-3",children:St.map(z=>n.jsxs("button",{onClick:()=>Pe(z.id),className:"w-full bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-2xl p-4 transition-all duration-300 hover:scale-105 border-2 border-transparent hover:border-gray-300 flex items-center gap-4 text-left",children:[n.jsx("div",{className:"text-2xl flex-shrink-0",children:z.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-bold text-base mb-1",children:z.name}),n.jsx("p",{className:"text-gray-400 text-sm",children:z.description})]})]},z.id))}),v==="templates"&&y&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("div",{className:"text-4xl mb-2",children:(A=St.find(z=>z.id===y))==null?void 0:A.icon}),n.jsx("h3",{className:"text-xl font-bold",children:(X=St.find(z=>z.id===y))==null?void 0:X.name})]}),S&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"}),n.jsx("p",{className:"mt-2 text-gray-400",children:"Loading templates..."})]}),!S&&Q.length===0&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("p",{className:"text-gray-400",children:"No templates available for this category yet."}),n.jsx("button",{onClick:()=>D("custom"),className:"mt-4 text-orange-500 hover:text-orange-400 underline",children:"Create Custom Goal Instead"})]}),!S&&Q.map(z=>n.jsxs("div",{className:`bg-gray-50 dark:bg-gray-800 rounded-2xl p-5 cursor-pointer transition-all border-2 ${x===z.id?"accent-border-500 bg-gray-100 dark:bg-gray-700":"border-transparent hover:border-gray-600"}`,onClick:()=>$e(z.id),children:[n.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl text-white",style:{background:z.color},children:z.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-bold text-lg mb-1",children:z.name}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:z.description})]}),n.jsx("div",{className:"text-xs text-gray-400",children:z.estimatedDuration})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-base",children:""}),z.templateTasks.length," tasks"]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-base",children:""}),z.templateHabits.length," habits"]}),n.jsx("span",{className:`px-2 py-1 rounded-lg text-xs ${z.popularity==="high"?"bg-green-500/20 text-green-400":z.popularity==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:z.popularity==="high"?" Popular":z.popularity==="medium"?" Good":" Beginner"})]}),x===z.id&&n.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:n.jsx("button",{onClick:Re,className:"w-full py-3 accent-bg-500 hover-accent-bg-dark rounded-xl font-semibold transition-colors",children:"Create Goal from Template"})})]},z.id)),n.jsx("button",{onClick:()=>D("custom"),className:"w-full py-4 border-2 border-dashed border-gray-600 hover-accent-border rounded-2xl text-gray-400 hover-accent-text transition-colors",children:"+ Create Custom Goal Instead"})]})]}),g==="custom"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Goal Name *"}),n.jsx("input",{type:"text",value:R.name,onChange:z=>Y({...R,name:z.target.value}),placeholder:"What do you want to achieve?",maxLength:100,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),n.jsx("textarea",{value:R.description,onChange:z=>Y({...R,description:z.target.value}),placeholder:"Describe your goal and why it matters to you...",maxLength:500,rows:3,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:St.map(z=>n.jsxs("button",{onClick:()=>Y({...R,category:z.id}),className:`p-3 border-2 rounded-xl text-center transition-all ${R.category===z.id?"accent-border-500 bg-gray-100 dark:bg-gray-700 accent-text-500":"border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 hover:border-gray-400 dark:hover:border-gray-600"}`,children:[n.jsx("div",{className:"text-xl mb-1",children:z.icon}),n.jsx("div",{className:"text-xs font-semibold",children:z.name.split(" ")[0]})]},z.id))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Icon"}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{onClick:()=>T(!C),className:"w-16 h-16 mx-auto mb-3 rounded-xl flex items-center justify-center text-2xl cursor-pointer hover:opacity-80 transition-all shadow-sm",style:{background:R.color,color:"white"},children:R.icon}),C&&n.jsx("div",{className:"grid grid-cols-4 gap-2 p-3 bg-gray-100 dark:bg-gray-800 rounded-xl",children:Yf.map(z=>n.jsx("button",{onClick:()=>{Y({...R,icon:z}),T(!1)},className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center text-lg transition-colors",children:z},z))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:Za.map(z=>n.jsx("button",{onClick:()=>Y({...R,color:z}),className:`w-10 h-10 rounded-lg border-3 transition-all hover:scale-110 ${R.color===z?"accent-border-500 border-3":"border-transparent"}`,style:{background:z},children:R.color===z&&n.jsx("span",{className:"text-white font-bold",children:""})},z))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Priority"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:ry.map(z=>n.jsxs("button",{onClick:()=>Y({...R,priority:z.id}),className:`p-3 border-2 rounded-xl text-left transition-all ${R.priority===z.id?"accent-border-500 bg-gray-100 dark:bg-gray-700 accent-text-500":"border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 hover:border-gray-400 dark:hover:border-gray-600"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"text-lg",children:z.icon}),n.jsx("span",{className:"font-semibold",children:z.name})]}),n.jsx("div",{className:"text-xs text-gray-400",children:z.desc})]},z.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Target Date (Optional)"}),n.jsx("input",{type:"date",value:R.targetDate||"",onChange:z=>Y({...R,targetDate:z.target.value||void 0}),className:"w-full p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus-accent-border transition-colors"})]}),n.jsx(Qf,{linkedTasks:_,linkedHabits:F,onAddTask:nt,onAddHabit:ut,onEditTask:at,onEditHabit:ce,onDeleteTask:mt,onDeleteHabit:st}),n.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-2xl p-5 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Why This Matters"})]}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4 leading-relaxed",children:'Understanding your "why" is crucial for long-term success. What will achieving this goal mean to you?'}),n.jsx("textarea",{value:R.motivation||"",onChange:z=>Y({...R,motivation:z.target.value}),placeholder:"How will achieving this goal change your life? What impact will it have on you and others?",maxLength:300,rows:3,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors resize-none"})]}),n.jsxs("div",{className:"bg-gray-100/50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-700 rounded-2xl p-5 mb-6",children:[n.jsx("div",{className:"text-sm font-semibold text-gray-400 mb-4 uppercase tracking-wide",children:"Goal Preview"}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-2xl p-4 border border-gray-300 dark:border-gray-700",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl text-white",style:{background:R.color},children:R.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-semibold text-white mb-1",children:R.name||(r?"Edit Goal":"Your New Goal")}),n.jsxs("div",{className:"text-sm text-gray-400",children:[" ",(re=St.find(z=>z.id===R.category))==null?void 0:re.name,"  ",R.targetDate?new Date(R.targetDate).toLocaleDateString():"Not set"]})]})]})})]})]})]}),g==="custom"&&n.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0",children:[n.jsx("button",{onClick:oe,className:"flex-1 py-4 px-6 bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:bg-gray-100 dark:hover:bg-gray-800 hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:"Cancel"}),n.jsx("button",{onClick:Te,disabled:!Ee(),className:`flex-1 py-4 px-6 rounded-xl font-semibold transition-all ${Ee()?"accent-bg-500 hover-accent-bg-dark text-white hover:-translate-y-0.5 shadow-lg shadow-accent":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:Ee()?r?"Update Goal":"Create Goal":"Enter goal name"})]})]}),n.jsx(Kf,{isOpen:L,onClose:()=>H(!1),onSave:B,editingTask:q,goalColor:R.color}),n.jsx(ty,{isOpen:P,onClose:()=>O(!1),onSave:V,editingHabit:Z,goalColor:R.color})]})}function ny({onNavigate:e}){const[t,r]=N.useState(!1),a=()=>{r(!0)},s=()=>{e("goals"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("openGoalModal"))},100)};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-3xl border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute top-2 right-8 text-2xl opacity-60 animate-pulse",children:""}),n.jsx("div",{className:"text-8xl mb-4 animate-bounce opacity-80",children:""})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"Welcome to Kage!"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-8 max-w-md mx-auto",children:"Your productivity journey starts here. Set meaningful goals, build lasting habits, and track your progress all in one place."}),n.jsx("div",{className:"flex flex-col items-center gap-3 mb-6",children:n.jsx("button",{onClick:a,className:"flex items-center gap-2 px-8 py-4 accent-gradient text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:" Create Your First Goal"})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[n.jsxs("div",{onClick:s,className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:accent-bg-50 dark:hover:accent-bg-900 hover-accent-border hover:border-solid transition-all",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Set a Goal"})]}),n.jsxs("div",{onClick:()=>e("habits"),className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:accent-bg-50 dark:hover:accent-bg-900 hover-accent-border hover:border-solid transition-all",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Add Habits"})]}),n.jsxs("div",{onClick:()=>e("tasks"),className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:accent-bg-50 dark:hover:accent-bg-900 hover-accent-border hover:border-solid transition-all",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Create Tasks"})]}),n.jsxs("div",{onClick:()=>e("journal"),className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 cursor-pointer hover:accent-bg-50 dark:hover:accent-bg-900 hover-accent-border hover:border-solid transition-all",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Start Journaling"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Connect goals, habits & tasks"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Track your progress visually"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Beautiful, motivating interface"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"AI insights (premium)"})]})]})]}),n.jsx(ql,{isOpen:t,onClose:()=>r(!1)})]})}function mg(){const e=window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches||window.navigator.standalone===!0,t=window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":"browser";return{isPWA:e,isStandalone:window.matchMedia("(display-mode: standalone)").matches,isFullscreen:window.matchMedia("(display-mode: fullscreen)").matches,isMinimalUI:window.matchMedia("(display-mode: minimal-ui)").matches,displayMode:t,platform:navigator.platform,userAgent:navigator.userAgent}}function ay(){var t;const e=mg();console.group(" PWA Environment Detection"),console.log("Is PWA:",e.isPWA),console.log("Display Mode:",e.displayMode),console.log("Platform:",e.platform),console.log("User Agent:",e.userAgent),console.log("Location:",window.location.href),console.log("Base URL:",((t=document.querySelector("base"))==null?void 0:t.href)||"No base tag"),console.groupEnd()}function Us(e,t){const r=mg();console.group(" Error in PWA Context"),console.error("Error:",e),t&&console.log("Context:",t),console.log("PWA Info:",r),console.log("Timestamp:",new Date().toISOString()),console.groupEnd()}function es(e,t){try{const r=new CustomEvent(e,{detail:t});return window.dispatchEvent(r),!0}catch(r){return Us(r,`Dispatching event: ${e}`),!1}}function sy(e,t,r){try{return window.addEventListener(e,t,r),()=>{try{window.removeEventListener(e,t,r)}catch(a){Us(a,`Removing event listener: ${e}`)}}}catch(a){return Us(a,`Adding event listener: ${e}`),()=>{}}}function oy({onNavigate:e}){const t=[{id:"goal",icon:"",label:"New Goal",tab:"goals"},{id:"task",icon:"",label:"Add Task",tab:"tasks"},{id:"habit",icon:"",label:"Add Habit",tab:"habits"},{id:"journal",icon:"",label:"Journal",tab:"journal"}],r=a=>{e(a),a==="goals"?setTimeout(()=>{es("openGoalModal")},300):a==="tasks"?setTimeout(()=>{es("openTaskModal")},300):a==="habits"?setTimeout(()=>{es("openHabitModal")},300):a==="journal"&&setTimeout(()=>{es("openJournalModal")},300)};return n.jsxs("div",{className:"space-y-3",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Quick Actions"}),n.jsx("div",{className:"accent-gradient rounded-2xl p-5 text-white",children:n.jsx("div",{className:"grid grid-cols-4 gap-3",children:t.map(a=>n.jsxs("button",{onClick:()=>r(a.tab),className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center transition-all duration-200 hover:bg-white/30 hover:scale-105",children:[n.jsx("div",{className:"text-2xl mb-2",children:a.icon}),n.jsx("div",{className:"text-xs font-medium",children:a.label})]},a.id))})})]})}function iy({urgentTasks:e,onTaskToggle:t}){const{goals:r}=De();if(e.length===0)return null;const a=o=>{if(o.goalId){const i=r.find(c=>c.id===o.goalId);if(i){const c=St.find(l=>l.id===i.category);return(c==null?void 0:c.name)||"General"}}switch(o.type){case"standard":return"General";case"to-buy":return"Grocery";case"deadline":return"Deadline";default:return"General"}},s=o=>{if(o.type==="deadline"&&o.dueDate){const h=new Date(o.dueDate),u=h.getDate().toString().padStart(2,"0"),f=(h.getMonth()+1).toString().padStart(2,"0"),g=h.getFullYear().toString().slice(-2),m=h.getHours().toString().padStart(2,"0"),v=h.getMinutes().toString().padStart(2,"0");return`${u}/${f}/${g} ${m}:${v}`}if(!o.dueDate)return"No due date";const i=new Date,c=new Date(o.dueDate),l=c.toDateString()===i.toDateString();return c<i&&!l?"Overdue":l?"Due today":"Due soon"};return n.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-2xl p-5 dark:bg-gray-800 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Urgent"})]}),n.jsxs("span",{className:"text-sm font-medium text-orange-600 dark:text-orange-400",children:[e.length," item",e.length!==1?"s":""]})]}),n.jsx("div",{className:"space-y-3",children:e.map(o=>n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-xl border border-orange-100 dark:bg-gray-700 dark:border-gray-600",children:[n.jsx("button",{onClick:()=>t(o.id),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors mt-0.5 ${o.status==="completed"?"bg-orange-500 border-orange-500 text-white":"border-orange-300 hover:border-orange-500"}`,children:o.status==="completed"&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("h4",{className:`font-medium text-gray-900 dark:text-white ${o.status==="completed"?"line-through opacity-60":""}`,children:o.name}),n.jsx("span",{className:"text-xs text-orange-600 dark:text-orange-400 whitespace-nowrap",children:s(o)})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-md dark:bg-orange-900/30 dark:text-orange-300",children:a(o)}),o.priority==="urgent"&&n.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-md dark:bg-red-900/30 dark:text-red-300",children:"Urgent"}),o.priority==="high"&&n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-md dark:bg-yellow-900/30 dark:text-yellow-300",children:"High"})]})]})]},o.id))})]})}function ly({todayTasks:e,onTaskToggle:t}){const{goals:r}=De();if(e.length===0)return n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-5 dark:bg-gray-800 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Today's Tasks"}),n.jsx("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:"0 of 0"})]}),n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("p",{children:"No tasks scheduled for today!"}),n.jsx("p",{className:"text-sm mt-1",children:"Enjoy your free time or add some tasks to stay productive."})]})]});const a=e.filter(i=>i.status==="completed"),s=i=>{if(i.goalId){const c=r.find(l=>l.id===i.goalId);if(c){const l=St.find(d=>d.id===c.category);return(l==null?void 0:l.name)||"General"}}switch(i.type){case"standard":return"General";case"to-buy":return"Grocery";case"deadline":return"Deadline";default:return"General"}},o=i=>{if(i.type==="deadline"&&i.dueDate){const c=new Date(i.dueDate),l=c.getDate().toString().padStart(2,"0"),d=(c.getMonth()+1).toString().padStart(2,"0"),h=c.getFullYear().toString().slice(-2),u=c.getHours().toString().padStart(2,"0"),f=c.getMinutes().toString().padStart(2,"0");return`${l}/${d}/${h} ${u}:${f}`}if(i.reminderTime){const c=new Date(i.reminderTime).getHours();return c<12?"Morning":c<17?"Afternoon":"Evening"}return"Anytime"};return n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-5 dark:bg-gray-800 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Today's Tasks"})]}),n.jsxs("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:[a.length," of ",e.length]})]}),n.jsx("div",{className:"space-y-3",children:e.map(i=>n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-xl border border-blue-100 dark:bg-gray-700 dark:border-gray-600",children:[n.jsx("button",{onClick:()=>t(i.id),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors mt-0.5 ${i.status==="completed"?"bg-blue-500 border-blue-500 text-white":"border-blue-300 hover:border-blue-500"}`,children:i.status==="completed"&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"flex items-start justify-between gap-2",children:n.jsx("h4",{className:`font-medium text-gray-900 dark:text-white ${i.status==="completed"?"line-through opacity-60":""}`,children:i.name})}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-md dark:bg-blue-900/30 dark:text-blue-300",children:s(i)}),i.priority==="urgent"&&n.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-md dark:bg-red-900/30 dark:text-red-300",children:"Urgent"}),i.priority==="high"&&n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-md dark:bg-yellow-900/30 dark:text-yellow-300",children:"High"}),i.estimatedTime&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-md dark:bg-gray-700 dark:text-gray-300",children:[i.estimatedTime,"min"]}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-md dark:bg-blue-900/30 dark:text-blue-300",children:o(i)})]})]})]},i.id))})]})}function cy({todayHabits:e,onHabitToggle:t}){const{goals:r}=De(),a=Ye(new Date);if(e.length===0)return n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-5 dark:bg-gray-800 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Today's Habits"}),n.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"0 of 0"})]}),n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("p",{children:"No habits scheduled for today!"}),n.jsx("p",{className:"text-sm mt-1",children:"Create some healthy habits to build a better routine."})]})]});const s=e.filter(({isCompleted:l})=>l),o=l=>{if(l.goalId){const d=r.find(h=>h.id===l.goalId);if(d){const h=St.find(u=>u.id===d.category);return(h==null?void 0:h.name)||"Personal"}}if(l.category){const d=St.find(h=>h.id===l.category);return(d==null?void 0:d.name)||"Personal"}return"Personal"},i=l=>{if(l.scheduledTime){const[d,h]=l.scheduledTime.split(":"),u=parseInt(d),f=u>=12?"PM":"AM";return`${u===0?12:u>12?u-12:u}:${h} ${f}`}return l.name.toLowerCase().includes("morning")||l.name.toLowerCase().includes("meditat")?"7:00 AM":l.name.toLowerCase().includes("evening")||l.name.toLowerCase().includes("journal")?"8:00 PM":"Anytime"},c=l=>l.frequency==="daily"?"Daily":l.frequency==="weekly"?"Weekly":l.frequency==="custom"&&l.customFrequency?`${l.customFrequency.times}x per ${l.customFrequency.period}`:"Custom";return n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-5 dark:bg-gray-800 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Today's Habits"})]}),n.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[s.length," of ",e.length]})]}),n.jsx("div",{className:"space-y-3",children:e.map(({habit:l,isCompleted:d})=>n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-xl border border-green-100 dark:bg-gray-700 dark:border-gray-600",children:[n.jsx("button",{onClick:()=>t(l.id,a),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors mt-0.5 ${d?"bg-green-500 border-green-500 text-white":"border-green-300 hover:border-green-500"}`,children:d&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("h4",{className:`font-medium text-gray-900 dark:text-white ${d?"line-through opacity-60":""}`,children:l.name}),n.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 whitespace-nowrap",children:i(l)})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-md dark:bg-green-900/30 dark:text-green-300",children:o(l)}),n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-md dark:bg-gray-700 dark:text-gray-300",children:c(l)})]})]})]},l.id))})]})}function dy({urgentTasks:e,todayTasks:t,todayHabits:r,onTaskToggle:a,onHabitToggle:s}){return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Today's Focus"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(iy,{urgentTasks:e,onTaskToggle:a}),n.jsx(ly,{todayTasks:t,onTaskToggle:a}),n.jsx(cy,{todayHabits:r,onHabitToggle:s})]})]})}function uy({groceryTasks:e,onTaskClick:t,onItemToggle:r}){return e.length===0?null:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Gs,{className:"w-5 h-5 accent-text-600"}),n.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Shopping Lists"}),n.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",e.length," list",e.length>1?"s":"",")"]})]}),n.jsx("div",{className:"space-y-3",children:e.map(a=>{var s;return n.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:()=>t(a.id),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:a.name}),n.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((s=a.shoppingItems)==null?void 0:s.filter(o=>o.name).length)||0," items"]})]}),a.shoppingItems&&a.shoppingItems.length>0&&n.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.shoppingItems.filter(o=>o.name&&o.name.trim()!=="").slice(0,4).map((o,i)=>n.jsxs("div",{className:"flex items-center gap-2 text-sm",onClick:c=>{c.stopPropagation(),r(a.id,i)},children:[n.jsx("div",{className:"w-4 h-4 border border-gray-300 dark:border-gray-600 rounded flex items-center justify-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:o.completed&&n.jsx(zl,{className:"w-3 h-3 accent-text-600"})}),n.jsxs("span",{className:`flex-1 ${o.completed?"line-through text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"}`,children:[o.quantity&&o.quantity!=="1"?`${o.quantity} `:"",o.name]})]},i)),a.shoppingItems.filter(o=>o.name).length>4&&n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["+",a.shoppingItems.filter(o=>o.name).length-4," more items..."]})]})]},a.id)})})]})}function Id({onNavigate:e}){const{hasAnyData:t,getGreeting:r,getCurrentDate:a,getUrgentTasks:s,getTodayTasks:o,getTodayHabits:i,getGroceryTasks:c}=Hi(),{toggleTask:l}=Oe(),{toggleDayCompletion:d}=He();if(!t())return n.jsx(ny,{onNavigate:e});const h=r(),u=a(),f=s(),g=o(),m=i(),v=c(),D=k=>{l(k)},y=(k,C)=>{d(k,C)},p=k=>{e("tasks")},x=(k,C)=>{const{updateTask:T,tasks:b}=Oe.getState(),j=b.find(S=>S.id===k);if(j&&j.shoppingItems&&j.shoppingItems[C]){const S=[...j.shoppingItems];S[C]={...S[C],completed:!S[C].completed},T(k,{shoppingItems:S})}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:u})]}),n.jsx(oy,{onNavigate:e}),n.jsx(uy,{groceryTasks:v,onTaskClick:p,onItemToggle:x}),n.jsx(dy,{urgentTasks:f,todayTasks:g,todayHabits:m,onTaskToggle:D,onHabitToggle:y})]})}function my(){const{openModal:e,modalState:t,closeModal:r}=De();return n.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-3xl border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute top-2 right-8 text-2xl opacity-60 animate-pulse",children:""}),n.jsx("div",{className:"text-8xl mb-4 animate-bounce opacity-80",children:""})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"No Goals Yet"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-8 max-w-md mx-auto",children:"Goals give direction to your daily actions. Start by setting a meaningful goal that excites you and breaks it down into manageable tasks and habits."}),n.jsx("div",{className:"flex flex-col items-center gap-3 mb-6",children:n.jsx("button",{onClick:()=>e(),className:"flex items-center gap-2 px-8 py-4 accent-gradient text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:" Create Your First Goal"})}),n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 mb-8",children:[n.jsx("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3 text-center",children:" Popular Goal Ideas"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Get fit and healthy"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Learn a new language"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Launch a side project"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Develop mindfulness practice"]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 rounded-2xl p-5 text-white text-center",children:[n.jsx("div",{className:"text-base italic mb-2 opacity-90",children:'"A goal is a dream with a deadline."'}),n.jsx("div",{className:"text-xs opacity-70",children:" Napoleon Hill"})]}),n.jsx(ql,{isOpen:t.isOpen,onClose:r})]})}function gy({goal:e,viewMode:t,onClick:r}){const{selectGoal:a}=De(),{habits:s,isHabitCompletedToday:o}=He(),i=e.targetDate&&new Date(e.targetDate)<new Date&&!e.isCompleted,c=()=>{a(e),r&&r()},l=f=>{if(!f)return"No deadline";const g=new Date(f),m=new Date,v=g.getTime()-m.getTime(),D=Math.ceil(v/(1e3*60*60*24));return D<0?`${Math.abs(D)} days overdue`:D===0?"Due today":D===1?"Due tomorrow":D<=7?`${D} days left`:g.toLocaleDateString("en-US",{month:"short",day:"numeric",year:g.getFullYear()!==m.getFullYear()?"numeric":void 0})},d=()=>e.isCompleted?"from-green-500 to-green-600":i?"from-red-500 to-red-600":e.color,u=(()=>{const f=s.filter(v=>v.goalId===e.id),g=f.length;if(g>0&&console.log(` Goal "${e.name}" has ${g} linked habits:`,f.map(v=>v.name)),g===0)return{completed:0,total:0};const m=f.filter(v=>{const D=o(v.id);return D&&console.log(` Habit "${v.name}" completed today`),D}).length;return console.log(` Goal "${e.name}" habit progress: ${m}/${g}`),{completed:m,total:g}})();return n.jsxs("div",{onClick:c,className:`bg-white dark:bg-gray-800 rounded-2xl p-5 border border-gray-200 dark:border-gray-700 shadow-sm cursor-pointer transition-all duration-300 hover:shadow-lg hover:-translate-y-1 relative border-l-4 ${e.isCompleted?"opacity-75":""} ${i?"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":""}`,style:{borderLeftColor:e.isCompleted?"#22c55e":i?"#ef4444":e.color.includes("linear-gradient")?e.color.replace("linear-gradient(135deg, ","").replace(")","").split(", ")[0]:e.color},children:[n.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl text-white flex-shrink-0",style:{background:e.color},children:e.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("h3",{className:`font-bold text-gray-900 dark:text-white mb-1 line-clamp-2 ${t==="grid"?"text-lg":"text-xl"}`,children:[e.name,e.isCompleted&&n.jsx("span",{className:"ml-2 text-green-500",children:""})]}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm line-clamp-2 leading-relaxed",children:e.description})]}),n.jsx("div",{className:`text-xs px-2 py-1 rounded-lg whitespace-nowrap ${i?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":e.isCompleted?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"}`,children:l(e.targetDate)})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Progress"}),n.jsxs("span",{className:"text-sm font-bold",style:{color:e.isCompleted?"#22c55e":e.color},children:[Math.round(e.progress.percentage),"%"]})]}),n.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${e.isCompleted||i?`bg-gradient-to-r ${d()}`:""}`,style:{width:`${Math.min(e.progress.percentage,100)}%`,backgroundColor:e.isCompleted||i?void 0:e.color}})})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600 dark:text-gray-400",children:[n.jsx("span",{className:"text-base",children:""}),n.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[e.progress.tasksCompleted,"/",e.progress.tasksTotal]}),n.jsx("span",{children:"tasks"})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600 dark:text-gray-400",children:[n.jsx("span",{className:"text-base",children:""}),n.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[u.completed,"/",u.total]}),n.jsx("span",{children:"habits"})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600 dark:text-gray-400",children:[n.jsx("span",{className:"text-base",children:""}),n.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[(e.milestones||[]).filter(f=>f.completed).length,"/",(e.milestones||[]).length]}),n.jsx("span",{children:"milestones"})]}),e.progress.currentStreak>0&&n.jsxs("div",{className:"flex items-center gap-1 text-gray-600 dark:text-gray-400",children:[n.jsx("span",{className:"text-base",children:""}),n.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:e.progress.currentStreak}),n.jsx("span",{children:"day streak"})]}),e.priority==="high"||e.priority==="critical"&&n.jsxs("div",{className:`ml-auto px-2 py-1 rounded-lg text-xs font-medium ${e.priority==="critical"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"}`,children:[e.priority==="critical"?"":""," ",e.priority]})]}),t==="list"&&e.motivation&&n.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:n.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic line-clamp-1",children:['"',e.motivation,'"']})}),e.tags.length>0&&n.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(f=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-md",children:["#",f]},f)),e.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-md",children:["+",e.tags.length-3]})]})]})}function Wl({isOpen:e,onClose:t,onSubmit:r,editingTask:a,defaultGoalId:s}){const{getActiveGoals:o}=De(),{addTimeBlock:i}=yt(),c=o(),[l,d]=N.useState("standard"),[h,u]=N.useState(!1),[f,g]=N.useState([]),[m,v]=N.useState({name:"",description:"",priority:"medium",dueDate:"",dueTime:"",goalId:s||"",estimatedTime:"",location:"",notes:"",tags:[],subtasks:[],shoppingItems:[{name:"",quantity:""}],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,recurrenceStartDate:"",recurrenceEndDate:""}),D=()=>{d("standard"),u(!1),v({name:"",description:"",priority:"medium",dueDate:"",dueTime:"",goalId:s||"",estimatedTime:"",location:"",notes:"",tags:[],subtasks:[],shoppingItems:[{name:"",quantity:""}],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,recurrenceStartDate:"",recurrenceEndDate:""})};Ul(()=>{e&&t()},e),N.useEffect(()=>{var S,w;e&&a?(d(a.type||"standard"),g(a.subtasks||[]),v({name:a.name||"",description:a.description||"",priority:a.priority||"medium",dueDate:a.dueDate?(()=>{const _=new Date(a.dueDate);return _.getFullYear()+"-"+String(_.getMonth()+1).padStart(2,"0")+"-"+String(_.getDate()).padStart(2,"0")})():"",dueTime:a.dueDate?(()=>{const _=new Date(a.dueDate);return String(_.getHours()).padStart(2,"0")+":"+String(_.getMinutes()).padStart(2,"0")})():"",goalId:a.goalId||"",estimatedTime:a.estimatedTime?a.estimatedTime.toString():"",location:a.location||"",notes:a.notes||"",tags:a.tags||[],subtasks:(S=a.subtasks)!=null&&S.length?a.subtasks.map(_=>typeof _=="string"?_:_.name||""):[],shoppingItems:(w=a.shoppingItems)!=null&&w.length?a.shoppingItems:[{name:"",quantity:""}],isRecurring:a.isRecurring||!1,recurrenceType:a.recurrenceType||"weekly",recurrenceInterval:a.recurrenceInterval||1,recurrenceStartDate:a.recurrenceStartDate||"",recurrenceEndDate:a.recurrenceEndDate||""})):e&&!a&&(g([]),D())},[e,a]);const y=()=>{D(),t()},p=S=>{if(S.preventDefault(),m.isRecurring&&!m.recurrenceStartDate){alert("Please provide a start date for recurring tasks");return}let w;if(l==="deadline"&&m.dueDate){const G=m.dueTime?`${m.dueDate}T${m.dueTime}`:`${m.dueDate}T00:00`;w=new Date(G)}else m.isRecurring&&m.recurrenceStartDate&&(w=new Date(m.recurrenceStartDate));let _=m.subtasks.filter(G=>G&&G.trim()!=="").map(G=>G.trim());a&&f.length>0&&(_=_.map((G,L)=>{if(L<f.length){const H=f[L];if(typeof H=="object"&&H.id)return{...H,name:G};if(typeof H=="string")return{id:`temp-${L}`,name:G,completed:!1,createdAt:new Date}}return G}));let M=[];l==="to-buy"&&(M=m.shoppingItems.filter(G=>G.name&&G.name.trim()!=="").map((G,L)=>{if(a&&a.shoppingItems&&a.shoppingItems[L]){const H=a.shoppingItems[L];return{id:H.id||`shop-${L}-${Date.now()}`,name:G.name.trim(),quantity:G.quantity||"1",completed:H.completed||!1}}return{name:G.name.trim(),quantity:G.quantity||"1"}}));const F={...m,type:l,dueDate:w,subtasks:_,shoppingItems:M};console.log(" TaskCreationModal: Submitting task data:",{taskName:F.name,taskType:l,isRecurring:F.isRecurring,recurrenceStartDate:F.recurrenceStartDate,dueDate:F.dueDate}),l==="deadline"&&m.dueDate&&m.dueTime&&!a&&(console.log("Creating calendar entry:",{date:m.dueDate,time:m.dueTime,name:m.name}),i({title:m.name,description:m.description||"Task deadline",date:m.dueDate,startTime:m.dueTime,durationMinutes:parseInt(m.estimatedTime)||60,blockType:"admin",icon:"",color:"linear-gradient(135deg, #EF4444, #DC2626)",linkedItemType:"task",linkedItemId:F.name})),r(F),y()},x=()=>{v(S=>({...S,subtasks:[...S.subtasks,""]}))},k=S=>{v(w=>({...w,subtasks:w.subtasks.filter((_,M)=>M!==S)}))},C=(S,w)=>{v(_=>({..._,subtasks:_.subtasks.map((M,F)=>F===S?w:M)}))},T=()=>{v(S=>({...S,shoppingItems:[...S.shoppingItems,{name:"",quantity:"1"}]}))},b=S=>{v(w=>({...w,shoppingItems:w.shoppingItems.filter((_,M)=>M!==S)}))},j=(S,w,_)=>{v(M=>({...M,shoppingItems:M.shoppingItems.map((F,G)=>G===S?{...F,[w]:_}:F)}))};return e?n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-3 sm:p-4 md:p-5",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl w-full max-w-sm sm:max-w-md lg:max-w-lg max-h-[90vh] overflow-hidden shadow-2xl animate-in slide-in-from-bottom duration-300 text-gray-900 dark:text-white",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-gray-700",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a?"Edit Task":"New Task"}),n.jsx("button",{onClick:y,className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Bt,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})]}),n.jsxs("form",{onSubmit:p,className:"overflow-y-auto max-h-[calc(90vh-140px)] scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 dark:scrollbar-thumb-gray-600 dark:scrollbar-track-gray-800",children:[n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Task Type"}),n.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[{id:"standard",label:"Standard",icon:Sr,color:"bg-blue-50 border-blue-200 text-blue-700",desc:"Regular task with optional subtasks"},{id:"to-buy",label:"To-Buy",icon:Gs,color:"bg-amber-50 border-amber-200 text-amber-700",desc:"Shopping list with quantities"},{id:"deadline",label:"Deadline",icon:Na,color:"bg-red-50 border-red-200 text-red-700",desc:"Time-sensitive task"}].map(S=>{const w=S.icon;return n.jsxs("button",{type:"button",onClick:()=>d(S.id),className:`p-3 rounded-xl border-2 transition-all text-center min-h-[80px] flex flex-col justify-center items-center ${l===S.id?`${S.color} border-opacity-100`:"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[n.jsx(w,{className:"w-5 h-5 mx-auto mb-1"}),n.jsx("div",{className:"text-xs font-medium mb-1",children:S.label}),n.jsx("div",{className:"text-xs opacity-75 leading-tight",children:S.desc})]},S.id)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Task Name *"}),n.jsx("input",{type:"text",required:!0,value:m.name,onChange:S=>v(w=>({...w,name:S.target.value})),inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"What needs to be done?"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Description"}),n.jsx("textarea",{value:m.description,onChange:S=>v(w=>({...w,description:S.target.value})),rows:3,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors resize-none bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"Add more details..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Priority"}),n.jsx("div",{className:"grid grid-cols-4 gap-2 overflow-x-auto",children:[{id:"low",label:"Low",color:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"},{id:"medium",label:"Medium",color:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300"},{id:"high",label:"High",color:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"},{id:"urgent",label:"Urgent",color:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"}].map(S=>n.jsx("button",{type:"button",onClick:()=>v(w=>({...w,priority:S.id})),className:`py-2 px-3 rounded-lg text-xs font-medium transition-all whitespace-nowrap min-w-[60px] flex-shrink-0 text-center ${m.priority===S.id?`${S.color} ring-2 ring-offset-1 accent-ring-300`:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:S.label},S.id))})]}),l==="deadline"&&n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Due Date"}),n.jsx("input",{type:"date",value:m.dueDate,onChange:S=>v(w=>({...w,dueDate:S.target.value})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Due Time"}),n.jsx("input",{type:"time",value:m.dueTime,onChange:S=>v(w=>({...w,dueTime:S.target.value})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Link to Goal"}),n.jsxs("select",{value:m.goalId,onChange:S=>v(w=>({...w,goalId:S.target.value})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",children:[n.jsx("option",{value:"",children:"No goal selected"}),c.length===0?n.jsx("option",{value:"",disabled:!0,children:"No goals available - create a goal first"}):c.map(S=>n.jsxs("option",{value:S.id,children:[S.icon," ",S.name]},S.id))]}),c.length===0&&n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:" Create your first goal to link tasks and track progress!"})]}),l==="to-buy"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Shopping Items"}),n.jsx("div",{className:"space-y-3",children:m.shoppingItems.map((S,w)=>n.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-xl",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:S.quantity||"1",onChange:_=>j(w,"quantity",_.target.value),placeholder:"1",className:"w-16 px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus-accent-ring focus-accent-border outline-none text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"}),n.jsx("input",{type:"text",value:S.name,onChange:_=>j(w,"name",_.target.value),placeholder:"Item name",inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus-accent-ring focus-accent-border outline-none text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"}),m.shoppingItems.length>1&&n.jsx("button",{type:"button",onClick:()=>b(w),className:"text-red-500 hover:text-red-700 p-1",children:n.jsx(ft,{className:"w-4 h-4"})})]})},w))}),n.jsxs("button",{type:"button",onClick:T,className:"w-full mt-3 py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg accent-text-600 hover-accent-text-dark text-sm font-medium flex items-center justify-center gap-2 hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Item"]})]}),l!=="to-buy"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Subtasks"}),n.jsx("div",{className:"space-y-2",children:m.subtasks.length===0?n.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:'No subtasks added. Click "Add Subtask" to break this task into smaller steps.'}):m.subtasks.map((S,w)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:S,onChange:_=>C(w,_.target.value),placeholder:`Subtask ${w+1}`,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus-accent-ring focus-accent-border outline-none text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"}),n.jsx("button",{type:"button",onClick:()=>k(w),className:"text-red-500 hover:text-red-700 p-1",children:n.jsx(ft,{className:"w-4 h-4"})})]},w))}),n.jsxs("button",{type:"button",onClick:x,className:"w-full mt-3 py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg accent-text-600 hover-accent-text-dark text-sm font-medium flex items-center justify-center gap-2 hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Subtask"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Notes"}),n.jsx("textarea",{value:m.notes,onChange:S=>v(w=>({...w,notes:S.target.value})),rows:2,spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors resize-none bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"Additional notes or reminders..."})]}),n.jsxs("div",{children:[n.jsxs("button",{type:"button",onClick:()=>u(!h),className:"flex items-center gap-3 w-full p-3 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Advanced Settings"}),n.jsx("span",{className:`ml-auto transition-transform ${h?"rotate-90":""}`,children:""})]}),h&&n.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-xl space-y-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 rounded-lg transition-colors",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Repeat Task"}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Create recurring instances of this task"})]}),n.jsx("button",{type:"button",onClick:()=>v(S=>({...S,isRecurring:!S.isRecurring})),className:`relative w-12 h-6 rounded-full transition-colors ${m.isRecurring?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"}`,children:n.jsx("div",{className:`absolute w-5 h-5 bg-white rounded-full transition-transform top-0.5 ${m.isRecurring?"translate-x-6":"translate-x-0.5"}`})})]}),m.isRecurring&&n.jsxs("div",{className:"mt-3 p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg space-y-4 border border-orange-200 dark:border-orange-800",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-orange-700 dark:text-orange-300 mb-2",children:"Repeat"}),n.jsxs("select",{value:m.recurrenceType,onChange:S=>v(w=>({...w,recurrenceType:S.target.value})),className:"w-full px-3 py-2 border border-orange-300 dark:border-orange-700 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[n.jsx("option",{value:"daily",children:"Daily"}),n.jsx("option",{value:"weekly",children:"Weekly"}),n.jsx("option",{value:"monthly",children:"Monthly"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-orange-700 dark:text-orange-300 mb-2",children:"Every"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"number",min:"1",max:"30",placeholder:"1",value:m.recurrenceInterval!==1?m.recurrenceInterval:"",onChange:S=>v(w=>({...w,recurrenceInterval:parseInt(S.target.value)||1})),className:"w-20 px-3 py-2 border border-orange-300 dark:border-orange-700 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),n.jsxs("span",{className:"text-sm text-orange-600 dark:text-orange-400",children:[m.recurrenceType==="daily"&&"day(s)",m.recurrenceType==="weekly"&&"week(s)",m.recurrenceType==="monthly"&&"month(s)"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-orange-700 dark:text-orange-300 mb-2",children:"Start Date *"}),n.jsx("input",{type:"date",required:m.isRecurring,value:m.recurrenceStartDate,onChange:S=>v(w=>({...w,recurrenceStartDate:S.target.value})),className:"w-full px-3 py-2 border border-orange-300 dark:border-orange-700 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),!m.recurrenceStartDate&&n.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"Start date is required for recurring tasks"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-orange-700 dark:text-orange-300 mb-2",children:"End Date (Optional)"}),n.jsx("input",{type:"date",value:m.recurrenceEndDate,onChange:S=>v(w=>({...w,recurrenceEndDate:S.target.value})),className:"w-full px-3 py-2 border border-orange-300 dark:border-orange-700 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]})]})]}),m.isRecurring&&n.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-blue-800 dark:text-blue-200",children:"Calendar Integration"}),n.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Repetitive tasks automatically appear as all-day events in your calendar"})]})]})})]})]})]}),n.jsxs("div",{className:"p-6 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 flex gap-3",children:[n.jsx("button",{type:"button",onClick:y,className:"flex-1 py-3 px-4 border border-gray-300 dark:border-gray-700 rounded-xl text-gray-700 dark:text-gray-200 font-medium hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 accent-gradient text-white rounded-xl font-medium hover:accent-gradient-dark transition-all shadow-lg hover:shadow-xl",children:a?"Update Task":"Create Task"})]})]})]})}):null}const py=["","","","","","","","","","","","","","","","","","","","","","","",""],Go=["#FF7101","#2196F3","#4CAF50","#9C27B0","#E91E63","#FBC02D","#607D8B"],hy=[{id:"daily",name:"Daily",desc:"Every day"},{id:"weekly",name:"Weekly",desc:"Select days"},{id:"custom",name:"Custom",desc:"X times per period"}],fy=[{id:"mon",label:"M",full:"Monday"},{id:"tue",label:"T",full:"Tuesday"},{id:"wed",label:"W",full:"Wednesday"},{id:"thu",label:"T",full:"Thursday"},{id:"fri",label:"F",full:"Friday"},{id:"sat",label:"S",full:"Saturday"},{id:"sun",label:"S",full:"Sunday"}];function Gi({isOpen:e,onClose:t,editingHabit:r,defaultGoalId:a}){var x,k,C,T;const{addHabit:s,updateHabit:o,changeHabitFrequency:i}=He(),{getActiveGoals:c}=De(),l=c(),[d,h]=N.useState(!1),[u,f]=N.useState(!1),[g,m]=N.useState({name:"",description:"",icon:"",color:Go[0],category:void 0,measurementType:"simple",frequency:"daily",selectedDays:[],calendarIntegration:!1,targetUnit:"units",goalId:a||"",useGoalColor:!!a,customColor:void 0});N.useEffect(()=>{if(e){if(r)m({name:r.name,description:r.description||"",icon:r.icon,color:r.color,category:r.category,measurementType:r.measurementType,frequency:r.frequency,selectedDays:r.selectedDays||[],calendarIntegration:r.calendarIntegration||!1,targetUnit:r.targetUnit||"units",targetAmount:r.targetAmount,customFrequency:r.customFrequency,startDate:r.startDate||new Date().toISOString().split("T")[0],scheduledTime:r.scheduledTime||"09:00",reminderMinutes:r.reminderMinutes,goalId:r.goalId||"",useGoalColor:r.useGoalColor,customColor:r.customColor}),f(r.calendarIntegration||!1);else{const b=a||"",j=b?l.find(S=>S.id===b):void 0;m({name:"",description:"",icon:"",color:Go[0],category:j==null?void 0:j.category,measurementType:"simple",frequency:"daily",selectedDays:[],calendarIntegration:!1,targetUnit:"units",startDate:new Date().toISOString().split("T")[0],scheduledTime:"09:00",goalId:b,useGoalColor:!!b,customColor:void 0}),f(!1)}h(!1)}},[e,r,a]);const v=()=>{var b;return!(!g.name.trim()||!g.category||g.frequency==="weekly"&&g.selectedDays.length===0||g.frequency==="custom"&&(!((b=g.customFrequency)!=null&&b.times)||g.customFrequency.times<1))},D=()=>{if(v()){if(r)if(r.frequency!==g.frequency||JSON.stringify(r.selectedDays)!==JSON.stringify(g.selectedDays)||JSON.stringify(r.customFrequency)!==JSON.stringify(g.customFrequency)){i(r.id,g.frequency,g.selectedDays,g.customFrequency,"User changed frequency settings");const{frequency:j,selectedDays:S,customFrequency:w,..._}=g;o(r.id,_)}else o(r.id,g);else s(g);t()}},y=b=>{const j=g.selectedDays||[];if(j.includes(b)){const S=j.filter(w=>w!==b);m({...g,selectedDays:S})}else{const S=[...j,b];m({...g,selectedDays:S})}},p=b=>{const j=b?l.find(S=>S.id===b):void 0;console.log("Goal changed:",{goalId:b,linkedGoal:j==null?void 0:j.name,goalColor:j==null?void 0:j.color,currentFormColor:g.color}),m({...g,goalId:b,category:(j==null?void 0:j.category)||g.category,useGoalColor:!!b,customColor:g.color})};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-3 sm:p-4 md:p-5",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl w-full max-w-sm sm:max-w-md md:max-w-lg max-h-[90vh] overflow-hidden text-gray-900 dark:text-white animate-in slide-in-from-bottom-4 duration-300 shadow-2xl flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[n.jsx("h2",{className:"text-2xl font-bold",children:r?"Edit Habit":"New Habit"}),n.jsx("button",{onClick:t,className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white transition-colors",children:""})]}),n.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("div",{onClick:()=>h(!d),className:"w-24 h-24 mx-auto mb-4 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center text-4xl cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors border-3 border-transparent",style:g.icon!==""?{background:g.color,borderColor:"var(--accent-color)"}:{},children:g.icon}),d&&n.jsx("div",{className:"grid grid-cols-8 gap-2 p-4 bg-gray-100 dark:bg-gray-800 rounded-xl mt-4 max-h-48 overflow-y-auto",children:py.map(b=>n.jsx("button",{onClick:()=>{m({...g,icon:b}),h(!1)},className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center text-xl transition-colors",children:b},b))})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Name *"}),n.jsx("input",{type:"text",value:g.name,onChange:b=>m({...g,name:b.target.value}),placeholder:"What habit do you want to build?",maxLength:50,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors"})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Description (Optional)"}),n.jsx("textarea",{value:g.description,onChange:b=>m({...g,description:b.target.value}),placeholder:"Why is this habit important to you?",spellCheck:"true",autoCorrect:"on",autoComplete:"off",maxLength:200,inputMode:"text",className:"w-full p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus-accent-border transition-colors min-h-20 resize-y"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Color *",g.goalId&&g.useGoalColor!==!1&&n.jsx("span",{className:"text-xs text-blue-500 ml-2",children:"(Inherited from Goal)"})]}),n.jsx("div",{className:"grid grid-cols-7 gap-3",children:Go.map(b=>n.jsx("button",{onClick:()=>{console.log("Color selected:",b,"Current goalId:",g.goalId),m({...g,color:b,customColor:g.goalId?b:void 0,useGoalColor:g.goalId?!1:void 0})},className:`w-12 h-12 rounded-xl border-3 transition-all hover:scale-110 ${g.color===b?"border-white shadow-lg shadow-accent":"border-transparent"}`,style:{background:b},children:g.color===b&&n.jsx("span",{className:"text-white font-bold",children:""})},b))}),g.goalId&&n.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Use Goal Color"}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:g.useGoalColor!==!1?"Using goal color":"Using custom color"})]}),n.jsx("button",{type:"button",onClick:()=>m({...g,useGoalColor:g.useGoalColor===!1}),className:`w-12 h-6 rounded-full transition-all duration-200 relative ${g.useGoalColor!==!1?"accent-bg-500":"bg-gray-300 dark:bg-gray-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-lg transform transition-transform duration-200 absolute top-0.5 ${g.useGoalColor!==!1?"translate-x-6":"translate-x-0.5"}`})})]})})]}),!g.goalId&&n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Category *"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:St.map(b=>n.jsxs("button",{type:"button",onClick:()=>m({...g,category:b.id}),className:`p-3 rounded-xl border-2 text-left transition-all hover:scale-105 ${g.category===b.id?"border-white shadow-lg":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}`,style:{background:g.category===b.id?b.color:`${b.color}15`,color:g.category===b.id?"white":b.color},children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"text-lg",children:b.icon}),n.jsx("span",{className:"font-semibold text-sm",children:b.name})]}),n.jsx("div",{className:`text-xs ${g.category===b.id?"text-white opacity-90":"text-gray-600 dark:text-gray-400"}`,children:b.description})]},b.id))})]}),g.goalId&&g.category&&n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Category (Inherited from Goal)"}),n.jsx("div",{className:"p-3 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:(x=St.find(b=>b.id===g.category))==null?void 0:x.icon}),n.jsx("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300",children:(k=St.find(b=>b.id===g.category))==null?void 0:k.name}),n.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-auto",children:"Auto-assigned"})]})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Link to Goal"}),n.jsxs("select",{value:g.goalId||"",onChange:b=>p(b.target.value),className:"w-full p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus-accent-border transition-colors",children:[n.jsx("option",{value:"",children:"No goal selected"}),l.length===0?n.jsx("option",{value:"",disabled:!0,children:"No goals available - create a goal first"}):l.map(b=>n.jsxs("option",{value:b.id,children:[b.icon," ",b.name]},b.id))]}),l.length===0&&n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:" Create your first goal to link habits and track progress!"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Frequency *"}),n.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:hy.map(b=>n.jsxs("button",{onClick:()=>m({...g,frequency:b.id,selectedDays:[]}),className:`p-3 border-2 rounded-lg text-center transition-all ${g.frequency===b.id?"accent-border-500 accent-bg-50 accent-text-500":"border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 hover:border-gray-400 dark:hover:border-gray-600"}`,children:[n.jsx("div",{className:"font-semibold text-sm mb-1",children:b.name}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:b.desc})]},b.id))}),g.frequency==="weekly"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Select Days *"}),n.jsx("div",{className:"grid grid-cols-7 gap-2",children:fy.map(b=>{var j;return n.jsx("button",{onClick:()=>y(b.id),className:`p-2 border-2 rounded-lg text-center text-sm font-semibold transition-all ${(j=g.selectedDays)!=null&&j.includes(b.id)?"accent-border-500 accent-bg-500 text-white":"border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 hover:border-gray-400 dark:hover:border-gray-600"}`,children:b.label},b.id)})})]}),g.frequency==="custom"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Custom Frequency *"}),n.jsxs("div",{className:"flex gap-3 items-center",children:[n.jsx("input",{type:"number",value:((C=g.customFrequency)==null?void 0:C.times)||"",onChange:b=>{var j;return m({...g,customFrequency:{times:parseInt(b.target.value)||1,period:((j=g.customFrequency)==null?void 0:j.period)||"week"}})},placeholder:"3",min:"1",max:"7",className:"w-16 p-2 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white text-center focus:outline-none focus-accent-border"}),n.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"times per"}),n.jsxs("select",{value:((T=g.customFrequency)==null?void 0:T.period)||"week",onChange:b=>{var j;return m({...g,customFrequency:{times:((j=g.customFrequency)==null?void 0:j.times)||1,period:b.target.value}})},className:"p-2 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white focus:outline-none focus-accent-border",children:[n.jsx("option",{value:"week",children:"week"}),n.jsx("option",{value:"month",children:"month"})]})]})]})]}),g.frequency!=="custom"&&n.jsxs("div",{className:"mb-6",children:[n.jsxs("button",{onClick:()=>f(!u),className:"w-full flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-xl",children:""}),n.jsx("span",{className:"font-semibold",children:"Scheduling"})]}),n.jsx("span",{className:`transition-transform ${u?"rotate-90":""}`,children:""})]}),u&&n.jsxs("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-xl space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Start Date"}),n.jsx("input",{type:"date",value:g.startDate||"",onChange:b=>m({...g,startDate:b.target.value}),className:"w-full p-2 bg-white dark:bg-gray-900 border-2 border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white focus:outline-none focus-accent-border"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Time"}),n.jsx("input",{type:"time",value:g.scheduledTime||"09:00",onChange:b=>m({...g,scheduledTime:b.target.value}),className:"w-full p-2 bg-white dark:bg-gray-900 border-2 border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white focus:outline-none focus-accent-border"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Reminder"}),n.jsxs("select",{value:g.reminderMinutes||"",onChange:b=>m({...g,reminderMinutes:parseInt(b.target.value)||void 0}),className:"w-full p-2 bg-white dark:bg-gray-900 border-2 border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white focus:outline-none focus-accent-border",children:[n.jsx("option",{value:"",children:"No reminder"}),n.jsx("option",{value:"0",children:"At time of habit"}),n.jsx("option",{value:"5",children:"5 minutes before"}),n.jsx("option",{value:"15",children:"15 minutes before"}),n.jsx("option",{value:"30",children:"30 minutes before"}),n.jsx("option",{value:"60",children:"1 hour before"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Add to Calendar"}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create time blocks in your calendar"})]})]}),n.jsx("button",{type:"button",onClick:()=>m({...g,calendarIntegration:!g.calendarIntegration}),className:`w-12 h-6 rounded-full transition-all duration-200 relative ${g.calendarIntegration?"accent-bg-500":"bg-gray-300 dark:bg-gray-600"}`,children:n.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-lg transform transition-transform duration-200 absolute top-0.5 ${g.calendarIntegration?"translate-x-6":"translate-x-0.5"}`})})]})]})]})]}),n.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[n.jsx("button",{onClick:t,className:"flex-1 p-3 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-xl font-semibold transition-colors",children:"Cancel"}),n.jsx("button",{onClick:D,disabled:!v(),className:`flex-1 p-3 rounded-xl font-semibold transition-all ${v()?"accent-bg-500 hover-accent-bg-dark text-white hover:-translate-y-0.5 shadow-lg shadow-accent":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,children:r?"Update Habit":"Create Habit"})]})]})}):null}function Vl(e,t){if(console.log("getHabitColor debug:",{habitName:e.name,goalId:e.goalId,useGoalColor:e.useGoalColor,customColor:e.customColor,habitColor:e.color,goalsCount:t.length}),e.goalId&&e.useGoalColor!==!1){const a=t.find(s=>s.id===e.goalId);if(a&&a.color)return console.log("Using goal color:",a.color,"from goal:",a.name),a.color;console.log("Goal not found or missing color, goalId:",e.goalId)}if(e.customColor&&e.useGoalColor===!1)return console.log("Using custom color:",e.customColor),e.customColor;const r=e.color||"#FF7101";return console.log("Using fallback color:",r),r}const Ui=[{id:"very-low",emoji:"",label:"Very Low",color:"text-red-600"},{id:"low",emoji:"",label:"Low",color:"text-orange-600"},{id:"neutral",emoji:"",label:"Neutral",color:"text-gray-600"},{id:"good",emoji:"",label:"Good",color:"text-green-600"},{id:"great",emoji:"",label:"Great",color:"text-blue-600"}],Pd=[{id:"goals",icon:"",label:"Goals",color:"bg-blue-50 text-blue-700 border-blue-200"},{id:"tasks",icon:"",label:"Tasks",color:"bg-green-50 text-green-700 border-green-200"},{id:"habits",icon:"",label:"Habits",color:"bg-purple-50 text-purple-700 border-purple-200"}];function yy({isOpen:e,onClose:t,items:r,selectedItems:a,onItemSelect:s,onItemDeselect:o,title:i,icon:c,emptyMessage:l="No items available",searchPlaceholder:d="Search items..."}){const[h,u]=N.useState(""),[f,g]=N.useState(-1),m=N.useRef(null),v=N.useRef(null),D=N.useRef([]);N.useEffect(()=>{e&&v.current&&v.current.focus()},[e]),N.useEffect(()=>{const x=C=>{m.current&&!m.current.contains(C.target)&&(C.target.closest("[data-dropdown-toggle]")||t())},k=C=>{if(C.key==="Escape")t();else if(C.key==="ArrowDown")C.preventDefault(),g(T=>T<y.length-1?T+1:0);else if(C.key==="ArrowUp")C.preventDefault(),g(T=>T>0?T-1:y.length-1);else if(C.key==="Enter"&&f>=0){C.preventDefault();const T=y[f];T&&p(T)}};return e&&(document.addEventListener("mousedown",x),document.addEventListener("keydown",k)),()=>{document.removeEventListener("mousedown",x),document.removeEventListener("keydown",k)}},[e,t]);const y=r.filter(x=>x.name.toLowerCase().includes(h.toLowerCase())||x.description&&x.description.toLowerCase().includes(h.toLowerCase()));N.useEffect(()=>{g(-1)},[h]),N.useEffect(()=>{var x;f>=0&&D.current[f]&&((x=D.current[f])==null||x.focus())},[f]);const p=x=>{a.includes(x.id)?o(x.id):s(x.id)};return e?n.jsxs("div",{ref:m,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg max-h-64 overflow-hidden",role:"listbox","aria-label":`Select ${i}`,"aria-multiselectable":"true",onClick:x=>x.stopPropagation(),children:[n.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-lg",children:c}),n.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:["Select ",i]})]}),n.jsxs("div",{className:"relative",children:[n.jsx(Zm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),n.jsx("input",{ref:v,type:"text",value:h,onChange:x=>u(x.target.value),placeholder:d,className:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus-accent-ring focus-accent-border outline-none"})]})]}),n.jsx("div",{className:"max-h-48 overflow-y-auto",children:y.length===0?n.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400 text-sm",children:h?`No ${i.toLowerCase()} found matching "${h}"`:l}):n.jsx("div",{className:"p-2",children:y.map((x,k)=>{const C=a.includes(x.id),T=k===f;return n.jsxs("button",{ref:b=>D.current[k]=b,onClick:b=>{b.preventDefault(),b.stopPropagation(),p(x)},onMouseEnter:()=>g(k),className:`w-full flex items-center gap-3 p-2 rounded-lg text-left transition-colors ${C?"accent-bg-50 dark:accent-bg-900 accent-border-200 border":T?"bg-gray-100 dark:bg-gray-600":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,"aria-selected":C,role:"option",children:[n.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${C?"accent-bg-500 accent-border-500":"border-gray-300 dark:border-gray-600"}`,children:C&&n.jsx(zl,{className:"w-3 h-3 text-white"})}),x.icon&&n.jsx("span",{className:"text-lg flex-shrink-0",children:x.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:`font-medium text-sm truncate ${C?"accent-text-700 dark:accent-text-300":"text-gray-900 dark:text-white"}`,children:x.name}),x.isCompleted!==void 0&&n.jsx("span",{className:`text-xs px-2 py-1 rounded-full flex-shrink-0 ml-2 ${x.isCompleted?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"}`,children:x.isCompleted?"Complete":"In Progress"}),x.progress!==void 0&&n.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0 ml-2",children:[Math.round(x.progress),"%"]})]}),x.description&&n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-1",children:x.description})]})]},x.id)})})}),y.length>0&&n.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[a.length," of ",r.length," selected"]})})]}):null}function qi({isOpen:e,onClose:t,defaultGoalId:r}){const{addEntry:a,updateEntry:s,selectedEntry:o,isAutoSaving:i,setAutoSaving:c}=Cr(),{tasks:l}=Oe(),{getActiveGoals:d}=De(),{habits:h}=He(),u=d(),f=h,[g,m]=N.useState({content:"",mood:void 0,tags:[],linkedGoals:r?[r]:[],linkedTasks:[],linkedHabits:[]}),[v,D]=N.useState(0),[y,p]=N.useState(new Set),[x,k]=N.useState(""),[C,T]=N.useState(null),[b,j]=N.useState(null),S=N.useRef(null),w=$=>{switch($){case"goals":return u.map(R=>{var Y;return{id:R.id,name:R.name,icon:R.icon,color:R.color,description:R.description,progress:((Y=R.progress)==null?void 0:Y.percentage)||0,isCompleted:R.isCompleted}});case"tasks":return l.map(R=>({id:R.id,name:R.name,icon:"",description:R.description,isCompleted:R.status==="completed"}));case"habits":return f.map(R=>({id:R.id,name:R.name,icon:R.icon,color:Vl(R,u),description:R.description,progress:R.streak}));default:return[]}};N.useEffect(()=>{var $;if(e){if(o){m({content:o.content,mood:o.mood,tags:o.tags,linkedGoals:o.linkedGoals,linkedTasks:o.linkedTasks,linkedHabits:o.linkedHabits}),D(o.content.length),k(o.tags.join(", "));const R=new Set;o.linkedGoals.length>0&&R.add("goals"),o.linkedTasks.length>0&&R.add("tasks"),o.linkedHabits.length>0&&R.add("habits"),p(R)}else _();($=S.current)==null||$.focus()}},[e,o]);const _=()=>{m({content:"",mood:void 0,tags:[],linkedGoals:r?[r]:[],linkedTasks:[],linkedHabits:[]}),D(0),p(r?new Set(["goals"]):new Set),k(""),j(null),C&&(clearTimeout(C),T(null))},M=()=>{C&&clearTimeout(C),_(),t()},F=$=>{if(m(R=>({...R,content:$})),D($.length),o){C&&clearTimeout(C),c(!0);const R=setTimeout(()=>{s(o.id,{content:$}),c(!1)},1500);T(R)}},G=$=>{m(R=>({...R,mood:$}))},L=$=>{k($);const R=$.split(",").map(Y=>Y.trim()).filter(Y=>Y!=="");m(Y=>({...Y,tags:R}))},H=$=>{j(b===$?null:$)},P=($,R)=>{const Y=`linked${$.charAt(0).toUpperCase()+$.slice(1)}`,oe=g[Y];if(!oe.includes(R)&&(m(ae=>({...ae,[Y]:[...oe,R]})),!y.has($))){const ae=new Set(y);ae.add($),p(ae)}},O=($,R)=>{const Y=`linked${$.charAt(0).toUpperCase()+$.slice(1)}`,oe=g[Y].filter(ae=>ae!==R);if(m(ae=>({...ae,[Y]:oe})),oe.length===0){const ae=new Set(y);ae.delete($),p(ae)}},q=($,R)=>{O($,R)},U=$=>{$.preventDefault(),o?s(o.id,{content:g.content,mood:g.mood||"neutral",tags:g.tags,linkedGoals:g.linkedGoals,linkedTasks:g.linkedTasks,linkedHabits:g.linkedHabits}):a({...g,mood:g.mood||"neutral"}),M()},Z=v>=10;return e?n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-3 sm:p-4 md:p-5",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl w-full max-w-sm sm:max-w-md md:max-w-lg max-h-[90vh] overflow-hidden shadow-2xl animate-in slide-in-from-bottom duration-300 text-gray-900 dark:text-white",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-gray-700",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[" ",o?"Edit":"New"," Journal Entry"]}),n.jsx("button",{onClick:M,className:"w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Bt,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}),n.jsxs("form",{onSubmit:U,className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"What's on your mind?"}),n.jsx("textarea",{ref:S,value:g.content,onChange:$=>F($.target.value),placeholder:"What's on your mind? Reflect on your progress, share your thoughts, or write about your day...",inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full min-h-[120px] p-4 border-2 border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-800 focus:bg-white dark:focus:bg-gray-700 focus-accent-border focus:ring-2 focus-accent-ring outline-none transition-all resize-y placeholder-gray-500 dark:placeholder-gray-400",style:{lineHeight:"1.5"}}),v>=100&&n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-right mt-2",children:[v," characters"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"How are you feeling?"}),n.jsx("div",{className:"flex gap-3 justify-between",children:Ui.map($=>n.jsxs("button",{type:"button",onClick:()=>G($.id),className:`flex-1 flex flex-col items-center gap-2 p-3 border-2 rounded-xl transition-all ${g.mood===$.id?"accent-border-500 accent-bg-50 dark:accent-bg-900 shadow-sm":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600 hover:-translate-y-0.5"}`,children:[n.jsx("div",{className:`text-2xl transition-transform ${g.mood===$.id?"scale-110":""}`,children:$.emoji}),n.jsx("div",{className:`text-xs font-semibold ${g.mood===$.id?"accent-text-600":"text-gray-600"}`,children:$.label})]},$.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Link to your progress"}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:Pd.map($=>{const R=`linked${$.id.charAt(0).toUpperCase()+$.id.slice(1)}`,Y=g[R].length,oe=Y>0;return n.jsxs("button",{type:"button","data-dropdown-toggle":!0,onClick:ae=>{ae.preventDefault(),ae.stopPropagation(),H($.id)},className:`w-full flex flex-col items-center gap-2 p-4 border-2 rounded-xl transition-all ${oe?"accent-border-500 accent-bg-50 dark:accent-bg-900":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600 hover:-translate-y-0.5"}`,children:[n.jsx("div",{className:"text-xl",children:$.icon}),n.jsxs("div",{className:`text-xs font-semibold ${oe?"accent-text-600 dark:accent-text-400":"text-gray-600 dark:text-gray-300"}`,children:[$.label,Y>0&&n.jsxs("div",{className:"text-xs mt-1 opacity-75",children:[Y," selected"]})]})]},$.id)})}),b&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 z-50",children:Pd.map($=>{if(b!==$.id)return null;const R=`linked${$.id.charAt(0).toUpperCase()+$.id.slice(1)}`;return n.jsx(yy,{isOpen:!0,onClose:()=>j(null),items:w($.id),selectedItems:g[R],onItemSelect:Y=>P($.id,Y),onItemDeselect:Y=>O($.id,Y),title:$.label,icon:$.icon,emptyMessage:`No ${$.label.toLowerCase()} available`,searchPlaceholder:`Search ${$.label.toLowerCase()}...`},$.id)})})]}),(g.linkedTasks.length>0||g.linkedGoals.length>0||g.linkedHabits.length>0)&&n.jsxs("div",{className:"space-y-3",children:[g.linkedGoals.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-300 mb-2",children:[" Linked Goals (",g.linkedGoals.length,")"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:g.linkedGoals.map($=>{const R=u.find(Y=>Y.id===$);return R?n.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-700 dark:bg-blue-900 dark:text-blue-300 dark:border-blue-800",children:[n.jsx("span",{className:"text-lg",children:R.icon}),n.jsx("span",{className:"font-medium",children:R.name}),R.progress&&n.jsxs("span",{className:"text-xs opacity-75",children:["(",Math.round(R.progress.percentage||0),"%)"]}),n.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),q("goals",$)},className:"w-4 h-4 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs hover:bg-blue-800 transition-colors ml-1",children:""})]},$):null})})]}),g.linkedTasks.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-300 mb-2",children:[" Linked Tasks (",g.linkedTasks.length,")"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:g.linkedTasks.map($=>{const R=l.find(Y=>Y.id===$);return R?n.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700 dark:bg-green-900 dark:text-green-300 dark:border-green-800",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsx("span",{className:"font-medium",children:R.name}),R.status==="completed"&&n.jsx("span",{className:"text-xs bg-green-100 text-green-600 px-1 py-0.5 rounded",children:"Done"}),n.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),q("tasks",$)},className:"w-4 h-4 bg-green-600 text-white rounded-full flex items-center justify-center text-xs hover:bg-green-800 transition-colors ml-1",children:""})]},$):null})})]}),g.linkedHabits.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-300 mb-2",children:[" Linked Habits (",g.linkedHabits.length,")"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:g.linkedHabits.map($=>{const R=f.find(Y=>Y.id===$);return R?n.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-purple-50 border border-purple-200 rounded-lg text-sm text-purple-700 dark:bg-purple-900 dark:text-purple-300 dark:border-purple-800",children:[n.jsx("span",{className:"text-lg",children:R.icon}),n.jsx("span",{className:"font-medium",children:R.name}),R.streak>0&&n.jsxs("span",{className:"text-xs bg-purple-100 text-purple-600 px-1 py-0.5 rounded",children:[R.streak," day streak"]}),n.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),q("habits",$)},className:"w-4 h-4 bg-purple-600 text-white rounded-full flex items-center justify-center text-xs hover:bg-purple-800 transition-colors ml-1",children:""})]},$):null})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Tags (optional)"}),n.jsx("input",{type:"text",value:x,onChange:$=>L($.target.value),placeholder:"Add tags separated by commas...",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 border-2 border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white bg-white dark:bg-gray-800 focus-accent-border focus:ring-2 focus-accent-ring outline-none transition-all placeholder-gray-500 dark:placeholder-gray-400"}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Use tags to organize and find your entries later"})]})]}),n.jsxs("div",{className:"p-6 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${i?"accent-bg-500 animate-pulse":"bg-gray-400"}`}),n.jsx("span",{children:i?"Saving...":"Auto-saving..."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{type:"button",onClick:M,className:"px-6 py-2 text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-700 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),n.jsxs("button",{type:"submit",disabled:!Z,className:`px-6 py-2 rounded-xl font-medium transition-all ${Z?"accent-bg-500 text-white shadow-lg hover-accent-bg-dark hover:shadow-xl hover:-translate-y-0.5":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[o?"Update":"Save"," Entry"]})]})]})]})]})}):null}function xy({goal:e,onBack:t,onEdit:r,onNavigate:a}){var Ql,Kl,Jl,Xl,Zl,ec;const{getTasksByGoal:s,addTask:o,updateTask:i,toggleTask:c,deleteTask:l}=Oe(),{getHabitsByGoal:d,getHabitStreak:h,isHabitCompletedToday:u,toggleDayCompletion:f,deleteHabit:g}=He(),{goals:m,deleteGoal:v,toggleGoalCompletion:D,archiveGoal:y,addMilestone:p,updateMilestone:x,deleteMilestone:k,toggleMilestoneCompletion:C,updateProgressSettings:T}=De(),{entries:b}=Cr(),j=m.find(I=>I.id===e.id)||e;console.log(" GoalDetail - Current goal:",{id:j.id,name:j.name,milestonesCount:((Ql=j.milestones)==null?void 0:Ql.length)||0,milestones:j.milestones||[],hasProgressSettings:!!j.progressSettings});const S=()=>({backgroundColor:e.color,transition:"all 0.2s ease-in-out"}),w=()=>{const I=e.color;if(I.startsWith("#")){const se=I.replace("#",""),Ae=Math.max(0,parseInt(se.substr(0,2),16)*.8),At=Math.max(0,parseInt(se.substr(2,2),16)*.8),Aa=Math.max(0,parseInt(se.substr(4,2),16)*.8);return`rgb(${Math.round(Ae)}, ${Math.round(At)}, ${Math.round(Aa)})`}return I},_=()=>({color:e.color}),[M,F]=N.useState(!1),[G,L]=N.useState(!1),[H,P]=N.useState(!1),[O,q]=N.useState(!1),[U,Z]=N.useState(null),[$,R]=N.useState(null),[Y,oe]=N.useState(null),[ae,Pe]=N.useState(null),[$e,Re]=N.useState(null),[Te,Ee]=N.useState(!1),[nt,ut]=N.useState(""),[at,ce]=N.useState(""),[mt,st]=N.useState(!1),[B,V]=N.useState(j.progressSettings),Q=N.useRef(null);N.useEffect(()=>{V(j.progressSettings)},[j.progressSettings]),N.useEffect(()=>{const I=se=>{Q.current&&!Q.current.contains(se.target)&&F(!1)};return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[]);const A=s(j.id),X=d(j.id),re=I=>new Date(I).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),te=(I=>{if(!I)return null;const se=new Date(I),Ae=new Date,At=se.getTime()-Ae.getTime();return Math.ceil(At/(1e3*60*60*24))})(j.targetDate),K=()=>{confirm("Are you sure you want to delete this goal? This action cannot be undone.")&&(v(j.id),t())},Fe=()=>{D(j.id),F(!1)},ke=()=>{confirm("Are you sure you want to archive this goal? You can unarchive it later from Settings.")&&(y(j.id),t())},gt=b.filter(I=>I.linkedGoals.includes(j.id)),E=()=>{q(!0)},ne=()=>{Ee(!0)},ie=()=>{nt.trim()&&(p(j.id,nt.trim(),at||void 0),ut(""),ce(""),Ee(!1))},me=()=>{ut(""),ce(""),Ee(!1)},ue=I=>{Re($e===I?null:I)},Xe=(I,se)=>{se.stopPropagation(),C(j.id,I)},Pt=I=>{confirm("Are you sure you want to delete this milestone?")&&(k(j.id,I),Re(null))},Pr=()=>{L(!0)},ye=()=>{P(!0)},he=(I,se)=>{se.stopPropagation(),c(I)},Wt=(I,se)=>{se.stopPropagation();const Ae=new Date().toISOString().split("T")[0];f(I,Ae)},Jr=I=>{Z(U===I?null:I)},Ar=I=>{R($===I?null:I)},Ln=I=>{oe(I),L(!0),Z(null)},pg=I=>{confirm("Are you sure you want to delete this task?")&&(l(I),Z(null))},hg=I=>{Pe(I),P(!0),R(null)},fg=I=>{confirm("Are you sure you want to delete this habit?")&&(g(I),R(null))},yg=I=>{Y?i(Y.id,I):o(I),L(!1),oe(null)},xg=()=>{L(!1),oe(null)},bg=()=>{P(!1),Pe(null)},vg=()=>{st(!mt)},kg=I=>{V(se=>({...se,calculationMode:I,mixedWeights:I==="mixed"?{tasks:40,habits:40,milestones:20}:se.mixedWeights}))},wg=(I,se)=>{V(Ae=>({...Ae,mixedWeights:{...Ae.mixedWeights,[I]:se}}))},jg=()=>{T(j.id,B),st(!1)},Ng=()=>{V(j.progressSettings),st(!1)},Sg=I=>{const se=typeof I=="string"?new Date(I):I,Ae=new Date,At=new Date(Ae);if(At.setDate(At.getDate()-1),se.toDateString()===Ae.toDateString())return`Today, ${se.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}`;if(se.toDateString()===At.toDateString())return`Yesterday, ${se.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}`;{const Aa=Ae.getTime()-se.getTime();return`${Math.ceil(Aa/(1e3*60*60*24))} days ago`}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("button",{onClick:t,className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center transition-colors",children:n.jsx(Jm,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center transition-colors",children:n.jsx("span",{className:"text-base",children:""})}),n.jsx("button",{onClick:()=>r(e),className:"w-9 h-9 rounded-lg flex items-center justify-center text-white",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:n.jsx(Tn,{className:"w-4 h-4 text-white"})}),n.jsxs("div",{ref:Q,className:"relative",children:[n.jsx("button",{onClick:()=>F(!M),className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center transition-colors",children:n.jsx(wh,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),M&&n.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-10 min-w-48",children:[n.jsxs("button",{onClick:Fe,className:"w-full px-4 py-3 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700 first:rounded-t-lg transition-colors flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:j.isCompleted?"":""}),n.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:j.isCompleted?"Mark as Active":"Mark as Completed"})]}),n.jsxs("button",{onClick:()=>{F(!1),ke()},className:"w-full px-4 py-3 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center gap-2",children:[n.jsx(sa,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"}),n.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Archive Goal"})]}),n.jsxs("button",{onClick:()=>{F(!1),K()},className:"w-full px-4 py-3 text-left text-sm hover:bg-red-50 dark:hover:bg-red-900/30 last:rounded-b-lg transition-colors flex items-center gap-2",children:[n.jsx(ft,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),n.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Delete Goal"})]})]})]})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 mb-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-5",children:[n.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center text-2xl text-white flex-shrink-0",style:{background:e.color},children:e.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-2",children:j.name}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-3",children:j.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[j.targetDate&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:""}),n.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:re(j.targetDate)})]}),te&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:""}),n.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:[te," days left"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{children:""}),n.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:["Created ",re(j.createdAt)]})]})]})]})]}),n.jsxs("div",{className:"rounded-2xl p-5 text-white",style:{background:e.color},children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("span",{className:"text-lg font-semibold",children:"Overall Progress"}),n.jsxs("span",{className:"text-2xl font-bold",children:[j.progress.percentage,"%"]})]}),n.jsx("div",{className:"h-2 bg-white bg-opacity-20 rounded-full mb-4",children:n.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-500",style:{width:`${j.progress.percentage}%`}})}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"text-xl font-bold",children:[j.progress.tasksCompleted,"/",j.progress.tasksTotal]}),n.jsx("div",{className:"text-sm opacity-80",children:"Tasks Done"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"text-xl font-bold",children:[j.progress.habitCompletionRate,"%"]}),n.jsx("div",{className:"text-sm opacity-80",children:"Habit Rate"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xl font-bold",children:j.progress.currentStreak}),n.jsx("div",{className:"text-sm opacity-80",children:"Day Streak"})]})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[" Progress Settings",n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:j.progressSettings.calculationMode})]}),n.jsxs("button",{onClick:vg,className:"text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-1",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:[n.jsx(eg,{className:"w-4 h-4"}),"Configure"]})]}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 border border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"mb-4",children:[n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Current Progress Mode: ",n.jsx("span",{className:"font-medium capitalize",children:j.progressSettings.calculationMode})]}),n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:[j.progressSettings.calculationMode==="tasks"&&"Progress calculated based on task completion percentage",j.progressSettings.calculationMode==="habits"&&"Progress calculated based on habit completion rate",j.progressSettings.calculationMode==="milestones"&&"Progress calculated based on milestone completion percentage",j.progressSettings.calculationMode==="mixed"&&"Progress calculated using weighted combination of tasks, habits, and milestones"]})]}),mt&&n.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Choose Progress Calculation Method"}),n.jsx("div",{className:"space-y-2",children:["tasks","habits","milestones","mixed"].map(I=>n.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",children:[n.jsx("input",{type:"radio",name:"progressMode",value:I,checked:B.calculationMode===I,onChange:()=>kg(I),className:"w-4 h-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"font-medium text-gray-900 dark:text-white capitalize",children:[I," Mode"]}),n.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[I==="tasks"&&"Based on completed vs total tasks",I==="habits"&&"Based on habit completion rate over time",I==="milestones"&&"Based on completed vs total milestones",I==="mixed"&&"Weighted combination of all progress types"]})]})]},I))})]}),B.calculationMode==="mixed"&&B.mixedWeights&&n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Adjust Weights (must total 100%)"}),n.jsx("div",{className:"space-y-3",children:["tasks","habits","milestones"].map(I=>{var se,Ae;return n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("label",{className:"w-20 text-sm text-gray-600 dark:text-gray-400 capitalize",children:[I,":"]}),n.jsx("input",{type:"range",min:"0",max:"100",value:((se=B.mixedWeights)==null?void 0:se[I])||0,onChange:At=>wg(I,parseInt(At.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),n.jsxs("span",{className:"w-12 text-sm text-gray-600 dark:text-gray-400",children:[((Ae=B.mixedWeights)==null?void 0:Ae[I])||0,"%"]})]},I)})}),n.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-500",children:["Total: ",(((Kl=B.mixedWeights)==null?void 0:Kl.tasks)||0)+(((Jl=B.mixedWeights)==null?void 0:Jl.habits)||0)+(((Xl=B.mixedWeights)==null?void 0:Xl.milestones)||0),"%"]})]}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsx("button",{onClick:jg,className:"px-4 py-2 text-white rounded-lg text-sm font-medium",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:"Save Settings"}),n.jsx("button",{onClick:Ng,className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg text-sm font-medium hover:bg-gray-200 dark:hover:bg-gray-600",children:"Cancel"})]})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[" Milestones",n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:((Zl=j.milestones)==null?void 0:Zl.length)||0})]}),n.jsxs("button",{onClick:ne,className:"text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-1",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Milestone"]})]}),n.jsxs("div",{className:"space-y-3",children:[Te&&n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:n.jsxs("div",{className:"space-y-3",children:[n.jsx("input",{type:"text",placeholder:"Enter milestone description...",value:nt,onChange:I=>ut(I.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.jsx(zr,{className:"w-4 h-4 text-gray-500"}),n.jsx("input",{type:"date",value:at,onChange:I=>ce(I.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:ie,className:"px-4 py-2 text-white rounded-lg text-sm font-medium",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:"Save"}),n.jsx("button",{onClick:me,className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg text-sm font-medium hover:bg-gray-200 dark:hover:bg-gray-600",children:"Cancel"})]})]})]})}),(((ec=j.milestones)==null?void 0:ec.length)||0)===0&&!Te?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("p",{children:"No milestones set for this goal yet."}),n.jsx("p",{className:"text-sm",children:"Add milestones to track major achievements!"})]}):(j.milestones||[]).sort((I,se)=>I.order-se.order).map((I,se)=>n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 hover:shadow-sm transition-shadow",children:[n.jsx("div",{onClick:()=>ue(I.id),className:"cursor-pointer",children:n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("div",{onClick:Ae=>Xe(I.id,Ae),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors cursor-pointer hover:scale-110 ${I.completed?"border-green-500 text-white":"border-gray-300 hover:border-green-300"}`,style:I.completed?{backgroundColor:e.color}:{},children:I.completed&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 font-medium",children:[n.jsx(oa,{className:"w-4 h-4"}),n.jsxs("span",{children:["#",se+1]})]}),n.jsx("div",{className:"flex-1 font-semibold text-gray-800 dark:text-white",children:I.description}),I.dueDate&&n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Due ",re(I.dueDate)]})]})}),$e===I.id&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Created ",re(I.createdAt),I.completed&&I.completedAt&&n.jsxs("span",{children:["  Completed ",re(I.completedAt)]})]}),n.jsx("div",{className:"flex gap-2",children:n.jsxs("button",{onClick:()=>Pt(I.id),className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",children:[n.jsx(ft,{className:"w-4 h-4"}),"Delete"]})})]})]},I.id))]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[" Linked Tasks",n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:A.length}),A.length>0&&a&&n.jsx("button",{onClick:()=>a("tasks"),className:"transition-colors text-sm font-medium hover:opacity-80",style:_(),children:"View All "})]}),n.jsxs("button",{onClick:Pr,className:"text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-1",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Task"]})]}),n.jsx("div",{className:"space-y-3",children:A.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("p",{children:"No tasks linked to this goal yet."}),n.jsx("p",{className:"text-sm",children:"Add tasks to track your progress!"})]}):A.map(I=>n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 hover:shadow-sm transition-shadow",children:[n.jsxs("div",{onClick:()=>Jr(I.id),className:"cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("div",{onClick:se=>he(I.id,se),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors cursor-pointer hover:scale-110 ${I.status==="completed"?"bg-green-500 border-green-500 text-white":"border-gray-300 hover:border-green-300"}`,children:I.status==="completed"&&n.jsx("span",{className:"text-xs",children:""})}),n.jsx("div",{className:"flex-1 font-semibold text-gray-800 dark:text-white",children:I.name}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:I.status==="completed"?`Completed ${re(typeof I.updatedAt=="string"?I.updatedAt:I.updatedAt.toISOString())}`:I.dueDate?`Due ${re(typeof I.dueDate=="string"?I.dueDate:I.dueDate.toISOString())}`:"No due date"})]}),I.description&&n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 ml-8",children:I.description})]}),U===I.id&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-2",children:[n.jsxs("button",{onClick:()=>Ln(I),className:"flex items-center gap-2 px-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:[n.jsx(Hs,{className:"w-4 h-4"}),"Edit"]}),n.jsxs("button",{onClick:()=>pg(I.id),className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",children:[n.jsx(ft,{className:"w-4 h-4"}),"Delete"]})]})]},I.id))})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[" Supporting Habits",n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:X.length}),X.length>0&&a&&n.jsx("button",{onClick:()=>a("habits"),className:"transition-colors text-sm font-medium hover:opacity-80",style:_(),children:"View All "})]}),n.jsxs("button",{onClick:ye,className:"text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-1",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Habit"]})]}),n.jsx("div",{className:"space-y-3",children:X.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("p",{children:"No habits linked to this goal yet."}),n.jsx("p",{className:"text-sm",children:"Add habits to build consistency!"})]}):X.map(I=>{const se=h(I.id),Ae=u(I.id);return n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 hover:shadow-sm transition-shadow",children:[n.jsxs("div",{onClick:()=>Ar(I.id),className:"cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("div",{onClick:At=>Wt(I.id,At),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors cursor-pointer hover:scale-110 ${Ae?"bg-blue-500 border-blue-500 text-white":"border-blue-300 hover:border-blue-400"}`,children:Ae&&n.jsx("span",{className:"text-xs",children:""})}),n.jsx("div",{className:"flex-1 font-semibold text-gray-800 dark:text-white",children:I.name}),n.jsxs("div",{className:"text-xs font-semibold flex items-center gap-1",style:_(),children:[" ",se," day streak"]})]}),I.description&&n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 ml-8",children:I.description})]}),$===I.id&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-2",children:[n.jsxs("button",{onClick:()=>hg(I),className:"flex items-center gap-2 px-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:[n.jsx(Hs,{className:"w-4 h-4"}),"Edit"]}),n.jsxs("button",{onClick:()=>fg(I.id),className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",children:[n.jsx(ft,{className:"w-4 h-4"}),"Delete"]})]})]},I.id)})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[" Journal Notes",n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:gt.length})]}),n.jsxs("button",{onClick:E,className:"text-white px-4 py-2 rounded-lg text-sm font-semibold flex items-center gap-1",style:S(),onMouseEnter:I=>I.currentTarget.style.backgroundColor=w(),onMouseLeave:I=>I.currentTarget.style.backgroundColor=e.color,children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Note"]})]}),n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 border border-gray-200 dark:border-gray-700",children:n.jsx("div",{className:"space-y-3",children:gt.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("p",{children:"No journal entries for this goal yet."}),n.jsx("p",{className:"text-sm",children:"Add your first note to track your progress!"})]}):gt.map(I=>n.jsxs("div",{className:"p-4 border border-gray-100 dark:border-gray-700 rounded-xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-semibold",children:Sg(I.createdAt)}),I.mood&&n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[n.jsx("span",{className:"text-base",children:I.mood==="great"?"":I.mood==="good"?"":I.mood==="neutral"?"":I.mood==="low"?"":""}),n.jsx("span",{className:"capitalize",children:I.mood})]})]}),n.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:I.content}),I.tags.length>0&&n.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:I.tags.map(se=>n.jsxs("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs",children:["#",se]},se))})]},I.id))})})]})]}),n.jsx(Wl,{isOpen:G,onClose:xg,onSubmit:yg,editingTask:Y,defaultGoalId:j.id}),n.jsx(Gi,{isOpen:H,onClose:bg,editingHabit:ae,defaultGoalId:j.id}),n.jsx(qi,{isOpen:O,onClose:()=>q(!1),defaultGoalId:j.id})]})}function by({onNavigate:e}){const{goals:t,modalState:r,getFilteredGoals:a,openModal:s,closeModal:o,recalculateAllGoalProgress:i}=De(),[c,l]=N.useState(null),[d,h]=N.useState(!1),[u,f]=N.useState(null),g=a(),m=()=>{console.log("handleCreateGoal called, opening modal"),console.log("modalState before:",r),f(null),s(),console.log("openModal called")};N.useEffect(()=>{const x=()=>{console.log("openGoalModal event received, calling handleCreateGoal"),m()};return window.addEventListener("openGoalModal",x),()=>window.removeEventListener("openGoalModal",x)},[]),N.useEffect(()=>{t.length>0&&(console.log("GoalsPage: Recalculating progress for",t.length,"goals"),i())},[t.length,i]);const v=x=>{l(x),h(!0)},D=x=>{f(x),h(!1),s()},y=()=>{h(!1),l(null)},p=()=>{f(null),o()};return t.length===0?n.jsx(my,{}):d&&c?n.jsx(xy,{goal:c,onBack:y,onEdit:D,onNavigate:e}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Goals"}),n.jsxs("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:[g.length," of ",t.length," goals"]})]}),n.jsx("button",{onClick:m,className:"w-12 h-12 bg-gradient-to-r accent-gradient text-white rounded-2xl flex items-center justify-center shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:n.jsx(Dt,{className:"w-6 h-6"})})]}),n.jsx("div",{className:"space-y-4",children:g.map(x=>n.jsx(gy,{goal:x,viewMode:"list",onClick:()=>v(x)},x.id))}),n.jsx(ql,{isOpen:r.isOpen,onClose:p,goalToEdit:u})]})}function vy({onNavigate:e}){const{openModal:t,isModalOpen:r,closeModal:a,addTask:s}=Oe(),o=()=>{t()};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-3xl border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute top-2 right-8 text-2xl opacity-60 animate-pulse",children:""}),n.jsx("div",{className:"text-8xl mb-4 animate-bounce opacity-80",children:""})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"No Tasks Yet"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-8 max-w-md mx-auto",children:"Tasks are the building blocks of your goals. Create actionable items that move you closer to what you want to achieve."}),n.jsx("div",{className:"flex flex-col items-center gap-3 mb-6",children:n.jsx("button",{onClick:o,className:"flex items-center gap-2 px-8 py-4 accent-gradient text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:" Add Your First Task"})}),n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 mb-8",children:[n.jsx("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 text-center",children:" Task Examples"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("div",{className:"w-4 h-4 border border-gray-300 dark:border-gray-500 rounded"}),"Research gym memberships nearby"]}),n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("div",{className:"w-4 h-4 border border-gray-300 dark:border-gray-500 rounded"}),"Schedule doctor's appointment"]}),n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("div",{className:"w-4 h-4 border border-gray-300 dark:border-gray-500 rounded"}),"Buy groceries for meal prep"]}),n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("div",{className:"w-4 h-4 border border-gray-300 dark:border-gray-500 rounded"}),"Submit project proposal"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Break down complex projects"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Set due dates & reminders"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Link tasks to your goals"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Organize with sub-tasks"})]})]})]}),n.jsx(Wl,{isOpen:r,onClose:a,onSubmit:i=>{s(i),a()}})]})}function ky({isOpen:e,onClose:t,task:r,onDeleteSingle:a,onDeleteAll:s}){if(!e)return null;const o=r.isRecurring?"recurring task":"task instance",i=r.isRecurring?"":"";return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Repetitive Task"}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["This is a ",o]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-base",children:i}),n.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:r.name})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Do you want to delete just this occurrence or all iterations of this task?"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("button",{onClick:()=>{a(),t()},className:"w-full p-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors",children:"Just this occurrence"}),n.jsx("button",{onClick:()=>{s(),t()},className:"w-full p-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:"All iterations"}),n.jsx("button",{onClick:t,className:"w-full p-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})}const wy=[{id:"today",label:"Today",icon:zr},{id:"upcoming",label:"Upcoming",icon:Sr},{id:"repetitive",label:"Repetitive",icon:Xm},{id:"overdue",label:"Overdue",icon:Na},{id:"completed",label:"Done",icon:ch}];function jy({onNavigate:e}){const{tasks:t,currentFilter:r,isModalOpen:a,setFilter:s,openModal:o,closeModal:i,toggleTask:c,toggleSubtask:l,toggleShoppingItem:d,getFilteredTasks:h,getTasksBySection:u,getTaskCounts:f,addTask:g,updateTask:m,deleteTask:v,deleteSingleRecurringTask:D,deleteAllRecurringTasks:y,cleanupEmptySubtasks:p}=Oe(),{goals:x}=De(),[k,C]=N.useState(new Set),[T,b]=N.useState(null),[j,S]=N.useState(!1),[w,_]=N.useState(null),[M,F]=N.useState(!1),[G,L]=N.useState(null),[H,P]=N.useState(!1),[O,q]=N.useState(!0),[U,Z]=N.useState("added"),[$,R]=N.useState("general");N.useEffect(()=>{p(),setTimeout(()=>{P(!0),setTimeout(()=>{q(!1)},1e3)},500)},[p]),N.useEffect(()=>!H||O?void 0:sy("openTaskModal",()=>{console.log(" TasksPage: Opening modal from custom event (post-startup)"),o()}),[o,H,O]);const Y=h(),{today:oe,overdue:ae,upcoming:Pe,noDueDate:$e}=u(),Re=f(),Te=E=>{if(U==="priority"){const ne={urgent:0,high:1,medium:2,low:3};return[...E].sort((ie,me)=>{const ue=ne[ie.priority]??4,Xe=ne[me.priority]??4;return ue-Xe})}return[...E].sort((ne,ie)=>new Date(ie.createdAt).getTime()-new Date(ne.createdAt).getTime())},Ee=E=>{const ne=new Map;return E.forEach(ie=>{if(ie.goalId){const me=x.find(ue=>ue.id===ie.goalId);if(me){const ue=ie.goalId;ne.has(ue)||ne.set(ue,{goal:me,tasks:[]}),ne.get(ue).tasks.push(ie)}}}),Array.from(ne.values()).sort((ie,me)=>ie.goal.name.localeCompare(me.goal.name))},nt=$==="goals"?[...oe,...ae,...Pe,...$e]:[],ut=$==="goals"?Ee(nt):[],at=$==="goals"?nt.filter(E=>!E.goalId):[],ce=r!=="repetitive"?{today:Te(oe),overdue:Te(ae),upcoming:Te(Pe),noDueDate:Te($e)}:{today:oe,overdue:ae,upcoming:Pe,noDueDate:$e},mt=E=>{C(ne=>{const ie=new Set(ne);return ie.has(E)?ie.delete(E):ie.add(E),ie})},st=E=>{if(!E)return null;const ne=x.find(ie=>ie.id===E);return ne?ne.name:null},B=E=>{b(E),o()},V=E=>{const ne=t.find(ie=>ie.id===E);ne&&(ne.isRecurring||ne.originalTaskId)?(L(ne),F(!0)):(_(E),S(!0))},Q=()=>{w&&(v(w),_(null),S(!1))},A=()=>{_(null),S(!1)},X=()=>{G&&(D(G.id),L(null),F(!1))},re=()=>{if(G){const E=G.originalTaskId||G.id;y(E),L(null),F(!1)}};if(t.length===0)return n.jsx(vy,{onNavigate:e});const z=E=>{var Xe,Pt,Pr;const ne=k.has(E.id),ie=((Pt=(Xe=E.subtasks)==null?void 0:Xe.filter(ye=>ye.completed))==null?void 0:Pt.length)||0,me=((Pr=E.subtasks)==null?void 0:Pr.length)||0,ue=st(E.goalId);return n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-sm transition-shadow",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("button",{onClick:()=>c(E.id),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors mt-0.5 ${E.status==="completed"?"bg-green-500 border-green-500 text-white":"border-gray-300 hover-accent-border"}`,children:E.status==="completed"&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsx("h3",{className:`font-semibold text-gray-800 dark:text-white ${E.status==="completed"?"line-through text-gray-500 dark:text-gray-400":""}`,children:E.name}),n.jsxs("div",{className:"flex items-center gap-1",children:[(E.subtasks&&E.subtasks.length>0||E.type==="to-buy"&&E.shoppingItems&&E.shoppingItems.length>0)&&n.jsx("button",{onClick:()=>mt(E.id),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1",children:ne?n.jsx(zi,{className:"w-4 h-4"}):n.jsx(gn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>B(E),className:"text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors p-1",title:"Edit task",children:n.jsx(Tn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>V(E.id),className:"text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors p-1",title:"Delete task",children:n.jsx(ft,{className:"w-4 h-4"})})]})]}),E.description&&n.jsx("p",{className:`text-sm text-gray-600 dark:text-gray-300 mb-3 ${E.status==="completed"?"line-through":""}`,children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400",children:[E.type==="deadline"&&E.dueDate&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(zr,{className:"w-3 h-3"}),n.jsxs("span",{children:["Due ",new Date(E.dueDate).toLocaleDateString()]}),new Date(E.dueDate).toLocaleTimeString&&n.jsxs("span",{className:"text-xs opacity-75",children:["at ",new Date(E.dueDate).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})]}),E.priority&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${E.priority==="urgent"?"bg-red-500":E.priority==="high"?"bg-orange-500":E.priority==="medium"?"bg-yellow-500":"bg-green-500"}`}),n.jsx("span",{className:"capitalize",children:E.priority})]}),ue&&n.jsxs("button",{onClick:()=>e==null?void 0:e("goals"),className:"flex items-center gap-1 hover-accent-text-600 transition-colors",children:[n.jsx(oa,{className:"w-3 h-3"}),n.jsx("span",{children:ue})]}),E.subtasks&&E.subtasks.length>0&&n.jsx("div",{className:"flex items-center gap-1",children:n.jsxs("span",{children:[ie,"/",me," subtasks"]})}),E.type==="to-buy"&&E.shoppingItems&&E.shoppingItems.length>0&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-base",children:""}),n.jsxs("span",{children:[E.shoppingItems.filter(ye=>ye.completed).length,"/",E.shoppingItems.length," items"]})]})]}),ne&&E.subtasks&&E.subtasks.length>0&&n.jsx("div",{className:"mt-3 space-y-2",children:E.subtasks.map((ye,he)=>{const Wt=typeof ye=="string"?`${E.id}-${he}`:ye.id,Jr=typeof ye=="string"?ye:ye.name,Ar=typeof ye=="string"?!1:ye.completed;return n.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[n.jsx("button",{onClick:()=>l(E.id,Wt),className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${Ar?"bg-green-500 border-green-500 text-white":"border-gray-300 hover-accent-border"}`,children:Ar&&n.jsx("span",{className:"text-xs",children:""})}),n.jsx("span",{className:`text-sm ${Ar?"line-through text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"}`,children:Jr})]},Wt||`subtask-${E.id}-${he}`)})}),ne&&E.type==="to-buy"&&E.shoppingItems&&E.shoppingItems.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 ml-4 mb-2",children:"Shopping List:"}),E.shoppingItems.map((ye,he)=>n.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[n.jsx("button",{onClick:()=>d(E.id,ye.id),className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${ye.completed?"bg-green-500 border-green-500 text-white":"border-gray-300 hover-accent-border"}`,children:ye.completed&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("span",{className:`text-sm ${ye.completed?"line-through text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"}`,children:[ye.quantity&&`${ye.quantity} `,ye.name]})]},ye.id||`item-${E.id}-${he}`))]})]})]})},E.id)},te=()=>r==="repetitive"?null:n.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[r==="all"&&n.jsxs("button",{onClick:()=>R($==="general"?"goals":"general"),className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors border border-gray-300 dark:border-gray-600",children:[n.jsx(hh,{className:"w-3.5 h-3.5"}),n.jsxs("span",{children:["Group by: ",$==="general"?"General":"Goals"]}),n.jsx(gn,{className:"w-3 h-3"})]}),n.jsxs("button",{onClick:()=>Z(U==="added"?"priority":"added"),className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors border border-gray-300 dark:border-gray-600",children:[n.jsx(sh,{className:"w-3.5 h-3.5"}),n.jsxs("span",{children:["Sort by: ",U==="added"?"Added":"Priority"]}),n.jsx(gn,{className:"w-3 h-3"})]})]}),K=(E,ne,ie)=>{if(ne.length===0)return null;const me=ie;return n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(me,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:E}),n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:ne.length})]}),n.jsx("div",{className:"space-y-3",children:ne.map(ue=>z(ue))})]})},Fe=E=>{const{goal:ne,tasks:ie}=E,me=Te(ie);return n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:ne.color}}),n.jsx("span",{className:"text-lg",children:ne.icon}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:ne.name}),n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:ie.length})]}),n.jsx("div",{className:"space-y-3",children:me.map(ue=>z(ue))})]},ne.id)},ke=E=>{const ne=E.filter(me=>{var ue;return(ue=me._repetitiveGroup)==null?void 0:ue.isUpcoming}),ie=new Map;return E.forEach(me=>{var ue,Xe;if(!((ue=me._repetitiveGroup)!=null&&ue.isUpcoming)){const Pt=((Xe=me._repetitiveGroup)==null?void 0:Xe.monthGroup)||"No Due Date";ie.has(Pt)||ie.set(Pt,[]),ie.get(Pt).push(me)}}),n.jsxs("div",{className:"space-y-8",children:[ne.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(Sr,{className:"w-4 h-4 text-blue-500"}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Upcoming"}),n.jsx("span",{className:"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-md text-xs font-semibold",children:"Within 2 weeks"}),n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:ne.length})]}),n.jsx("div",{className:"space-y-3",children:ne.map(me=>gt(me))})]}),Array.from(ie.entries()).sort(([me],[ue])=>me==="No Due Date"?1:ue==="No Due Date"?-1:new Date(me+" 1, 2000").getTime()-new Date(ue+" 1, 2000").getTime()).map(([me,ue])=>n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(zr,{className:"w-4 h-4 text-purple-500"}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:me}),n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:ue.length})]}),n.jsx("div",{className:"space-y-3",children:ue.map(Xe=>gt(Xe))})]},me))]})},gt=E=>{var Pt,Pr,ye;const ne=k.has(E.id),ie=((Pr=(Pt=E.subtasks)==null?void 0:Pt.filter(he=>he.completed))==null?void 0:Pr.length)||0,me=((ye=E.subtasks)==null?void 0:ye.length)||0,ue=st(E.goalId),Xe=E._repetitiveGroup;return n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-sm transition-shadow",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("button",{onClick:()=>c(E.id),className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors mt-0.5 ${E.status==="completed"?"bg-green-500 border-green-500 text-white":"border-gray-300 hover-accent-border"}`,children:E.status==="completed"&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:`font-semibold text-gray-800 dark:text-white ${E.status==="completed"?"line-through text-gray-500 dark:text-gray-400":""}`,children:E.name}),n.jsx("div",{className:"flex items-center gap-2 mt-1",children:n.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[n.jsx(Xm,{className:"w-3 h-3 text-purple-500"}),n.jsxs("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:[E.recurrenceType,"  Next of ",(Xe==null?void 0:Xe.allInstances)||1," occurrences"]})]})})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[(E.subtasks&&E.subtasks.length>0||E.type==="to-buy"&&E.shoppingItems&&E.shoppingItems.length>0)&&n.jsx("button",{onClick:()=>mt(E.id),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1",children:ne?n.jsx(zi,{className:"w-4 h-4"}):n.jsx(gn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>B(E),className:"text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors p-1",title:"Edit task",children:n.jsx(Tn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>V(E.id),className:"text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors p-1",title:"Delete task",children:n.jsx(ft,{className:"w-4 h-4"})})]})]}),E.description&&n.jsx("p",{className:`text-sm text-gray-600 dark:text-gray-300 mb-3 ${E.status==="completed"?"line-through":""}`,children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400",children:[E.dueDate&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(zr,{className:"w-3 h-3"}),n.jsxs("span",{children:["Next: ",new Date(E.dueDate).toLocaleDateString()]})]}),E.priority&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${E.priority==="urgent"?"bg-red-500":E.priority==="high"?"bg-orange-500":E.priority==="medium"?"bg-yellow-500":"bg-green-500"}`}),n.jsx("span",{className:"capitalize",children:E.priority})]}),ue&&n.jsxs("button",{onClick:()=>e==null?void 0:e("goals"),className:"flex items-center gap-1 hover-accent-text-600 transition-colors",children:[n.jsx(oa,{className:"w-3 h-3"}),n.jsx("span",{children:ue})]}),E.subtasks&&E.subtasks.length>0&&n.jsx("div",{className:"flex items-center gap-1",children:n.jsxs("span",{children:[ie,"/",me," subtasks"]})}),E.type==="to-buy"&&E.shoppingItems&&E.shoppingItems.length>0&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-base",children:""}),n.jsxs("span",{children:[E.shoppingItems.filter(he=>he.completed).length,"/",E.shoppingItems.length," items"]})]})]}),ne&&E.subtasks&&E.subtasks.length>0&&n.jsx("div",{className:"mt-3 space-y-2",children:E.subtasks.map((he,Wt)=>{const Jr=typeof he=="string"?`${E.id}-${Wt}`:he.id,Ar=typeof he=="string"?he:he.name,Ln=typeof he=="string"?!1:he.completed;return n.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[n.jsx("button",{onClick:()=>l(E.id,Jr),className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${Ln?"bg-green-500 border-green-500 text-white":"border-gray-300 hover-accent-border"}`,children:Ln&&n.jsx("span",{className:"text-xs",children:""})}),n.jsx("span",{className:`text-sm ${Ln?"line-through text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"}`,children:Ar})]},Jr||`subtask-${E.id}-${Wt}`)})}),ne&&E.type==="to-buy"&&E.shoppingItems&&E.shoppingItems.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 ml-4 mb-2",children:"Shopping List:"}),E.shoppingItems.map((he,Wt)=>n.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[n.jsx("button",{onClick:()=>d(E.id,he.id),className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${he.completed?"bg-green-500 border-green-500 text-white":"border-gray-300 hover-accent-border"}`,children:he.completed&&n.jsx("span",{className:"text-xs",children:""})}),n.jsxs("span",{className:`text-sm ${he.completed?"line-through text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"}`,children:[he.quantity&&`${he.quantity} `,he.name]})]},he.id||`item-${E.id}-${Wt}`))]})]})]})},E.id)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Tasks"}),n.jsxs("button",{onClick:o,className:"accent-bg-500 hover-accent-bg-dark text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2 transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Task"]})]}),n.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:wy.map(({id:E,label:ne,icon:ie})=>n.jsxs("button",{onClick:()=>s(r===E?"all":E),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap ${r===E?"accent-bg-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[n.jsx(ie,{className:"w-4 h-4"}),ne,Re[E]>0&&n.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${r===E?"bg-white bg-opacity-20":"bg-gray-200 dark:bg-gray-600"}`,children:Re[E]})]},E))}),te(),n.jsxs("div",{children:[r==="all"&&$==="general"&&n.jsxs("div",{children:[K("Overdue",ce.overdue,Na),K("Today",ce.today,zr),K("Upcoming",ce.upcoming,Sr),K("No Due Date",ce.noDueDate,oa)]}),r==="all"&&$==="goals"&&n.jsxs("div",{children:[ut.map(E=>Fe(E)),at.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(Th,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),n.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"No Goal"}),n.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-md text-xs font-semibold",children:at.length})]}),n.jsx("div",{className:"space-y-3",children:Te(at).map(E=>z(E))})]})]}),r==="repetitive"&&n.jsx("div",{children:Y.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("p",{children:"No repetitive tasks found."}),n.jsx("p",{className:"text-sm mt-2",children:"Repetitive tasks will appear here when you create recurring tasks."})]}):ke(Y)}),r!=="all"&&r!=="repetitive"&&n.jsx("div",{className:"space-y-3",children:Y.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("p",{children:"No tasks found for this filter."})]}):Te(Y).map(E=>z(E))})]}),j&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Task"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Are you sure you want to delete this task? This action cannot be undone."}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:A,className:"flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),n.jsx("button",{onClick:Q,className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Delete"})]})]})}),n.jsx(ky,{isOpen:M,onClose:()=>{F(!1),L(null)},task:G,onDeleteSingle:X,onDeleteAll:re}),n.jsx(Wl,{isOpen:a,onClose:()=>{b(null),i()},onSubmit:E=>{if(T){const ne={name:E.name,description:E.description,type:E.type,priority:E.priority,dueDate:E.dueDate?new Date(E.dueDate):void 0,goalId:E.goalId||void 0,estimatedTime:E.estimatedTime?parseInt(E.estimatedTime.toString()):void 0,location:E.location||void 0,reminderTime:E.reminderTime?new Date(E.reminderTime):void 0,notes:E.notes||void 0,tags:E.tags||[],subtasks:E.subtasks,shoppingItems:E.shoppingItems,isRecurring:E.isRecurring||!1,recurrenceType:E.recurrenceType,recurrenceInterval:E.recurrenceInterval,recurrenceStartDate:E.recurrenceStartDate,recurrenceEndDate:E.recurrenceEndDate,addToCalendar:E.addToCalendar||!1,calendarStartTime:E.calendarStartTime,calendarDuration:E.calendarDuration,calendarDate:E.calendarDate,allDayTask:E.allDayTask||!1};m(T.id,ne)}else g(E);b(null),i()},editingTask:T})]})}function Ny({habit:e,selectedDate:t,onClick:r}){const{toggleDayCompletion:a,isHabitCompletedOnDate:s,isRequiredDay:o}=He(),{goals:i}=De(),c=Vl(e,i),d=(()=>{const u=t||new Date,f=new Date,g=[];for(let m=-4;m<=0;m++){const v=new Date(u);v.setDate(u.getDate()+m);const D=Ye(v),y=v.toDateString()===f.toDateString(),p=s(e.id,D),x=o(e.id,D),k=["Su","Mo","Tu","We","Th","Fr","Sa"];g.push({date:D,label:k[v.getDay()],isToday:y,isCompleted:p,isRequired:x})}return g})(),h=(u,f)=>{u.stopPropagation(),a(e.id,f)};return n.jsxs("div",{className:"flex items-center justify-between p-4 mb-3 bg-gray-700 rounded-2xl cursor-pointer hover:bg-gray-600 transition-all duration-200 w-full",onClick:r,style:{color:c},children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[n.jsx("div",{className:"w-5 h-5 flex items-center justify-center text-base flex-shrink-0",children:e.icon}),n.jsx("div",{className:"text-base font-medium truncate",style:{color:c},children:e.name})]}),n.jsx("div",{className:"flex gap-1.5 flex-shrink-0 ml-4",children:d.map(u=>n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:"text-xs text-gray-400 text-center mb-1 whitespace-nowrap",children:u.label}),n.jsx("div",{className:`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-200 cursor-pointer text-xs font-bold ${u.isCompleted?"text-white":"text-gray-400"} ${u.isToday?"border-[3px]":"border-2"} ${u.isRequired?"":"opacity-30"}`,style:{borderColor:c,backgroundColor:u.isCompleted?c:"transparent"},onClick:f=>h(f,u.date),children:u.isCompleted?"":""})]},u.date))})]})}function Sy({habit:e,isOpen:t,onClose:r,onEdit:a}){const{getHabitStreak:s,getCompletionRate:o,getTotalCompletions:i,getBestStreak:c,getMonthlyProgress:l,toggleDayCompletion:d,deleteHabit:h,isHabitCompletedOnDate:u}=He(),{goals:f}=De(),[g,m]=N.useState(!1),[v,D]=N.useState(new Date);if(!t||!e)return null;const y=Vl(e,f),p=s(e.id),x=()=>{h(e.id),r()},k=()=>{a(e),r()},C=(L,H)=>{H||d(e.id,L)},T=L=>{D(H=>{const P=new Date(H);return L==="prev"?P.setMonth(H.getMonth()-1):P.setMonth(H.getMonth()+1),P})},b=L=>{if(e.frequency!=="weekly"||!e.selectedDays)return!1;const P=["sun","mon","tue","wed","thu","fri","sat"][L.getDay()];return e.selectedDays.includes(P)},S=(()=>{const L=new Date;L.setHours(0,0,0,0);const H=v.getFullYear(),P=v.getMonth(),O=new Date(H,P,1),U=new Date(H,P+1,0).getDate(),Z=O.getDay(),$=[];for(let R=0;R<Z;R++)$.push(null);for(let R=1;R<=U;R++){const Y=new Date(H,P,R),oe=Ye(Y),ae=u(e.id,oe),Pe=oe===Ye(L),$e=Y>L,Re=b(Y);$.push({day:R,dateStr:oe,isCompleted:ae,isToday:Pe,isFuture:$e,isRequiredDay:Re})}return $})(),_=["January","February","March","April","May","June","July","August","September","October","November","December"][v.getMonth()],M=v.getFullYear(),F=(L,H=.2)=>{const P=L.replace("#",""),O=parseInt(P.substr(0,2),16),q=parseInt(P.substr(2,2),16),U=parseInt(P.substr(4,2),16);return`rgba(${O}, ${q}, ${U}, ${H})`},G=()=>{switch(e.frequency){case"weekly":if(e.selectedDays){const L={mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",sun:"Sun"},H=["mon","tue","wed","thu","fri","sat","sun"];return`Weekly  ${e.selectedDays.sort((q,U)=>H.indexOf(q)-H.indexOf(U)).map(q=>L[q]).join(", ")}`}return"Weekly";case"daily":return"Daily";case"custom":return e.customFrequency?`${e.customFrequency.times}x per ${e.customFrequency.period}`:"Custom";default:return"Daily"}};return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:r}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white dark:bg-gray-800 rounded-t-3xl shadow-2xl transform transition-transform max-h-[90vh] overflow-y-auto",children:[n.jsx("div",{className:"flex justify-center pt-3 pb-2",children:n.jsx("div",{className:"w-12 h-1 bg-gray-300 dark:bg-gray-600 rounded-full"})}),n.jsxs("div",{className:"p-6 pb-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[n.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white text-2xl flex-shrink-0",style:{backgroundColor:y},children:e.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.name}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:e.description})]})]}),n.jsx("button",{onClick:r,className:"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex-shrink-0 ml-4",children:n.jsx(Bt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-1",style:{color:y},children:p}),n.jsx("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"CURRENT STREAK"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold mb-1",style:{color:y},children:G()}),n.jsx("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"FREQUENCY"})]})]})]}),n.jsxs("div",{className:"flex gap-3 px-6 pb-6",children:[n.jsxs("button",{onClick:k,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[n.jsx(Hs,{className:"w-5 h-5"}),"Edit Habit"]}),n.jsxs("button",{onClick:()=>m(!0),className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 border border-red-300 dark:border-red-600 text-red-600 dark:text-red-400 rounded-xl font-semibold hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[n.jsx(ft,{className:"w-5 h-5"}),"Delete"]})]}),n.jsxs("div",{className:"px-6 pb-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Progress Calendar"}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("button",{onClick:()=>T("prev"),className:"w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:n.jsx(uh,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[_," ",M]}),n.jsx("button",{onClick:()=>T("next"),className:"w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:n.jsx(Bi,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})]}),n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-2xl p-4",children:[n.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(L=>n.jsx("div",{className:"text-center text-xs font-medium text-gray-600 dark:text-gray-400 py-2",children:L},L))}),n.jsx("div",{className:"grid grid-cols-7 gap-1",children:S.map((L,H)=>{if(!L)return n.jsx("div",{className:"aspect-square"},H);let P="aspect-square rounded-lg text-sm font-medium transition-all ";const O={};return L.isCompleted?(P+="text-white border-2 border-opacity-100",O.backgroundColor=y,O.borderColor=y):L.isToday?(P+="bg-white dark:bg-gray-600 border-2 border-dashed text-gray-900 dark:text-white",O.borderColor=y):L.isFuture?P+="bg-gray-100 dark:bg-gray-800 text-gray-300 dark:text-gray-600 cursor-not-allowed":L.isRequiredDay?(P+="text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-500 hover:scale-105",O.backgroundColor=F(y,.15)):P+="bg-white dark:bg-gray-600 text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-500 hover:scale-105",n.jsx("button",{onClick:()=>C(L.dateStr,L.isFuture),disabled:L.isFuture,className:P,style:O,children:n.jsx("span",{className:"text-sm font-bold",children:L.day})},H)})})]})]}),g&&n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center p-6",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-sm",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Habit"}),n.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-2 px-4 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),n.jsx("button",{onClick:x,className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors",children:"Delete"})]})]})})]})]})}const ts=[{text:"We are what we repeatedly do. Excellence, then, is not an act, but a habit.",author:"Aristotle"},{text:"The chains of habit are too weak to be felt until they are too strong to be broken.",author:"Samuel Johnson"},{text:"First we make our habits, then our habits make us.",author:"John Dryden"},{text:"Success is the sum of small efforts repeated day in and day out.",author:"Robert Collier"},{text:"You'll never change your life until you change something you do daily.",author:"Mike Murdock"}];function Cy({onCreateHabit:e}){const[t,r]=N.useState(0);return N.useEffect(()=>{const a=setInterval(()=>{r(s=>(s+1)%ts.length)},4e3);return()=>clearInterval(a)},[]),n.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-3xl border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute top-2 right-8 text-2xl opacity-60 animate-pulse",children:""}),n.jsx("div",{className:"text-8xl mb-4 animate-bounce opacity-80",children:""})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"No Habits Yet"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-8 max-w-md mx-auto",children:"Habits are the compound interest of personal development. Small daily actions that build up to extraordinary results over time."}),n.jsx("div",{className:"flex flex-col items-center gap-3 mb-6",children:n.jsx("button",{onClick:e,className:"flex items-center gap-2 px-8 py-4 accent-gradient text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:" Start Your First Habit"})}),n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 mb-8",children:[n.jsx("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3 text-center",children:" Habit Ideas"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Morning workout - 30 minutes"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Daily reading - 20 minutes"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Drink 8 glasses of water"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Evening meditation - 10 minutes"]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 rounded-2xl p-5 text-white text-center mb-6",children:[n.jsxs("div",{className:"text-base italic mb-2 opacity-90 transition-all duration-500 animate-fade-in",children:['"',ts[t].text,'"']},t),n.jsxs("div",{className:"text-xs opacity-70",children:[" ",ts[t].author]})]}),n.jsx("div",{className:"flex justify-center gap-2",children:ts.map((a,s)=>n.jsx("button",{onClick:()=>r(s),className:`w-2 h-2 rounded-full transition-all duration-300 ${s===t?"accent-bg-500 scale-125":"bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500"}`,style:s===t?{backgroundColor:"var(--accent-color, #FF7101)"}:{}},s))})]})}function Dy({onNavigate:e}){const{habits:t}=He(),[r,a]=N.useState(!1),[s,o]=N.useState(!1),[i,c]=N.useState(null),[l,d]=N.useState(null),[h,u]=N.useState(new Date),f=T=>{const b=t.find(j=>j.id===T);b&&(c(b),o(!0))},g=T=>{d(T),a(!0)},m=()=>{o(!1),c(null)},v=()=>{a(!1),d(null)},D=()=>{a(!0)};if(N.useEffect(()=>{const T=()=>{D()};return window.addEventListener("openHabitModal",T),()=>window.removeEventListener("openHabitModal",T)},[]),t.length===0)return n.jsxs(n.Fragment,{children:[n.jsx(Cy,{onCreateHabit:D}),r&&n.jsx(Gi,{isOpen:r,onClose:v,editingHabit:l})]});const y=()=>{const T=[],b=new Date;for(let j=-3;j<=3;j++){const S=new Date(h);S.setDate(h.getDate()+j),T.push({date:S,dayName:["Su","Mo","Tu","We","Th","Fr","Sa"][S.getDay()],dayNumber:S.getDate(),isToday:S.toDateString()===b.toDateString(),isSelected:S.toDateString()===h.toDateString()})}return T},p=()=>{const T={weekday:"long",month:"long",day:"numeric"};return h.toLocaleDateString("en-US",T)},x=T=>{u(T)},k=y(),C=p();return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Habits"}),n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("button",{onClick:D,className:"accent-bg-500 hover-accent-bg-dark text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2 transition-colors",children:[n.jsx(Dt,{className:"w-4 h-4"}),"Add Habit"]})})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-medium mb-4 text-gray-900 dark:text-white",children:C}),n.jsx("div",{className:"overflow-x-auto",children:n.jsx("div",{className:"flex gap-2 justify-center min-w-max px-4",children:k.map((T,b)=>n.jsxs("div",{className:`text-center py-2 px-3 rounded-lg text-sm font-medium cursor-pointer transition-all ${T.isSelected?"accent-bg-500 text-white":T.isToday?"accent-bg-100 accent-text-500 border border-current":"text-gray-400 hover:text-gray-300 hover:bg-gray-800"} min-w-[48px]`,onClick:()=>x(T.date),children:[n.jsx("div",{children:T.dayName}),n.jsx("div",{children:T.dayNumber})]},b))})})]}),n.jsx("div",{children:n.jsx("div",{className:"space-y-3",children:t.map(T=>n.jsx(Ny,{habit:T,selectedDate:h,onClick:()=>f(T.id)},T.id))})}),r&&n.jsx(Gi,{isOpen:r,onClose:v,editingHabit:l}),n.jsx(Sy,{habit:i,isOpen:s,onClose:m,onEdit:g})]})}const Ad=[{id:"focus",icon:"",name:"Focus Work",desc:"Deep work session"},{id:"meeting",icon:"",name:"Meeting",desc:"Scheduled meetings"},{id:"learning",icon:"",name:"Learning",desc:"Study & courses"},{id:"break",icon:"",name:"Break",desc:"Rest & recharge"},{id:"creative",icon:"",name:"Creative",desc:"Creative work"},{id:"admin",icon:"",name:"Admin",desc:"Administrative tasks"}],Ty=["","","","","","","","","","","",""],Uo=["linear-gradient(135deg, #FF7101, #e55a00)","linear-gradient(135deg, #3B82F6, #1E40AF)","linear-gradient(135deg, #22C55E, #15803D)","linear-gradient(135deg, #A855F7, #7C3AED)","linear-gradient(135deg, #EF4444, #DC2626)","linear-gradient(135deg, #F59E0B, #D97706)","linear-gradient(135deg, #8B5CF6, #7C3AED)","linear-gradient(135deg, #06B6D4, #0891B2)"],Md=[{value:30,label:"30 minutes"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"},{value:150,label:"2.5 hours"},{value:180,label:"3 hours"},{value:240,label:"4 hours"}];function qs({isOpen:e,onClose:t,prefilledTime:r,prefilledDate:a,editingTimeBlock:s}){Ul(()=>{e&&t()},e);const{addTimeBlock:o,updateTimeBlock:i,checkTimeConflict:c}=yt(),[l,d]=N.useState(!1),[h,u]=N.useState(!1),[f,g]=N.useState(!1),[m,v]=N.useState({title:"",description:"",date:"",startTime:"",durationMinutes:120,blockType:"focus",icon:"",color:Uo[0],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,recurrenceEndDate:""}),[D,y]=N.useState(""),[p,x]=N.useState(!1),[k,C]=N.useState("idle"),[T,b]=N.useState(""),[j,S]=N.useState(!1);N.useEffect(()=>{e||(C("idle"),b(""),S(!1))},[e]),N.useEffect(()=>{e&&(s?(v({title:s.title,description:s.description||"",date:s.date,startTime:s.startTime,durationMinutes:s.durationMinutes,blockType:s.blockType,icon:s.icon,color:s.color,isRecurring:s.isRecurring||!1,recurrenceType:s.recurrenceType||"weekly",recurrenceInterval:s.recurrenceInterval||1,recurrenceEndDate:s.recurrenceEndDate||""}),s.isRecurring&&g(!0),(s.description||s.linkedItemType)&&u(!0),Md.find(q=>q.value===s.durationMinutes)||(x(!0),y(s.durationMinutes.toString()))):v({title:"",description:"",date:a||new Date().toISOString().split("T")[0],startTime:r||"09:00",durationMinutes:120,blockType:"focus",icon:"",color:Uo[0],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,recurrenceEndDate:""}),d(!1),s||(u(!1),g(!1),x(!1),y("")))},[e,r,a,s]);const w=()=>!(!m.title.trim()||!m.date||!m.startTime||m.durationMinutes<15||c(m.date,m.startTime,m.durationMinutes,s==null?void 0:s.id)),_=N.useCallback(async()=>{if(!(!w()||j)){S(!0),C("saving"),b("");try{s?await i(s.id,m):await o(m),C("saved"),setTimeout(()=>{t(),C("idle"),S(!1)},800)}catch(P){console.error("TimeBlockModal: Save failed:",P),C("error"),b(P instanceof Error?P.message:"Failed to save timeblock. Please try again."),S(!1)}}},[m,s,w,o,i,t,j]),M=P=>{const O=Ad.find(q=>q.id===P);O&&v({...m,blockType:P,icon:O.icon,title:m.title||O.name})},F=P=>{P==="custom"?x(!0):(x(!1),v({...m,durationMinutes:parseInt(P)}))},G=P=>{y(P);const O=P.match(/^(\d{1,2}):([0-5]\d)$/);if(O){const q=parseInt(O[1]),U=parseInt(O[2]),Z=q*60+U;Z>=15&&Z<=480&&v({...m,durationMinutes:Z})}},L=()=>{if(!m.startTime||!m.durationMinutes)return"";const[P,O]=m.startTime.split(":").map(Number),q=P*60+O+m.durationMinutes,U=Math.floor(q/60)%24,Z=q%60;return`${U.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}`},H=P=>{const O=Math.floor(P/60),q=P%60;return O>0&&q>0?`${O}h ${q}m`:O>0?`${O}h`:`${q}m`};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-3 pb-24 sm:p-4 md:p-5",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl w-full max-w-sm sm:max-w-md md:max-w-lg max-h-full overflow-hidden shadow-xl animate-in slide-in-from-bottom-4 duration-300 text-gray-900 dark:text-white",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s?"Edit Time Block":"Create Time Block"}),n.jsx("button",{onClick:t,className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-300 transition-colors",children:""})]}),n.jsxs("div",{className:"p-6 max-h-[calc(100vh-240px)] overflow-y-auto space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Block Type"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ad.map(P=>n.jsxs("button",{onClick:()=>M(P.id),className:`flex flex-col items-center gap-2 p-4 border-2 rounded-xl transition-all text-center ${m.blockType===P.id?"accent-border-500 accent-bg-50 accent-text-600":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 hover:-translate-y-0.5 text-gray-600 dark:text-gray-300"}`,children:[n.jsx("span",{className:"text-2xl",children:P.icon}),n.jsx("div",{className:"font-semibold text-sm",children:P.name}),n.jsx("div",{className:"text-xs text-gray-500",children:P.desc})]},P.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Title *"}),n.jsx("input",{type:"text",value:m.title,onChange:P=>v({...m,title:P.target.value}),placeholder:"What will you work on?",inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 border-2 border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Description"}),n.jsx("textarea",{value:m.description,onChange:P=>v({...m,description:P.target.value}),placeholder:"Add details about this time block...",rows:3,inputMode:"text",spellCheck:"true",autoCorrect:"on",autoComplete:"off",className:"w-full p-3 border-2 border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border transition-colors resize-none bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Date *"}),n.jsx("input",{type:"date",value:m.date,onChange:P=>v({...m,date:P.target.value}),className:"w-full p-3 border-2 border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Start Time *"}),n.jsx("input",{type:"time",value:m.startTime,onChange:P=>v({...m,startTime:P.target.value}),className:"w-full p-3 border-2 border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Duration *"}),n.jsxs("div",{className:"flex gap-3 items-center",children:[n.jsxs("select",{value:p?"custom":m.durationMinutes.toString(),onChange:P=>F(P.target.value),className:"flex-1 p-3 border-2 border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[Md.map(P=>n.jsx("option",{value:P.value,children:P.label},P.value)),n.jsx("option",{value:"custom",children:"Custom time"})]}),p&&n.jsx("input",{type:"text",value:D,onChange:P=>G(P.target.value),placeholder:"2:30",pattern:"[0-9]:[0-5][0-9]",className:"w-20 p-3 border-2 border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border transition-colors text-center bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Visual"}),n.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-5 items-start",children:[n.jsxs("div",{className:"flex flex-col items-center gap-3",children:[n.jsx("div",{onClick:()=>d(!l),className:"w-20 h-20 rounded-2xl flex items-center justify-center text-3xl text-white cursor-pointer transition-all hover:scale-105",style:{background:m.color},children:m.icon}),l&&n.jsx("div",{className:"grid grid-cols-6 gap-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:Ty.map(P=>n.jsx("button",{onClick:()=>{v({...m,icon:P}),d(!1)},className:"w-10 h-10 bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg flex items-center justify-center text-lg transition-colors",children:P},P))})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2",children:"COLOR"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:Uo.map(P=>n.jsx("button",{onClick:()=>v({...m,color:P}),className:`w-10 h-10 rounded-lg transition-all ${m.color===P?"scale-110 ring-2 ring-gray-400":"hover:scale-105"}`,style:{background:P}},P))})]})]})]}),n.jsxs("div",{children:[n.jsxs("button",{onClick:()=>u(!h),className:"flex items-center gap-3 w-full p-3 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsx("span",{className:"font-semibold",children:"Advanced Options"}),n.jsx("span",{className:`ml-auto transition-transform ${h?"rotate-90":""}`,children:""})]}),h&&n.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Reminder"}),n.jsxs("select",{value:m.reminderMinutes||"",onChange:P=>v({...m,reminderMinutes:P.target.value?parseInt(P.target.value):void 0}),className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[n.jsx("option",{value:"",children:"No reminder"}),n.jsx("option",{value:"15",children:"15 minutes before"}),n.jsx("option",{value:"30",children:"30 minutes before"}),n.jsx("option",{value:"45",children:"45 minutes before"}),n.jsx("option",{value:"60",children:"1 hour before"})]})]})})]}),n.jsxs("div",{children:[n.jsxs("button",{onClick:()=>g(!f),className:"flex items-center gap-3 w-full p-3 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[n.jsx("span",{className:"text-lg",children:""}),n.jsx("span",{className:"font-semibold",children:"Repeat Event"}),n.jsx("span",{className:`ml-auto transition-transform ${f?"rotate-90":""}`,children:""})]}),f&&n.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"Enable Repeat"}),n.jsx("button",{type:"button",onClick:()=>v({...m,isRecurring:!m.isRecurring}),className:`relative w-12 h-6 rounded-full transition-colors ${m.isRecurring?"bg-orange-500":"bg-gray-300 dark:bg-gray-600"}`,children:n.jsx("div",{className:`absolute w-5 h-5 bg-white rounded-full transition-transform top-0.5 ${m.isRecurring?"translate-x-6":"translate-x-0.5"}`})})]}),m.isRecurring&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Repeat"}),n.jsxs("select",{value:m.recurrenceType,onChange:P=>v({...m,recurrenceType:P.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[n.jsx("option",{value:"weekly",children:"Weekly"}),n.jsx("option",{value:"monthly",children:"Monthly"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:["Every ",m.recurrenceType==="weekly"?"week(s)":"month(s)"]}),n.jsx("input",{type:"number",min:"1",max:"12",value:m.recurrenceInterval,onChange:P=>v({...m,recurrenceInterval:parseInt(P.target.value)||1}),className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"End Date (Optional)"}),n.jsx("input",{type:"date",value:m.recurrenceEndDate,onChange:P=>v({...m,recurrenceEndDate:P.target.value}),className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus-accent-border bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),n.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[n.jsx("div",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300 mb-1",children:"Repeat Preview"}),n.jsxs("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Repeats every ",m.recurrenceInterval," ",m.recurrenceType==="weekly"?"week":"month",m.recurrenceInterval>1?"s":"",m.recurrenceEndDate&&` until ${new Date(m.recurrenceEndDate).toLocaleDateString()}`]})]})]})]})]}),n.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[n.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wide mb-2",children:"Preview"}),n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg text-white",style:{background:m.color},children:[n.jsx("span",{className:"text-xl",children:m.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-semibold",children:m.title||"New Time Block"}),n.jsxs("div",{className:"text-sm opacity-90",children:[m.startTime," - ",L()," (",H(m.durationMinutes),")"]})]})]}),c(m.date,m.startTime,m.durationMinutes,s==null?void 0:s.id)&&n.jsxs("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400 flex items-center gap-2",children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Time conflict detected with existing time block"})]})]}),T&&n.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:n.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm font-medium",children:T})}),n.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[n.jsx("button",{onClick:t,className:"flex-1 p-3 border border-gray-300 dark:border-gray-700 rounded-lg font-semibold text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),n.jsxs("button",{onClick:_,disabled:!w()||k==="saving"||j,className:`flex-1 p-3 rounded-lg font-semibold transition-all ${w()&&k!=="saving"?k==="saved"?"bg-green-500 hover:bg-green-600 text-white":k==="error"?"bg-red-500 hover:bg-red-600 text-white":"accent-bg-500 hover-accent-bg-dark text-white hover:-translate-y-0.5 shadow-lg":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,children:[k==="saving"&&" Saving...",k==="saved"&&" Saved!",k==="error"&&" Try Again",k==="idle"&&(s?" Update Time Block":" Create Time Block")]})]})]})]})}):null}function Ey(e,t){return Ay(t.startTime,t.duration),{title:e.name,description:e.description||"",date:Yl(t.selectedDate),startTime:t.startTime,durationMinutes:t.duration,type:My(e.type),color:Fy(e.priority),icon:Ly(e.type),recurring:!1,notes:Oy(e)}}function Iy(e,t){const r=[],a=Ry(t.startDate,t.duration,t.endDate),s=By(e,a);for(const o of s)r.push({title:e.name,description:e.description||_y(e),date:Yl(o),startTime:t.preferredTime,durationMinutes:t.estimatedDuration,type:"personal",color:e.color||"#34C759",icon:e.icon||"",recurring:!0,notes:$y(e)});return r}function Py(e,t,r,a){const s=`${e.toString().padStart(2,"0")}:00`;return{selectedTime:s,selectedDate:t,quickTasks:r.filter(o=>!o.addToCalendar&&o.status==="pending").slice(0,5),quickHabits:a.filter(o=>zy(o,t)).slice(0,3),defaultTimeBlock:{title:"",description:"",date:Yl(t),startTime:s,durationMinutes:60,type:"work",color:"var(--accent-color, #FF7101)",icon:"",recurring:!1,notes:""}}}function Ay(e,t){const[r,a]=e.split(":").map(Number),s=r*60+a+t,o=Math.floor(s/60)%24,i=s%60;return`${o.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}function Yl(e){const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}function My(e){switch(e){case"deadline":return"work";case"to-buy":return"personal";default:return"work"}}function Fy(e){return{1:"#FF3B30",2:"#FF9500",3:"#007AFF",4:"#34C759",5:"#8E8E93"}[e]||"#007AFF"}function Ly(e){return{standard:"","to-buy":"",deadline:""}[e]||""}function Oy(e){let t="";return e.estimatedTime&&(t+=`Estimated time: ${e.estimatedTime} minutes
`),e.location&&(t+=`Location: ${e.location}
`),e.notes&&(t+=`Notes: ${e.notes}
`),e.tags.length>0&&(t+=`Tags: ${e.tags.join(", ")}`),t.trim()}function _y(e){return e.measurementType==="time"&&e.targetAmount?`${e.targetAmount} ${e.targetUnit||"minutes"}`:e.measurementType==="count"&&e.targetAmount?`${e.targetAmount} ${e.targetUnit||"times"}`:e.description||"Daily habit"}function $y(e){let t="";return e.measurementType==="time"&&e.targetAmount?t+=`Target: ${e.targetAmount} ${e.targetUnit||"minutes"}
`:e.measurementType==="count"&&e.targetAmount&&(t+=`Target: ${e.targetAmount} ${e.targetUnit||"times"}
`),e.frequency==="weekly"&&e.selectedDays&&(t+=`Days: ${e.selectedDays.join(", ")}
`),e.streak>0&&(t+=`Current streak: ${e.streak} days`),t.trim()}function Ry(e,t,r){const a=new Date(e);let s;switch(t){case"week":s=new Date(a),s.setDate(a.getDate()+7);break;case"month":s=new Date(a),s.setMonth(a.getMonth()+1);break;case"custom":s=r||new Date(a.getTime()+30*24*60*60*1e3);break}return{start:a,end:s}}function By(e,t){const r=[];if(e.frequency==="daily")for(let a=new Date(t.start);a<=t.end;a.setDate(a.getDate()+1))r.push(new Date(a));else if(e.frequency==="weekly"&&e.selectedDays){const a={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},s=e.selectedDays.map(o=>a[o]).filter(o=>o!==void 0);for(let o=new Date(t.start);o<=t.end;o.setDate(o.getDate()+1))s.includes(o.getDay())&&r.push(new Date(o))}else if(e.frequency==="custom"&&e.customFrequency){let a=new Date(t.start);const s=e.customFrequency.period==="week"?7:30,o=e.customFrequency.times;for(;a<=t.end;)for(let i=0;i<o&&a<=t.end;i++)r.push(new Date(a)),a.setDate(a.getDate()+Math.floor(s/o))}return r}function zy(e,t){if(e.frequency==="daily")return!0;if(e.frequency==="weekly"&&e.selectedDays){const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()];return e.selectedDays.includes(a)}return!0}const Wi={orange:"#FF7101",blue:"#06B6D4",green:"#10B981",purple:"#8B5CF6",red:"#DC2626",yellow:"#F59E0B"};function co(e){return Wi[e]||Wi.orange}function Hy(e){return`var(--accent-color, ${co(e)})`}const Gy=Object.freeze(Object.defineProperty({__proto__:null,ACCENT_COLOR_VALUES:Wi,getAccentColorCSS:Hy,getAccentColorValue:co},Symbol.toStringTag,{value:"Module"}));function Uy({isOpen:e,onClose:t,selectedTime:r,selectedDate:a}){const{addTimeBlock:s}=yt(),{tasks:o,updateTask:i}=Oe(),{habits:c,updateHabit:l}=He(),{getAccentColor:d}=ar(),h=co(d()),u=b=>{const j=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return j?{r:parseInt(j[1],16),g:parseInt(j[2],16),b:parseInt(j[3],16)}:null},[f,g]=N.useState(null),[m,v]=N.useState(null),[D,y]=N.useState(null),[p,x]=N.useState(!1),k=Py(parseInt(r.split(":")[0]),a,o,c),C=b=>{const j={selectedDate:a,startTime:r,duration:b.estimatedTime||60},S=Ey(b,j);s(S),i(b.id,{addToCalendar:!0,calendarStartTime:r,calendarDuration:j.duration,dueDate:a}),t()},T=b=>{const j={startDate:a,duration:"week",preferredTime:r,estimatedDuration:Fd(b),enableReminders:b.reminderMinutes!==void 0,reminderMinutes:b.reminderMinutes||15},w=Iy(b,j).find(_=>_.date===k.defaultTimeBlock.date);w&&s(w),l(b.id,{calendarIntegration:!0,scheduledTime:r}),t()};return e?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-end justify-center z-50",onClick:t,children:n.jsxs("div",{className:"bg-gray-800 w-full max-w-md rounded-t-2xl p-6 transform transition-transform max-h-[80vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[n.jsx("div",{className:"w-12 h-1 bg-gray-600 rounded-full mx-auto mb-6"}),n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold text-white",children:"Quick Add"}),n.jsxs("p",{className:"text-gray-400 text-sm",children:[r,"  ",a.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]})]}),n.jsx("button",{onClick:t,className:"w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center text-gray-300 hover:bg-gray-600",children:""})]}),n.jsxs("div",{className:"space-y-4",children:[k.quickTasks.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[n.jsx("span",{className:"text-blue-400",children:""}),"Link Existing Task"]}),n.jsx("div",{className:"space-y-2",children:k.quickTasks.map(b=>n.jsx("button",{onClick:()=>C(b),className:"w-full p-3 bg-gray-700 hover:bg-gray-600 rounded-lg text-left transition-colors",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:b.type==="to-buy"?"":""}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-white font-medium",children:b.name}),n.jsx("p",{className:"text-gray-400 text-sm",children:b.estimatedTime?`${b.estimatedTime} min`:"No time estimate"})]}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Priority ",b.priority]})]})},b.id))})]}),k.quickHabits.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[n.jsx("span",{className:"text-green-400",children:""}),"Link Existing Habit"]}),n.jsx("div",{className:"space-y-2",children:k.quickHabits.map(b=>n.jsx("button",{onClick:()=>T(b),className:"w-full p-3 bg-gray-700 hover:bg-gray-600 rounded-lg text-left transition-colors",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:b.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-white font-medium",children:b.name}),n.jsxs("p",{className:"text-gray-400 text-sm",children:[b.frequency," ",b.measurementType==="time"&&b.targetAmount?` ${b.targetAmount} ${b.targetUnit||"min"}`:` ${Fd(b)} min estimated`]})]})]})},b.id))})]}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[n.jsx("span",{style:{color:h},children:""}),"Create Time Block"]}),n.jsx("button",{onClick:()=>x(!0),className:"w-full p-4 rounded-lg text-left transition-colors",style:{backgroundColor:h+"33",borderColor:h+"4D",border:"1px solid"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=h+"4D"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=h+"33"},children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("div",{children:[n.jsx("p",{className:"text-white font-medium",children:"New Time Block"}),n.jsx("p",{className:"text-sm",style:{color:h+"CC"},children:"Schedule focused work time"})]})]})})]}),n.jsxs("div",{children:[n.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[n.jsx("span",{className:"text-purple-400",children:""}),"Quick Presets"]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{title:"Meeting",icon:"",duration:60,type:"work"},{title:"Break",icon:"",duration:15,type:"personal"},{title:"Focus Time",icon:"",duration:90,type:"work"},{title:"Exercise",icon:"",duration:45,type:"health"}].map(b=>n.jsxs("button",{onClick:()=>{s({...k.defaultTimeBlock,title:b.title,icon:b.icon,durationMinutes:b.duration,type:b.type}),t()},className:"p-3 bg-gray-700 hover:bg-gray-600 rounded-lg text-center transition-colors",children:[n.jsx("div",{className:"text-lg mb-1",children:b.icon}),n.jsx("div",{className:"text-white text-sm font-medium",children:b.title}),n.jsxs("div",{className:"text-gray-400 text-xs",children:[b.duration," min"]})]},b.title))})]})]}),k.quickTasks.length===0&&k.quickHabits.length===0&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"text-4xl mb-4",children:""}),n.jsx("p",{className:"text-gray-400 mb-4",children:"No pending tasks or habits to link."}),n.jsx("button",{onClick:()=>x(!0),className:"px-6 py-2 text-white rounded-lg transition-colors",style:{backgroundColor:h},onMouseEnter:b=>{const j=u(h);j&&(b.currentTarget.style.backgroundColor=`rgb(${Math.max(0,j.r-20)}, ${Math.max(0,j.g-20)}, ${Math.max(0,j.b-20)})`)},onMouseLeave:b=>{b.currentTarget.style.backgroundColor=h},children:"Create Time Block"})]})]})}),n.jsx(qs,{isOpen:p,onClose:()=>{x(!1),t()},defaultDate:a,defaultStartTime:r})]}):null}function Fd(e){if(e.measurementType==="time"&&e.targetAmount)return e.targetAmount;switch(e.measurementType){case"count":return Math.max(15,(e.targetAmount||1)*5);case"simple":return 30;case"custom":return 45;default:return 30}}function qy({isOpen:e,onClose:t,event:r,actionType:a,onSingleAction:s,onSeriesAction:o}){if(!e)return null;const i=a==="delete"?"delete":"mark as complete",c=a==="delete"?"":"";return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-sm mx-4 border border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("span",{className:"text-2xl",children:c}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:a==="delete"?"Delete Event":"Complete Event"}),n.jsx("p",{className:"text-sm text-gray-400",children:"This is a recurring event"})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-base",children:r.icon}),n.jsx("span",{className:"text-white font-medium",children:r.title})]}),n.jsxs("p",{className:"text-sm text-gray-400",children:["Do you want to ",i," just this occurrence or the entire series?"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("button",{onClick:()=>{s(),t()},className:"w-full p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Just this occurrence"}),n.jsx("button",{onClick:()=>{o(),t()},className:`w-full p-3 text-white rounded-lg font-medium transition-colors ${a==="delete"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:"Entire series"}),n.jsx("button",{onClick:t,className:"w-full p-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"Cancel"})]})]})})}const Wy=({onTap:e,onLongPress:t,onSwipeLeft:r,threshold:a=600,swipeThreshold:s=80})=>{const o=N.useRef({isPressed:!1,startX:0,startY:0,currentX:0,currentY:0,longPressTriggered:!1,swipeTriggered:!1,startTime:0}),i=N.useRef(),c=N.useRef(null),l=N.useCallback(()=>{i.current&&(clearTimeout(i.current),i.current=void 0)},[]),d=N.useCallback(()=>{console.log(" Resetting gesture state"),l(),o.current={isPressed:!1,startX:0,startY:0,currentX:0,currentY:0,longPressTriggered:!1,swipeTriggered:!1,startTime:0},c.current=null},[l]);return{getEventHandlers:N.useCallback(u=>{const f=(v,D)=>{const y=Date.now();console.log(" Gesture Start:",u.title,`at ${y}`),c.current=u,o.current={isPressed:!0,startX:v,startY:D,currentX:v,currentY:D,longPressTriggered:!1,swipeTriggered:!1,startTime:y},console.log(" Gesture State Set:",o.current),i.current=setTimeout(()=>{const p=o.current,x=Math.abs(p.currentX-p.startX),k=Math.abs(p.currentY-p.startY);p.isPressed&&x<15&&k<15&&!p.swipeTriggered?(console.log(" Long Press Triggered:",u.title),o.current.longPressTriggered=!0,t(u)):console.log(" Long Press Cancelled - Movement too much or not pressed:",{isPressed:p.isPressed,deltaX:x,deltaY:k,swipeTriggered:p.swipeTriggered})},a)},g=(v,D)=>{const y=o.current;if(!y.isPressed)return;o.current.currentX=v,o.current.currentY=D;const p=v-y.startX,x=Math.abs(D-y.startY);if((Math.abs(p)>15||x>15)&&i.current&&(console.log(" Long Press Cancelled due to movement:",{deltaX:Math.abs(p),deltaY:x}),l()),x>30)return;const k=document.elementFromPoint(v,D);k&&p<-20&&(k.style.transform=`translateX(${Math.max(p,-100)}px)`,k.style.opacity=`${Math.max(.5,1+p/200)}`),p<-s&&!y.swipeTriggered&&!y.longPressTriggered&&(console.log(" Swipe Left Triggered:",u.title),o.current.swipeTriggered=!0,l(),r(u))},m=()=>{const v=o.current,{longPressTriggered:D,swipeTriggered:y,startTime:p,isPressed:x}=v,k=c.current,C=Date.now(),T=p>0?C-p:0;console.log(" Gesture End:",{event:(k==null?void 0:k.title)||"NO EVENT",duration:`${T}ms`,startTime:p,currentTime:C,isPressed:x,longPress:D,swipe:y}),l();const b=document.querySelector('[style*="translateX"]');if(b&&(b.style.transform="",b.style.opacity=""),!k||!x||p===0){console.log(" Invalid gesture state - no event, not pressed, or no start time"),d();return}if(T<10||T>5e3){console.log(" Duration out of reasonable range:",T+"ms"),d();return}y?console.log(" Swipe Completed:",k.title):D?console.log(" Long Press Completed:",k.title):T<a?(console.log(" Tap Triggered:",k.title,`(${T}ms)`),e(k)):console.log(" No gesture recognized:",k.title,`(${T}ms) - exceeded threshold: ${a}ms`),d()};return{onMouseDown:v=>{v.preventDefault(),f(v.clientX,v.clientY)},onMouseMove:v=>{g(v.clientX,v.clientY)},onMouseUp:m,onMouseLeave:m,onTouchStart:v=>{const D=v.touches[0];f(D.clientX,D.clientY)},onTouchMove:v=>{const D=v.touches[0];g(D.clientX,D.clientY)},onTouchEnd:m,onTouchCancel:m}},[e,t,r,a,s,l,d]),resetGestureState:d}};function Vy({selectedDate:e,onEventClick:t,onEmptySlotClick:r}){const{timeBlocks:a,getEventsForDate:s,toggleTimeBlockCompletion:o,deleteTimeBlock:i,isRecurringEvent:c,getOriginalEventId:l,toggleSingleRecurringCompletion:d,toggleRecurringSeriesCompletion:h,deleteSingleRecurringEvent:u,deleteRecurringSeries:f,navigatePrevious:g,navigateNext:m,setCurrentDate:v}=yt(),{tasks:D,toggleTask:y}=Oe(),{habits:p}=He(),{getAccentColor:x}=ar(),{goals:k,toggleMilestoneCompletion:C,triggerMilestoneJournalPrompt:T}=De(),b=co(x()),j=B=>{const V=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(B);return V?{r:parseInt(V[1],16),g:parseInt(V[2],16),b:parseInt(V[3],16)}:null},[S,w]=N.useState(!1),[_,M]=N.useState(null),[F,G]=N.useState(!1),[L,H]=N.useState(null),[P,O]=N.useState(!1),[q,U]=N.useState(null),[Z,$]=N.useState(null),[R,Y]=N.useState(!0),{allDayEvents:oe,timedEvents:ae}=N.useMemo(()=>{const B=s(e),V=e.toISOString().split("T")[0],Q=k.flatMap(K=>{var Fe;return((Fe=K.milestones)==null?void 0:Fe.filter(ke=>ke.dueDate===V).map(ke=>({id:`milestone-${ke.id}`,title:ke.description,description:`Goal: ${K.name}`,date:V,type:"milestone",icon:"",color:K.color,completed:ke.completed,allDay:!0,goalId:K.id,milestoneId:ke.id,startTime:"00:00",endTime:"23:59"})))||[]}),A=new Set,X=D.filter(K=>{if(!K.isRecurring&&!K.originalTaskId||!K.dueDate||(K.dueDate instanceof Date?K.dueDate.toISOString().split("T")[0]:K.dueDate.toString().split("T")[0])!==V)return!1;const ke=K.originalTaskId||K.id;return A.has(ke)||K.isRecurring&&!K.originalTaskId&&D.some(E=>E.originalTaskId===K.id&&E.dueDate&&(E.dueDate instanceof Date?E.dueDate.toISOString().split("T")[0]:E.dueDate.toString().split("T")[0])===V)?!1:(A.add(ke),!0)}).map(K=>({id:`repetitive-task-${K.id}`,title:K.name,description:K.description||"Repetitive task",date:V,type:"repetitive-task",icon:"",color:b,completed:K.status==="completed",allDay:!0,linkedId:K.id,startTime:"00:00",endTime:"23:59",subtasks:K.subtasks||[],hasDetails:!!(K.description||K.subtasks&&K.subtasks.length>0)})),re=[...B,...Q,...X],z=re.filter(K=>{const Fe=K.allDay===!0,ke=K.type==="milestone",gt=K.type==="repetitive-task";return Fe||ke||gt}),te=re.filter(K=>{const Fe=!K.allDay,ke=K.type!=="milestone",gt=K.type!=="repetitive-task";return Fe&&ke&&gt});return{allDayEvents:z,timedEvents:te}},[e,a,s,k,D,b]),Pe=N.useMemo(()=>{const B=[];for(let V=6;V<=22;V++){const Q=V===12?"12 PM":V>12?`${V-12} PM`:V===0?"12 AM":`${V} AM`,A=ae.filter(re=>parseInt(re.startTime.split(":")[0])===V),X=A.length===0;B.push({hour:V,displayTime:Q,events:A,isEmpty:X})}return B},[ae]),$e=new Date().getHours(),Re=e.toDateString()===new Date().toDateString(),Te=async B=>{const V=B.linkedId||B.id;if(console.log(" Handling completion for event:",B.title,"ID:",V,"Current completed:",B.completed,"Type:",B.type),B.type==="milestone"&&B.goalId&&B.milestoneId)try{if(C(B.goalId,B.milestoneId),console.log(" Milestone completion toggled:",B.title),!B.completed){const Q=k.find(X=>X.id===B.goalId),A=Q==null?void 0:Q.milestones.find(X=>X.id===B.milestoneId);Q&&A&&T(B.goalId,B.milestoneId,Q,A)}}catch(Q){console.error(" Error toggling milestone completion:",Q)}else if(B.type==="repetitive-task"&&B.linkedId)try{y(B.linkedId),console.log(" Repetitive task completion toggled:",B.title)}catch(Q){console.error(" Error toggling repetitive task completion:",Q)}else c(V)?(U({event:B,type:"complete"}),O(!0)):(o(V),console.log(" Called toggleTimeBlockCompletion for ID:",V))},Ee=B=>{const V=B.linkedId||B.id,Q=c(V);if(console.log(" Event deletion:",{eventTitle:B.title,eventId:V,linkedId:B.linkedId,isRecurring:Q}),Q)console.log(" Showing recurring deletion modal for:",B.title),U({event:B,type:"delete"}),O(!0);else{console.log(" Directly deleting non-recurring event:",B.title),i(V);const A=setTimeout(()=>$(null),5e3);$({type:"delete",event:B,timeoutId:A})}},nt=()=>{Z&&(Z.type==="delete"&&console.log("Undo delete:",Z.event.title),clearTimeout(Z.timeoutId),$(null))},ut=Wy({onTap:Te,onLongPress:B=>{H(B),G(!0)},onSwipeLeft:Ee}),at=B=>{M({hour:B,date:e}),w(!0),r==null||r(B,e)},ce=B=>B.type==="habit"?"#34C759":B.type==="task"?"#007AFF":B.color||b,mt=B=>{var Q;const V=ce(B);return V.includes("linear-gradient")?{background:V,borderColor:V.includes("#")&&((Q=V.match(/#[0-9A-Fa-f]{6}/g))==null?void 0:Q[0])||b}:{background:`linear-gradient(135deg, ${V}25, ${V}15)`,borderColor:V}},st=B=>B.type==="habit"?"habit":B.type==="task"?"task":"";return n.jsxs("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-900",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:()=>{g()},className:"w-8 h-8 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md flex items-center justify-center text-gray-600 dark:text-gray-300 transition-colors",children:""}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Re?"Today":e.toLocaleDateString("en-US",{year:"numeric"})})]}),n.jsx("button",{onClick:()=>{m()},className:"w-8 h-8 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md flex items-center justify-center text-gray-600 dark:text-gray-300 transition-colors",children:""})]}),n.jsx("button",{onClick:()=>{v(new Date)},className:"px-3 py-1.5 text-white text-sm font-medium rounded-md transition-colors",style:{backgroundColor:b},onMouseEnter:B=>{const V=j(b);V&&(B.currentTarget.style.backgroundColor=`rgb(${Math.max(0,V.r-20)}, ${Math.max(0,V.g-20)}, ${Math.max(0,V.b-20)})`)},onMouseLeave:B=>{B.currentTarget.style.backgroundColor=b},children:"Today"})]}),oe.length>0&&n.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[n.jsxs("button",{onClick:()=>Y(!R),className:"w-full flex items-center gap-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700/50 rounded-lg p-2 -m-2 transition-colors duration-200",children:[n.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center transition-all duration-300 ${R?"bg-blue-500 dark:bg-blue-400":"bg-gray-400 dark:bg-gray-500"}`,children:n.jsx("svg",{className:`w-2.5 h-2.5 text-white transition-transform duration-300 ${R?"rotate-90":"rotate-0"}`,fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})}),n.jsxs("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["All-Day Events (",oe.length,")"]})]}),n.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${R?"max-h-[500px] opacity-100 mt-3":"max-h-0 opacity-0 mt-0"}`,children:n.jsx("div",{className:"space-y-2",children:oe.map(B=>n.jsxs("div",{className:`flex items-center gap-3 p-2.5 rounded-lg border transition-all duration-200 ${B.completed?"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-600 opacity-60":"bg-white dark:bg-gray-800/80 border-gray-300 dark:border-gray-600"}`,style:{borderLeftWidth:"4px",borderLeftColor:B.type==="milestone"||B.type==="repetitive-task"?b:B.color||b},children:[n.jsx("button",{onClick:V=>{V.stopPropagation(),V.preventDefault(),Te(B)},onMouseDown:V=>{V.stopPropagation(),V.preventDefault()},onTouchStart:V=>{V.stopPropagation()},className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${B.completed?"text-white":"border-gray-400 hover:border-gray-300"}`,style:B.completed?{backgroundColor:b,borderColor:b}:{},children:B.completed&&n.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),n.jsx("div",{className:"text-xl",children:B.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:`font-medium truncate ${B.completed?"text-gray-400 dark:text-gray-500 line-through":"text-gray-900 dark:text-white"}`,children:B.title}),B.description&&n.jsx("p",{className:`text-sm truncate ${B.completed?"text-gray-500 dark:text-gray-600":"text-gray-600 dark:text-gray-300"}`,children:B.description})]}),n.jsx("div",{className:"px-2 py-1 text-xs font-medium rounded-full",style:{backgroundColor:`${b}20`,color:b},children:B.type==="milestone"?"Milestone":B.type==="repetitive-task"?"Task":"Event"})]},B.id))})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto pb-20",children:n.jsx("div",{className:"px-4 py-2",children:Pe.map(B=>n.jsxs("div",{className:`flex items-start mb-3 min-h-[70px] relative transition-all duration-200 ${Re&&B.hour===$e?"current-time bg-gradient-to-r from-transparent via-blue-500/5 to-transparent":""}`,children:[n.jsx("div",{className:"min-w-[65px] pt-2",children:n.jsx("span",{className:`text-sm font-semibold transition-colors ${Re&&B.hour===$e?"text-blue-400":B.isEmpty?"text-gray-500 dark:text-gray-500":"text-gray-700 dark:text-gray-300"}`,children:B.displayTime})}),n.jsxs("div",{className:"flex flex-col items-center mx-4 -mt-1",children:[n.jsx("div",{className:`relative w-4 h-4 rounded-full transition-all duration-200 ${B.isEmpty?"border-2 border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-800":"border-2 shadow-lg"}`,style:B.isEmpty?{}:{borderColor:b,backgroundColor:b,boxShadow:`0 0 12px ${b}40, 0 2px 4px rgba(0,0,0,0.2)`},children:!B.isEmpty&&n.jsx("div",{className:"absolute inset-0.5 rounded-full opacity-60",style:{backgroundColor:"white"}})}),n.jsx("div",{className:`w-1 flex-1 min-h-[60px] transition-all duration-200 ${B.isEmpty?"bg-gray-300 dark:bg-gray-700":""}`,style:B.isEmpty?{}:{background:`linear-gradient(180deg, ${b} 0%, ${b}40 100%)`,boxShadow:`0 0 4px ${b}30`}})]}),n.jsx("div",{className:"flex-1 pt-0",children:B.isEmpty?n.jsx("button",{onClick:()=>at(B.hour),className:"group w-full p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-500 dark:text-gray-500 text-sm transition-all duration-200 touch-manipulation hover:border-solid hover:scale-[1.02] hover:shadow-md hover:bg-opacity-5",style:{"--hover-border-color":b,"--hover-text-color":b},onMouseEnter:V=>{V.currentTarget.style.borderColor=b,V.currentTarget.style.color=b,V.currentTarget.style.backgroundColor=b+"08",V.currentTarget.style.boxShadow=`0 4px 12px ${b}20`},onMouseLeave:V=>{V.currentTarget.style.borderColor="",V.currentTarget.style.color="",V.currentTarget.style.backgroundColor="",V.currentTarget.style.boxShadow=""},children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("span",{className:"transition-transform group-hover:scale-110",children:""}),n.jsx("span",{className:"font-medium",children:"Tap to add"})]})}):n.jsx("div",{className:"space-y-2",children:Array.from(new Set(B.events.map(V=>V.id))).map(V=>{const Q=B.events.find(E=>E.id===V),A=parseInt(Q.startTime.split(":")[0]),X=parseInt(Q.endTime.split(":")[0]),re=parseInt(Q.endTime.split(":")[1]),z=A===B.hour,te=parseInt(Q.startTime.split(":")[1]),K=A*60+te,ke=(X*60+re-K)/60,gt=z?ut.getEventHandlers(Q):{};return n.jsxs("div",{...gt,className:`w-full text-left transition-all duration-200 hover:scale-[1.02] hover:shadow-lg touch-manipulation cursor-pointer select-none relative ${Q.completed?"opacity-60":""} ${st(Q)} p-4 rounded-xl shadow-md border border-opacity-20`,style:{...mt(Q),backdropFilter:"blur(10px)",color:"white",boxShadow:`0 4px 12px ${ce(Q).includes("linear-gradient")?"#00000020":ce(Q)+"20"}`,minHeight:ke>1?`${Math.min(ke*60,200)}px`:"auto"},children:[ke>1&&n.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-xl",style:{background:(ce(Q).includes("linear-gradient"),ce(Q)),boxShadow:`0 0 8px ${ce(Q).includes("linear-gradient")?"#00000060":ce(Q)+"60"}`}}),n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center text-lg shadow-sm transition-all duration-200",style:{background:ce(Q).includes("linear-gradient")?ce(Q):ce(Q)+"30",border:ce(Q).includes("linear-gradient")?"1px solid rgba(255,255,255,0.3)":`1px solid ${ce(Q)}40`},children:Q.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:`font-semibold text-base leading-tight transition-all duration-200 ${Q.completed?"line-through":""}`,children:[Q.completed&&n.jsx("span",{className:"mr-2 text-green-400",children:""}),Q.title]}),Q.description&&n.jsx("div",{className:"text-sm opacity-85 mt-1.5 leading-relaxed",children:Q.description}),n.jsxs("div",{className:"flex items-center gap-2 text-xs opacity-70 mt-2",children:[n.jsxs("span",{className:"bg-black bg-opacity-20 px-2 py-1 rounded-md font-medium",children:[Q.startTime," - ",Q.endTime]}),ke>1&&n.jsxs("span",{className:"px-2 py-1 rounded-md font-bold text-white text-xs",style:{background:(ce(Q).includes("linear-gradient"),ce(Q)),boxShadow:`0 2px 4px ${ce(Q).includes("linear-gradient")?"#00000040":ce(Q)+"40"}`},children:[" ",Math.round(ke*10)/10,"h"]})]})]})]})]},`${Q.id}-${B.hour}`)})})}),Re&&B.hour===$e&&n.jsx("div",{className:"absolute right-4 top-2",children:n.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded font-medium",children:"Now"})})]},B.hour))})}),L&&n.jsx(qs,{isOpen:F,onClose:()=>{G(!1),H(null)},editingTimeBlock:a.find(B=>B.id===(L.linkedId||L.id))}),q&&n.jsx(qy,{isOpen:P,onClose:()=>{O(!1),U(null)},event:q.event,actionType:q.type,onSingleAction:()=>{const B=q.event.linkedId||q.event.id;q.type==="delete"?u(B):d(B)},onSeriesAction:()=>{const B=q.event.linkedId||q.event.id,V=l(B);if(V)if(q.type==="delete")f(V);else{const Q=!q.event.completed;h(V,Q)}}}),_&&n.jsx(Uy,{isOpen:S,onClose:()=>{w(!1),M(null)},selectedTime:`${_.hour.toString().padStart(2,"0")}:00`,selectedDate:_.date}),Z&&Z.type==="delete"&&n.jsx("div",{className:"fixed bottom-20 left-4 right-4 z-50",children:n.jsxs("div",{className:"bg-gray-800 dark:bg-gray-800 text-white px-4 py-3 rounded-lg shadow-lg flex items-center justify-between",children:[n.jsx("span",{className:"text-sm",children:"Event deleted"}),n.jsx("button",{onClick:nt,className:"text-blue-400 hover:text-blue-300 text-sm font-medium ml-4",children:"Undo"})]})})]})}function Yy({onCreateTimeBlock:e}){return n.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-3xl border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute top-2 right-8 text-2xl opacity-60 animate-pulse",children:""}),n.jsx("div",{className:"text-8xl mb-4 animate-bounce opacity-80",children:""})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"No Events Scheduled"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-8 max-w-md mx-auto",children:"Time blocking helps you stay focused and achieve your goals. Schedule your tasks, habits, and important events to take control of your day."}),n.jsx("div",{className:"flex flex-col items-center gap-3 mb-6",children:n.jsx("button",{onClick:e,className:"flex items-center gap-2 px-8 py-4 accent-gradient text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:" Schedule Your First Block"})}),n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 mb-8",children:[n.jsx("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3 text-center",children:" Time Block Ideas"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Morning routine - 7:00 AM"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Deep work session - 9:00 AM"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Workout time - 6:00 PM"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," Learning session - 8:00 PM"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Schedule goal activities"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Block time for habits"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Conflict detection"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Mobile optimized"})]})]})]})}function Qy(){const{timeBlocks:e,currentDate:t,navigatePrevious:r,navigateNext:a,setCurrentDate:s}=yt(),{goals:o}=De(),{tasks:i}=Oe(),[c,l]=N.useState(!1),d=N.useMemo(()=>!!(e.length>0||o.some(g=>g.milestones&&g.milestones.some(m=>m.dueDate))||i.some(g=>(g.isRecurring||g.originalTaskId)&&g.dueDate)),[e.length,o,i]),h=()=>n.jsx(Vy,{selectedDate:t});return d?n.jsx("div",{className:"flex-1 bg-gray-50 dark:bg-gray-900 min-h-screen",children:n.jsxs("div",{className:"w-full px-2 py-3 lg:px-3 lg:py-4",children:[h(),n.jsx(qs,{isOpen:c,onClose:()=>l(!1)})]})}):n.jsxs(n.Fragment,{children:[n.jsx(Yy,{onCreateTimeBlock:()=>l(!0)}),n.jsx(qs,{isOpen:c,onClose:()=>l(!1)})]})}const Ky=e=>{const{settings:t,shouldAutoLock:r}=ar(),a=N.useRef(null),s=N.useRef(!1);N.useEffect(()=>{if(!t.passcode.enabled){a.current&&(clearInterval(a.current),a.current=null);return}return a.current=setInterval(()=>{if(r())e!=null&&e.onAutoLock&&e.onAutoLock(),console.log(" Auto-lock triggered");else if(e!=null&&e.onWarning&&t.passcode.lastAccessTime){const o=dg(t.passcode.autoLockTimeout);if(o>0){const i=Date.now()-t.passcode.lastAccessTime,c=o-i;c<=3e4&&c>0&&!s.current?(console.log(` Auto-lock warning: ${Math.floor(c/1e3)}s remaining`),e.onWarning(Math.floor(c/1e3)),s.current=!0):c>3e4&&(s.current=!1)}}},1e3),()=>{a.current&&clearInterval(a.current)}},[t.passcode.enabled,r,e]),N.useEffect(()=>{s.current=!1},[t.passcode.autoLockTimeout,t.passcode.lastAccessTime])},fs=Gl("App",{web:()=>ge(()=>import("./web-ltTxQ3Hh.js"),[],import.meta.url).then(e=>new e.AppWeb)}),gg=Object.freeze(Object.defineProperty({__proto__:null,App:fs},Symbol.toStringTag,{value:"Module"})),Jy=e=>{const t=N.useRef(document.visibilityState),r=N.useRef(!0);N.useEffect(()=>{if(r.current){r.current=!1,t.current=document.visibilityState;return}if(wr.isNativePlatform()){console.log(" Using Capacitor App plugin for mobile state detection");const a=fs.addListener("appStateChange",i=>{var c,l;console.log(" Capacitor app state change:",i),i.isActive?(console.log(" App came to foreground (Capacitor)"),(c=e==null?void 0:e.onForeground)==null||c.call(e)):(console.log(" App went to background (Capacitor)"),(l=e==null?void 0:e.onBackground)==null||l.call(e))}),s=fs.addListener("pause",()=>{var i;console.log(" App paused (Capacitor)"),(i=e==null?void 0:e.onBackground)==null||i.call(e)}),o=fs.addListener("resume",()=>{var i;console.log(" App resumed (Capacitor)"),(i=e==null?void 0:e.onForeground)==null||i.call(e)});return()=>{a.remove(),s.remove(),o.remove()}}else{console.log(" Using web APIs for browser state detection");const a=()=>{var h,u,f;const c=document.visibilityState,l=t.current==="visible",d=c==="visible";console.log(" Visibility change:",{from:t.current,to:c,wasVisible:l,isVisible:d}),l&&!d&&(console.log(" App went to background (Web)"),(h=e==null?void 0:e.onBackground)==null||h.call(e)),!l&&d&&(console.log(" App came to foreground (Web)"),(u=e==null?void 0:e.onForeground)==null||u.call(e)),(f=e==null?void 0:e.onVisibilityChange)==null||f.call(e,d),t.current=c},s=()=>{var c;console.log(" Window blur event"),(c=e==null?void 0:e.onWindowBlur)==null||c.call(e)},o=()=>{var c;console.log(" Window focus event"),(c=e==null?void 0:e.onWindowFocus)==null||c.call(e)},i=()=>{console.log(" App closing/reloading"),localStorage.setItem("kage-app-closing",Date.now().toString())};return document.addEventListener("visibilitychange",a),window.addEventListener("blur",s),window.addEventListener("focus",o),window.addEventListener("beforeunload",i),()=>{document.removeEventListener("visibilitychange",a),window.removeEventListener("blur",s),window.removeEventListener("focus",o),window.removeEventListener("beforeunload",i)}}},[e]),N.useEffect(()=>{var s;const a=localStorage.getItem("kage-app-closing");if(a){const o=parseInt(a),i=Date.now()-o;console.log(" App reopened after closing",{closingTime:new Date(o).toISOString(),timeSinceClosed:`${i}ms`}),localStorage.removeItem("kage-app-closing"),(s=e==null?void 0:e.onBackground)==null||s.call(e)}},[e])};function Xy({onCreateEntry:e}={}){return n.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-3xl border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"relative mb-6",children:[n.jsx("div",{className:"absolute top-2 right-8 text-2xl opacity-60 animate-pulse",children:""}),n.jsx("div",{className:"text-8xl mb-4 animate-bounce opacity-80",children:""})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"No Journal Entries"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-base leading-relaxed mb-8 max-w-md mx-auto",children:"Reflection amplifies growth. Start journaling to capture insights, track your mood, and see patterns in your productivity journey."}),n.jsx("div",{className:"flex flex-col items-center gap-3 mb-6",children:n.jsx("button",{onClick:e,className:"flex items-center gap-2 px-8 py-4 accent-gradient text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300",children:" Write Your First Entry"})}),n.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 mb-8",children:[n.jsx("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3 text-center",children:" Journal Prompts"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," What am I grateful for today?"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," What progress did I make on my goals?"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," What did I learn today?"]}),n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white dark:bg-gray-600 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:""})," How am I feeling right now?"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Link to goals & habits"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Track your mood daily"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"Auto-prompts from AI"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 accent-gradient rounded-lg flex items-center justify-center text-white text-sm",children:""}),n.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"See patterns over time"})]})]})]})}function Zy(){const{entries:e,currentFilter:t,searchQuery:r,isModalOpen:a,getFilteredEntries:s,setFilter:o,setSearchQuery:i,openModal:c,closeModal:l,addEntry:d,selectEntry:h,deleteEntry:u}=Cr(),{tasks:f}=Oe(),{settings:g,validatePasscode:m,shouldAutoLock:v,updateLastAccess:D,forceLock:y,isJournalLocked:p,lockJournal:x,unlockJournal:k,checkAndUpdateLockState:C}=ar(),[T,b]=N.useState(!1),[j,S]=N.useState(""),[w,_]=N.useState(""),[M,F]=N.useState(!1),[G,L]=N.useState(null),[H,P]=N.useState(null),[O,q]=N.useState(null),[U,Z]=N.useState(""),[$,R]=N.useState("neutral"),[Y,oe]=N.useState(new Set),ae=s();Ky({onAutoLock:()=>{x(),S(""),_(""),L(null),H&&(clearInterval(H),P(null))},onWarning:A=>{if(L(A),!H&&A>0){const X=setInterval(()=>{L(re=>re===null||re<=1?(clearInterval(X),P(null),null):re-1)},1e3);P(X)}}}),Jy({onBackground:()=>{g.passcode.enabled&&(console.log(" App backgrounded - force locking journal"),y())},onForeground:()=>{g.passcode.enabled&&(console.log(" App foregrounded - checking lock state"),C())},onWindowBlur:()=>{g.passcode.enabled&&(console.log(" Window blur - force locking journal"),y())}}),N.useEffect(()=>{console.log(" Journal lock check on mount/settings change");const A=()=>{const re=C();console.log(" Lock state check result:",re,{passcodeEnabled:g.passcode.enabled,hasLastAccess:!!g.passcode.lastAccessTime,currentLockState:p})};A();const X=setTimeout(A,100);return()=>clearTimeout(X)},[g.passcode.enabled,g.passcode.lastAccessTime,C,p]);const $e=async()=>{if(j.length!==4){_("Passcode must be 4 digits");return}F(!0),_("");try{await m(j)?(k(),S(""),console.log(" Journal unlocked successfully")):(_("Incorrect passcode"),S(""))}catch{_("Failed to validate passcode"),S("")}finally{F(!1)}},Re=A=>{const X=A.replace(/\D/g,"");X.length<=4&&(S(X),_(""))};N.useEffect(()=>{j.length===4&&!M&&$e()},[j,M]),N.useEffect(()=>{const A=()=>{g.passcode.enabled&&v()&&(x(),S(""),_(""))};return window.addEventListener("focus",A),()=>window.removeEventListener("focus",A)},[g.passcode.enabled,v]),N.useEffect(()=>{g.passcode.enabled&&!p&&D()},[g.passcode.enabled,p,D]),N.useEffect(()=>()=>{H&&clearInterval(H)},[H]),N.useEffect(()=>{if(T&&!r){const A=setTimeout(()=>{b(!1)},3e3);return q(A),()=>{A&&clearTimeout(A)}}else O&&(clearTimeout(O),q(null))},[T,r]),N.useEffect(()=>()=>{O&&clearTimeout(O)},[]);const Te=()=>{c(),g.passcode.enabled&&(D(),L(null),H&&(clearInterval(H),P(null)))};N.useEffect(()=>{const A=()=>{Te()};return window.addEventListener("openJournalModal",A),()=>window.removeEventListener("openJournalModal",A)},[]);const Ee=A=>{h(A)},nt=A=>{const X=new Set(Y);X.has(A)?X.delete(A):X.add(A),oe(X)},ut=A=>{confirm("Are you sure you want to delete this journal entry?")&&u(A)},at=A=>{R(A)},ce=()=>{U.trim().length>=10&&(d({content:U,mood:$,tags:[],linkedGoals:[],linkedTasks:[],linkedHabits:[]}),Z(""),R("neutral"),g.passcode.enabled&&(D(),L(null),H&&(clearInterval(H),P(null))))},mt=A=>{const X=new Date,re=new Date(A),z=new Date(X.getFullYear(),X.getMonth(),X.getDate()),te=new Date(re.getFullYear(),re.getMonth(),re.getDate()),K=z.getTime()-te.getTime(),Fe=Math.floor(K/(1e3*60*60*24));return Fe===0?"Today":Fe===1?"Yesterday":re.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})},st=A=>{const X=Ui.find(re=>re.id===A);return(X==null?void 0:X.emoji)||""},B=(A,X,re=150)=>X||A.length<=re?A:A.substring(0,re)+"...",V=(A,X=150)=>A.length>X,Q={all:e.length,today:e.filter(A=>{const X=new Date;return new Date(A.createdAt).toDateString()===X.toDateString()}).length,"this-week":e.filter(A=>{const X=new Date,re=new Date(X.getFullYear(),X.getMonth(),X.getDate()-X.getDay());return new Date(A.createdAt)>=re}).length,"this-month":e.filter(A=>{const X=new Date,re=new Date(A.createdAt);return re.getMonth()===X.getMonth()&&re.getFullYear()===X.getFullYear()}).length};return g.passcode.enabled&&p?n.jsx("div",{className:"min-h-[calc(100vh-8rem)] flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"w-16 h-16 bg-indigo-100 dark:bg-indigo-900/30 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(zs,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Journal Protected"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter your 4-digit passcode to access your journal entries"})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{children:n.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:j,onChange:A=>Re(A.target.value),className:"w-full px-4 py-4 text-center text-3xl font-mono border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent tracking-widest",placeholder:"",autoFocus:!0,disabled:M})}),w&&n.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex-shrink-0"}),n.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:w})]})}),n.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ps,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0"}),n.jsx("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Enter all 4 digits to unlock your journal automatically"})]})}),M&&n.jsxs("div",{className:"flex items-center justify-center gap-3 text-gray-600 dark:text-gray-400",children:[n.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-indigo-500 rounded-full animate-spin"}),n.jsx("span",{className:"text-sm",children:"Verifying passcode..."})]})]}),n.jsx("div",{className:"mt-8 text-center",children:n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Forgot your passcode? Go to Settings to manage journal protection."})})]})}):e.length===0?n.jsxs("div",{children:[n.jsx(Xy,{onCreateEntry:Te}),n.jsx(qi,{isOpen:a,onClose:l})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Journal"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:()=>b(!T),className:"w-10 h-10 bg-gray-100 dark:bg-gray-800 rounded-xl flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:n.jsx(Zm,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),n.jsx("button",{onClick:Te,className:"w-12 h-12 bg-gradient-to-r accent-gradient rounded-2xl text-white flex items-center justify-center shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-200",children:n.jsx(Dt,{className:"w-6 h-6"})})]})]}),G!==null&&n.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-amber-100 dark:bg-amber-900/30 rounded-lg flex items-center justify-center",children:n.jsx(zs,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:["Journal will auto-lock in ",G," seconds"]}),n.jsx("div",{className:"text-xs text-amber-700 dark:text-amber-300",children:"Continue using the journal to reset the timer"})]})]}),n.jsx("button",{onClick:()=>{L(null),H&&(clearInterval(H),P(null))},className:"text-amber-600 dark:text-amber-400 hover:text-amber-800 dark:hover:text-amber-200 transition-colors",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),T&&n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:n.jsx("input",{type:"text",value:r,onChange:A=>i(A.target.value),placeholder:"Search your journal entries...",className:"w-full p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus-accent-ring focus-accent-border outline-none",autoFocus:!0})}),n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:n.jsx("div",{className:"grid grid-cols-4 gap-1",children:[{id:"all",label:"All",count:Q.all},{id:"today",label:"Today",count:Q.today},{id:"this-week",label:"Week",count:Q["this-week"]},{id:"this-month",label:"Month",count:Q["this-month"]}].map(A=>n.jsxs("button",{onClick:()=>o(A.id),className:`px-2 py-3 rounded-lg font-medium text-sm transition-all text-center ${t===A.id?"accent-bg-500 text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[n.jsx("div",{className:"truncate",children:A.label}),n.jsx("div",{className:`text-xs mt-0.5 px-1.5 py-0.5 rounded-full inline-block ${t===A.id?"bg-white/20":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}`,children:A.count})]},A.id))})}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("div",{className:"w-8 h-8 accent-bg-500 rounded-lg flex items-center justify-center",children:n.jsx("span",{className:"text-white text-sm",children:""})}),n.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Quick Reflection"})]}),n.jsx("textarea",{value:U,onChange:A=>Z(A.target.value),placeholder:"How are you feeling? What's on your mind? Any insights from today?",className:"w-full p-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg resize-none focus:ring-2 focus-accent-ring focus-accent-border outline-none text-sm",rows:3}),n.jsxs("div",{className:"flex items-center justify-between mt-3",children:[n.jsx("div",{className:"flex gap-2",children:Ui.map(A=>n.jsx("button",{onClick:()=>at(A.id),className:`w-10 h-10 rounded-lg text-xl transition-all hover:scale-110 ${$===A.id?"accent-bg-500 text-white shadow-md":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"}`,title:A.label,children:A.emoji},A.id))}),n.jsx("button",{onClick:ce,disabled:U.trim().length<10,className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${U.trim().length>=10?"accent-bg-500 text-white hover-accent-bg-dark":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:"Save Entry"})]})]}),n.jsx("div",{className:"space-y-4",children:ae.length===0?n.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-4 opacity-50",children:""}),n.jsx("div",{className:"font-semibold text-lg mb-2",children:"No entries found"}),n.jsx("div",{className:"text-sm",children:r?"Try a different search term":"No entries match the selected filter"})]}):ae.map(A=>{const X=Y.has(A.id),re=V(A.content);return n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 group",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:mt(A.createdAt)}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(A.createdAt).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})})]}),n.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[n.jsx("button",{onClick:z=>{z.stopPropagation(),Ee(A)},className:"w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Hs,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),n.jsx("button",{onClick:z=>{z.stopPropagation(),ut(A.id)},className:"w-8 h-8 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center hover:bg-red-200 dark:hover:bg-red-800 transition-colors",children:n.jsx(ft,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]})]}),n.jsxs("div",{className:`text-gray-900 dark:text-white leading-relaxed mb-3 transition-all duration-300 ${re?"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg p-2 -m-2 transition-colors":""}`,onClick:re?()=>nt(A.id):void 0,children:[B(A.content,X),re&&n.jsx("div",{className:"flex items-center gap-1 mt-2 text-sm text-gray-500 dark:text-gray-400 transition-all duration-200",children:X?n.jsxs(n.Fragment,{children:[n.jsx(zi,{className:"w-4 h-4 transition-transform duration-200"}),n.jsx("span",{children:"Read less"})]}):n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"w-4 h-4 transition-transform duration-200"}),n.jsx("span",{children:"Read more"})]})})]}),A.tags.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:A.tags.map(z=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg text-xs font-medium",children:["#",z]},z))}),(A.linkedTasks.length>0||A.linkedGoals.length>0||A.linkedHabits.length>0)&&n.jsxs("div",{className:"flex flex-wrap gap-2",children:[A.linkedTasks.length>0&&n.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-50 text-green-700 rounded-lg text-xs font-medium",children:[" ",A.linkedTasks.length," task",A.linkedTasks.length>1?"s":""]}),A.linkedGoals.length>0&&n.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 rounded-lg text-xs font-medium",children:[" ",A.linkedGoals.length," goal",A.linkedGoals.length>1?"s":""]}),A.linkedHabits.length>0&&n.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-purple-50 text-purple-700 rounded-lg text-xs font-medium",children:[" ",A.linkedHabits.length," habit",A.linkedHabits.length>1?"s":""]})]}),n.jsxs("div",{className:"flex items-center justify-between mt-3",children:[n.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:[A.characterCount," characters"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"How was your day?"}),n.jsx("div",{className:"text-xl",children:st(A.mood)})]})]})]},A.id)})}),n.jsx(qi,{isOpen:a,onClose:l})]})}function ex({isOpen:e,onClose:t}){const{profile:r,updateProfile:a,getProfileInitials:s}=Pa(),[o,i]=N.useState({name:"",email:"",timezone:"",language:""});N.useEffect(()=>{e&&r&&i({name:r.name||"",email:r.email||"",timezone:r.timezone||"UTC",language:r.language||"en"})},[e,r]);const c=h=>{h.preventDefault(),a(o),t()},l=()=>{r&&i({name:r.name||"",email:r.email||"",timezone:r.timezone||"UTC",language:r.language||"en"}),t()},d=()=>{console.log("Open image picker for avatar")};return!e||!r?null:n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl animate-in slide-in-from-bottom duration-300 text-gray-900 dark:text-white",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-gray-700",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Edit Profile"}),n.jsx("button",{onClick:l,className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Bt,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})]}),n.jsxs("form",{onSubmit:c,className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx("div",{className:"w-24 h-24 accent-gradient rounded-xl flex items-center justify-center text-white text-3xl font-bold shadow-lg",children:r.avatar?n.jsx("img",{src:r.avatar,alt:r.name,className:"w-full h-full rounded-xl object-cover"}):s()}),n.jsx("button",{type:"button",onClick:d,className:"absolute -bottom-2 -right-2 w-8 h-8 accent-bg-500 hover-accent-bg-dark rounded-full flex items-center justify-center text-white shadow-lg transition-colors",children:n.jsx(lh,{className:"w-4 h-4"})})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 text-center",children:"Tap to change your profile picture"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Full Name *"}),n.jsxs("div",{className:"relative",children:[n.jsx(rg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500"}),n.jsx("input",{type:"text",required:!0,value:o.name,spellCheck:"true",autoCorrect:"on",autoComplete:"name",onChange:h=>i(u=>({...u,name:h.target.value})),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"Enter your full name"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Email Address *"}),n.jsx("input",{type:"email",required:!0,value:o.email,inputMode:"email",autoComplete:"email",onChange:h=>i(u=>({...u,email:h.target.value})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"Enter your email address"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Timezone"}),n.jsxs("select",{value:o.timezone,onChange:h=>i(u=>({...u,timezone:h.target.value})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[n.jsx("option",{value:"UTC",children:"UTC (Coordinated Universal Time)"}),n.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),n.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),n.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),n.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),n.jsx("option",{value:"Europe/London",children:"London (GMT)"}),n.jsx("option",{value:"Europe/Paris",children:"Central European Time"}),n.jsx("option",{value:"Asia/Tokyo",children:"Japan Time (JST)"}),n.jsx("option",{value:"Australia/Sydney",children:"Australian Eastern Time"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Language"}),n.jsxs("select",{value:o.language,onChange:h=>i(u=>({...u,language:h.target.value})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 rounded-xl focus:ring-2 focus-accent-ring focus-accent-border outline-none transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[n.jsx("option",{value:"en",children:"English"}),n.jsx("option",{value:"es",children:"Espaol"}),n.jsx("option",{value:"fr",children:"Franais"}),n.jsx("option",{value:"de",children:"Deutsch"}),n.jsx("option",{value:"ja",children:""}),n.jsx("option",{value:"ko",children:""}),n.jsx("option",{value:"zh",children:""})]})]})]}),n.jsxs("div",{className:"p-6 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 flex gap-3",children:[n.jsx("button",{type:"button",onClick:l,className:"flex-1 py-3 px-4 border border-gray-300 dark:border-gray-700 rounded-xl text-gray-700 dark:text-gray-200 font-medium hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),n.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 accent-gradient text-white rounded-xl font-medium hover:accent-gradient-dark transition-all shadow-lg hover:shadow-xl",children:"Save Changes"})]})]})]})})}function tx(){const{profile:e,getDisplayName:t,getProfileInitials:r,isPremiumUser:a,calculateStats:s}=Pa(),o=s(),[i,c]=N.useState(!1);if(!e)return null;const l=()=>{c(!0)},d=({value:h,label:u})=>n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-orange-500 mb-1",children:h}),n.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:u})]});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-5",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center text-white text-2xl font-bold shadow-lg",children:e.avatar?n.jsx("img",{src:e.avatar,alt:e.name,className:"w-full h-full rounded-xl object-cover"}):r()}),n.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white flex items-center justify-center",children:n.jsx(vn,{className:"w-3 h-3 text-white"})})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-1 truncate",children:t()}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3 truncate",children:e.email}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx(d,{value:o.totalGoals,label:"Goals"}),n.jsx(d,{value:o.currentStreak,label:"Day Streak"}),n.jsx(d,{value:o.totalTasks,label:"Total Tasks"})]})]}),n.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors text-sm font-medium",children:[n.jsx(Tn,{className:"w-4 h-4"}),"Edit"]})]}),a()&&n.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white px-3 py-2 rounded-lg text-sm font-medium text-center",children:" Premium Member"})]}),n.jsx(ex,{isOpen:i,onClose:()=>c(!1)})]})}function ir({title:e,icon:t,children:r,className:a=""}){return n.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm ${a}`,children:[n.jsx("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-100 dark:border-gray-600",children:n.jsxs("h2",{className:"flex items-center gap-2 text-base font-semibold text-gray-900 dark:text-white",children:[t&&n.jsx("span",{className:"text-lg",children:t}),e]})}),n.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-600",children:r})]})}function rx({checked:e,onChange:t,disabled:r=!1,size:a="medium",color:s="orange",className:o=""}){const i=()=>{switch(a){case"small":return{container:"w-10 h-6",knob:"w-4 h-4 top-1 left-1",translate:"translate-x-4"};case"large":return{container:"w-14 h-8",knob:"w-6 h-6 top-1 left-1",translate:"translate-x-6"};default:return{container:"w-12 h-7",knob:"w-5 h-5 top-1 left-1",translate:"translate-x-5"}}},c=()=>{switch(s){case"blue":return"bg-blue-500";case"green":return"bg-green-500";case"purple":return"bg-purple-500";default:return"accent-bg-500"}},l=i(),d=c();return n.jsxs("button",{type:"button",role:"switch","aria-checked":e,disabled:r,onClick:()=>!r&&t(!e),className:`
        relative inline-flex items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus-accent-ring focus:ring-offset-2
        ${l.container}
        ${e?d:"bg-gray-300"}
        ${r?"opacity-50 cursor-not-allowed":"cursor-pointer hover:opacity-90"}
        ${o}
      `,children:[n.jsx("span",{className:"sr-only",children:"Toggle setting"}),n.jsx("span",{className:`
          inline-block bg-white rounded-full shadow-sm transition-transform duration-200
          ${l.knob}
          ${e?l.translate:"translate-x-0"}
        `})]})}function Se({icon:e,iconBgColor:t="bg-gray-500",title:r,subtitle:a,value:s,badge:o,type:i="navigate",checked:c=!1,disabled:l=!1,onClick:d,onToggle:h,className:u=""}){const f=()=>{l||(i==="toggle"&&h?h(!c):d&&d())},g=()=>{switch(i){case"toggle":return n.jsx(rx,{checked:c,onChange:h||(()=>{}),disabled:l});case"value":return n.jsxs("div",{className:"flex items-center gap-2",children:[s&&n.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:s}),o,n.jsx(Bi,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})]});case"action":return n.jsxs("div",{className:"flex items-center gap-2",children:[s,o]});default:return n.jsxs("div",{className:"flex items-center gap-2",children:[s&&n.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:s}),o,n.jsx(Bi,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})]})}};return n.jsxs("div",{onClick:f,className:`
        flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-600 last:border-b-0 transition-colors
        ${l?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700"}
        ${u}
      `,children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[n.jsx("div",{className:`
          w-9 h-9 rounded-lg flex items-center justify-center text-white flex-shrink-0
          ${t}
        `,children:e}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"flex items-center gap-2 mb-1",children:n.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:r})}),a&&n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 leading-tight",children:a})]})]}),n.jsx("div",{className:"flex-shrink-0 ml-3",children:g()})]})}const qo=[{id:"orange",name:"Orange",value:"#FF7101",lightBg:"bg-orange-500",darkBg:"bg-orange-600",lightRing:"ring-orange-500",darkRing:"ring-orange-400"},{id:"blue",name:"Cyan",value:"#06B6D4",lightBg:"bg-cyan-500",darkBg:"bg-cyan-600",lightRing:"ring-cyan-500",darkRing:"ring-cyan-400"},{id:"green",name:"Emerald",value:"#10B981",lightBg:"bg-emerald-500",darkBg:"bg-emerald-600",lightRing:"ring-emerald-500",darkRing:"ring-emerald-400"},{id:"purple",name:"Purple",value:"#A855F7",lightBg:"bg-purple-500",darkBg:"bg-purple-600",lightRing:"ring-purple-500",darkRing:"ring-purple-400"},{id:"red",name:"Bordeaux",value:"#7C2D12",lightBg:"bg-red-800",darkBg:"bg-red-900",lightRing:"ring-red-800",darkRing:"ring-red-700"},{id:"yellow",name:"Corn",value:"#EAB308",lightBg:"bg-yellow-500",darkBg:"bg-yellow-600",lightRing:"ring-yellow-500",darkRing:"ring-yellow-400"}];function nx({isOpen:e,onClose:t}){var d,h;const{settings:r,setAccentColor:a}=ar(),[s,o]=N.useState(r.appearance.accentColor),i=u=>{o(u)},c=()=>{a(s),t()},l=()=>{o(r.appearance.accentColor),t()};return e?n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-3 sm:p-4 md:p-5",children:n.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl w-full max-w-sm sm:max-w-md max-h-[85vh] overflow-hidden shadow-2xl animate-in slide-in-from-bottom duration-300 text-gray-900 dark:text-white flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-gray-700",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Choose Accent Color"}),n.jsx("button",{onClick:l,className:"w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Bt,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-6",children:"Select your preferred accent color. This will be applied throughout the app."}),n.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:qo.map(u=>n.jsxs("button",{onClick:()=>i(u.id),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all hover:bg-gray-50 dark:hover:bg-gray-800 ${s===u.id?"border-gray-400 dark:border-gray-500 bg-gray-50 dark:bg-gray-800 accent-ring-300 ring-2":"border-gray-200 dark:border-gray-700"}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full ${u.lightBg} shadow-md flex items-center justify-center`,children:s===u.id&&n.jsx(zl,{className:"w-4 h-4 text-white"})}),n.jsx("div",{className:"text-left",children:n.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:u.name})})]},u.id))}),n.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[n.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wide mb-3",children:"Preview"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg shadow-md ${(d=qo.find(u=>u.id===s))==null?void 0:d.lightBg} dark:${(h=qo.find(u=>u.id===s))==null?void 0:h.darkBg}`}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:"Sample Button"}),n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"This shows how your accent color will look"})]})]})]})]})}),n.jsxs("div",{className:"flex-shrink-0 p-6 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 flex gap-3",children:[n.jsx("button",{onClick:l,className:"flex-1 py-3 px-4 border border-gray-300 dark:border-gray-700 rounded-xl text-gray-700 dark:text-gray-200 font-medium hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),n.jsx("button",{onClick:c,className:"flex-1 py-3 px-4 rounded-xl font-medium text-white transition-all shadow-lg hover:shadow-xl accent-gradient hover:accent-gradient-dark",children:"Apply Color"})]})]})}):null}function ax({isOpen:e,onClose:t}){const[r,a]=N.useState("kage-full"),[s,o]=N.useState({goals:!0,tasks:!0,habits:!0,journal:!0,timeBlocks:!0}),[i,c]=N.useState({stage:"idle",message:"Ready to export your data",progress:0}),{habits:l,completions:d}=He(),{tasks:h}=Oe(),{goals:u}=De(),{entries:f}=Cr(),{timeBlocks:g}=yt(),{user:m}=Pa();if(!e)return null;const v=()=>({habits:l.length,habitCompletions:d.length,tasks:h.length,goals:u.length,journalEntries:f.length,timeBlocks:g.length}),D=w=>{var H;console.log(" Export: Generating custom backup with user selection:",w);const _=new Map,M=new Map,F=new Map,G=new Map;w.tasks&&w.goals&&h.forEach(P=>{P.goalId&&(_.has(P.goalId)||_.set(P.goalId,[]),_.get(P.goalId).push(P.id))}),w.habits&&w.goals&&l.forEach(P=>{P.goalId&&(M.has(P.goalId)||M.set(P.goalId,[]),M.get(P.goalId).push(P.id))}),w.timeBlocks&&g.forEach(P=>{P.linkedItemType==="task"&&P.linkedItemId&&w.tasks?(F.has(P.linkedItemId)||F.set(P.linkedItemId,[]),F.get(P.linkedItemId).push(P.id)):P.linkedItemType==="habit"&&P.linkedItemId&&w.habits&&(G.has(P.linkedItemId)||G.set(P.linkedItemId,[]),G.get(P.linkedItemId).push(P.id))});const L={exportInfo:{version:"1.2.0",exportDate:new Date().toISOString(),appVersion:"Kage Beta",format:"kage-custom",selectedDataTypes:w,userProfile:{name:(m==null?void 0:m.name)||"Unknown User",email:(m==null?void 0:m.email)||"unknown@example.com"},relationshipMetadata:{goalTaskMap:Object.fromEntries(_),goalHabitMap:Object.fromEntries(M),taskTimeBlockMap:Object.fromEntries(F),habitTimeBlockMap:Object.fromEntries(G)}},statistics:v()};return w.habits&&(L.habits=l.map(P=>({...P,completions:d.filter(O=>O.habitId===P.id)}))),w.tasks&&(L.tasks=h),w.goals&&(L.goals=u),w.journal&&(L.journalEntries=f),w.timeBlocks&&(L.timeBlocks=g),console.log(" Export: Custom export with milestones included in goals:",((H=L.goals)==null?void 0:H.length)||0,"goals"),JSON.stringify(L,null,2)},y=()=>{console.log(" Export: Generating full backup with relationship preservation");const w=new Map,_=new Map,M=new Map,F=new Map;h.forEach(L=>{L.goalId&&(w.has(L.goalId)||w.set(L.goalId,[]),w.get(L.goalId).push(L.id))}),l.forEach(L=>{L.goalId&&(_.has(L.goalId)||_.set(L.goalId,[]),_.get(L.goalId).push(L.id))}),g.forEach(L=>{L.linkedItemType==="task"&&L.linkedItemId?(M.has(L.linkedItemId)||M.set(L.linkedItemId,[]),M.get(L.linkedItemId).push(L.id)):L.linkedItemType==="habit"&&L.linkedItemId&&(F.has(L.linkedItemId)||F.set(L.linkedItemId,[]),F.get(L.linkedItemId).push(L.id))});const G={exportInfo:{version:"1.1.0",exportDate:new Date().toISOString(),appVersion:"Kage Beta",format:"kage-full",userProfile:{name:(m==null?void 0:m.name)||"Unknown User",email:(m==null?void 0:m.email)||"unknown@example.com"},relationshipMetadata:{goalTaskMap:Object.fromEntries(w),goalHabitMap:Object.fromEntries(_),taskTimeBlockMap:Object.fromEntries(M),habitTimeBlockMap:Object.fromEntries(F)}},habits:l.map(L=>({...L,completions:d.filter(H=>H.habitId===L.id)})),tasks:h,goals:u,journalEntries:f,timeBlocks:g,statistics:v()};return console.log(" Export: Relationship metadata:",G.exportInfo.relationshipMetadata),JSON.stringify(G,null,2)},p=()=>{const w={exportInfo:{version:"1.0.0",exportDate:new Date().toISOString(),appVersion:"Kage Beta",format:"kage-habits"},habits:l.map(_=>({..._,completions:d.filter(M=>M.habitId===_.id)})),statistics:{habits:l.length,habitCompletions:d.length}};return JSON.stringify(w,null,2)},x=async(w,_,M)=>{try{return typeof window<"u"&&window.requestIdleCallback?new Promise((F,G)=>{window.requestIdleCallback(async()=>{try{const L=await k(w,_,M);F(L)}catch(L){G(L)}})}):new Promise((F,G)=>{setTimeout(async()=>{try{const L=await k(w,_,M);F(L)}catch(L){G(L)}},0)})}catch(F){throw console.error("Error downloading/saving file:",F),new Error(`Failed to save file: ${F instanceof Error?F.message:"Unknown error"}`)}},k=async(w,_,M)=>{if(typeof window<"u")try{console.log(" Attempting to load Capacitor modules on main thread...");let H=!1;try{window.Capacitor&&(H=window.Capacitor.isNativePlatform())}catch{}if(H){console.log(" Native platform detected, loading Filesystem module...");const{Filesystem:P,Directory:O,Encoding:q}=await ge(async()=>{const{Filesystem:Z,Directory:$,Encoding:R}=await import("./index-DFnJkZMU.js");return{Filesystem:Z,Directory:$,Encoding:R}},[],import.meta.url),U=await P.writeFile({path:_,data:w,directory:O.Documents,encoding:q.UTF8});return console.log(" File saved to Documents directory:",U.uri),{success:!0,path:U.uri,message:`File saved to Documents folder as ${_}`}}}catch(H){console.log(" Capacitor modules not available, falling back to web download:",H)}console.log(" Using browser download API");const F=new Blob([w],{type:M}),G=URL.createObjectURL(F),L=document.createElement("a");return L.href=G,L.download=_,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(G),{success:!0,path:"Downloads folder",message:`File downloaded to your browser's Downloads folder as ${_}`}},C=async()=>{const w=v();let _=0,M=0;try{switch(c({stage:"preparing",message:"Preparing data for export...",progress:0}),r){case"kage-full":_=w.habits+w.tasks+w.goals+w.journalEntries+w.timeBlocks+w.habitCompletions;break;case"kage-habits":_=w.habits+w.habitCompletions;break;case"kage-custom":_=0,s.habits&&(_+=w.habits+w.habitCompletions),s.tasks&&(_+=w.tasks),s.goals&&(_+=w.goals),s.journal&&(_+=w.journalEntries),s.timeBlocks&&(_+=w.timeBlocks);break}await new Promise(O=>setTimeout(O,500)),c({stage:"generating",message:"Generating export file...",progress:25});let F,G;const L=new Date().toISOString().split("T")[0],H=(O,q)=>{M+=O;const U=Math.min(25+M/_*50,75);return c({stage:"generating",message:q,progress:U}),new Promise(Z=>setTimeout(Z,100))};switch(r){case"kage-full":await H(w.habits,"Processing habits..."),await H(w.habitCompletions,"Processing habit completions..."),await H(w.tasks,"Processing tasks..."),await H(w.goals,"Processing goals..."),await H(w.journalEntries,"Processing journal entries..."),await H(w.timeBlocks,"Processing calendar events..."),F=y(),G=`kage-full-backup-${L}.json`;break;case"kage-habits":await H(w.habits,"Processing habits..."),await H(w.habitCompletions,"Processing completions..."),F=p(),G=`kage-habits-export-${L}.json`;break;case"kage-custom":s.habits&&await H(w.habits+w.habitCompletions,"Processing habits..."),s.tasks&&await H(w.tasks,"Processing tasks..."),s.goals&&await H(w.goals,"Processing goals with milestones..."),s.journal&&await H(w.journalEntries,"Processing journal entries..."),s.timeBlocks&&await H(w.timeBlocks,"Processing calendar events..."),F=D(s);const O=[];s.goals&&O.push("goals"),s.tasks&&O.push("tasks"),s.habits&&O.push("habits"),s.journal&&O.push("journal"),G=`kage-${O.join("-")}-${L}.json`;break;default:throw new Error("Invalid export format selected")}c({stage:"generating",message:"Finalizing export...",progress:90}),await new Promise(O=>setTimeout(O,300));const P=await x(F,G,"application/json");c({stage:"completed",message:P.message,progress:100})}catch(F){c({stage:"error",message:"Export failed",progress:0,error:F instanceof Error?F.message:"Unknown error occurred"})}},T=()=>{c({stage:"idle",message:"Ready to export your data",progress:0})},b=v(),j=i.stage==="preparing"||i.stage==="generating",S=[{id:"kage-full",title:"Complete Backup",description:"Full backup including all data types with milestones",icon:n.jsx(sa,{className:"w-5 h-5 text-blue-500"}),stats:`${b.habits} habits, ${b.tasks} tasks, ${b.goals} goals, ${b.journalEntries} entries`},{id:"kage-custom",title:"Custom Selection",description:"Choose specific data types to export",icon:n.jsx(vn,{className:"w-5 h-5 text-orange-500"}),stats:"Select individual data types below"}];return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Hl,{className:"w-6 h-6 text-green-500"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Export Data"})]}),n.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:j,children:n.jsx(Bt,{className:"w-5 h-5 text-gray-500"})})]})}),n.jsxs("div",{className:"p-6 overflow-y-auto max-h-[70vh]",children:[i.stage==="idle"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Choose the export format that best fits your needs. All exports are in JSON format."}),n.jsx("div",{className:"space-y-3",children:S.map(w=>n.jsx("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${r===w.id?"accent-border-500 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>a(w.id),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"mt-1",children:w.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:w.title}),r===w.id&&n.jsx(vn,{className:"w-4 h-4 accent-text-500"})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:w.description}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:w.stats})]})]})},w.id))}),r==="kage-custom"&&n.jsxs("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Select Data Types to Export:"}),n.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{key:"goals",label:"Goals (with Milestones)",count:b.goals,icon:""},{key:"tasks",label:"Tasks",count:b.tasks,icon:""},{key:"habits",label:"Habits & Completions",count:b.habits,icon:""},{key:"journal",label:"Journal Entries",count:b.journalEntries,icon:""},{key:"timeBlocks",label:"Calendar Events",count:b.timeBlocks,icon:""}].map(w=>n.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:s[w.key],onChange:_=>o(M=>({...M,[w.key]:_.target.checked})),className:"w-4 h-4 accent-text-500 border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-800 focus:ring-accent-500"}),n.jsx("span",{className:"text-lg",children:w.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:w.label}),n.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[w.count," ",w.count===1?"item":"items"]})]})]},w.key))}),n.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Object.values(s).filter(Boolean).length," of 5 data types selected"]})})]})]}),(j||i.stage==="completed"||i.stage==="error")&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[i.stage==="completed"&&n.jsx(vn,{className:"w-6 h-6 text-green-500"}),i.stage==="error"&&n.jsx(Km,{className:"w-6 h-6 text-red-500"}),j&&n.jsx("div",{className:"w-6 h-6 border-2 accent-border-500 border-t-transparent rounded-full animate-spin"}),n.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:i.message})]}),i.progress>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-300",children:[n.jsx("span",{children:"Progress"}),n.jsxs("span",{children:[i.progress,"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:n.jsx("div",{className:"accent-bg-500 h-2 rounded-full transition-all duration-300",style:{width:`${i.progress}%`}})})]}),i.error&&n.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:[n.jsx("div",{className:"text-sm font-medium text-red-900 dark:text-red-100 mb-1",children:"Export Error:"}),n.jsx("div",{className:"text-xs text-red-700 dark:text-red-300",children:i.error})]})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end",children:[i.stage==="idle"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),n.jsx("button",{onClick:C,disabled:!r||r==="kage-custom"&&!Object.values(s).some(Boolean),className:"accent-bg-500 hover-accent-bg-dark text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:"Start Export"})]}),(i.stage==="completed"||i.stage==="error")&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Export Another"}),n.jsx("button",{onClick:t,className:"accent-bg-500 hover-accent-bg-dark text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Done"})]})]})]})})}const sx={treadmill:"",sack:"",dumbbell:"",language:"",terminal:"",book:"",paintbrush:"",music:"",camera:"",gamepad:"",heart:"",leaf:"",sun:"",moon:"",droplet:"",fire:"",zap:"",star:"",target:"",trophy:"",medal:"",gift:"",bell:"",key:"",gem:"",crown:"",rocket:"",airplane:"",car:"",bicycle:"",running:"",swimming:"",yoga:"",meditation:"",sleep:"",coffee:"",tea:"",water:"",apple:"",carrot:"",broccoli:"",pill:"",thermometer:"",stethoscope:"",bandage:"",syringe:"",microscope:"",telescope:"",lightbulb:"",gear:"",wrench:"",hammer:"",screwdriver:"",saw:"",ruler:"",scissors:"",paperclip:"",pushpin:"",bookmark:"",label:"",envelope:"",mailbox:"",package:"",box:"",archive:"",file:"",folder:"",notebook:"",diary:"",calendar:"",clock:"",timer:"",stopwatch:"",hourglass:"",alarm:"",watch:"",smartphone:"",computer:"",keyboard:"",mouse:"",printer:"",camera_flash:"",video:"",tv:"",radio:"",headphones:"",microphone:"",guitar:"",piano:"",drum:"",trumpet:"",violin:"",flute:"",saxophone:""},ox={"#FF3B30":"#ef4444","#FF9500":"#f97316","#FFCC02":"#eab308","#34C759":"#22c55e","#007AFF":"#3b82f6","#5856D6":"#8b5cf6","#FF2D92":"#ec4899","#8E8E93":"#6b7280"};function ix({isOpen:e,onClose:t}){const[r,a]=N.useState({stage:"idle",message:"",itemsProcessed:0,totalItems:0,importType:null,errors:[]}),s=N.useRef(null),o=He(),i=Oe(),c=De(),l=Cr(),d=yt(),h=()=>{var y;(y=s.current)==null||y.click()},u=y=>y.exportInfo&&y.exportInfo.format?"kage":y.habits&&Array.isArray(y.habits)&&y.completions&&Array.isArray(y.completions)?"habitkit":null,f=async y=>{var b,j;let p=0,x=0;y.habits&&(p+=y.habits.length),y.tasks&&(p+=y.tasks.length),y.goals&&(p+=y.goals.length),y.journalEntries&&(p+=y.journalEntries.length),y.calendarEvents&&(p+=y.calendarEvents.length),y.timeBlocks&&(p+=y.timeBlocks.length),a(S=>({...S,totalItems:p,stage:"processing",message:"Creating backup and validating import data..."})),console.log(" Import: Starting relationship-aware import"),console.log(" Import: Relationship metadata:",y.exportInfo.relationshipMetadata),o.habits,i.tasks,c.goals,l.entries,d.timeBlocks,console.log(" Import: Created pre-import backup");const k=new Map,C={goals:{imported:0,failed:0},habits:{imported:0,failed:0},tasks:{imported:0,failed:0},journalEntries:{imported:0,failed:0},timeBlocks:{imported:0,failed:0},relationships:{preserved:0,failed:0}},T=(S,w,_)=>{for(const M of _)if(!S[M])throw new Error(`Invalid ${w}: missing required field '${M}'`)};try{if(y.goals){console.log(" Import: Phase 1 - Importing goals"),a(M=>({...M,message:"Importing goals..."}));for(const M of y.goals)try{T(M,"goal",["id","name"]),await new Promise(L=>setTimeout(L,10));const F=M.id,G=c.addGoal(M);G&&G!==F?k.set(F,G):k.set(F,F),C.goals.imported++,x++,a(L=>({...L,itemsProcessed:x}))}catch(F){console.error(`Error importing goal ${M.name||"unknown"}:`,F),C.goals.failed++}}if(y.habits){console.log(" Import: Phase 2 - Importing habits");for(const M of y.habits)try{T(M,"habit",["id","name"]),await new Promise(P=>setTimeout(P,10));const{completions:F,...G}=M;G.goalId&&k.has(G.goalId)&&(G.goalId=k.get(G.goalId));const L=M.id,H=o.addHabit(G);if(k.set(L,H||L),F&&F.length>0)for(const P of F){T(P,"habit completion",["id","habitId","date"]);const O={...P,habitId:k.get(P.habitId)||P.habitId};o.addHabitCompletion(O)}x++,a(P=>({...P,itemsProcessed:x}))}catch(F){console.error(`Error importing habit ${M.name||"unknown"}:`,F)}}if(y.tasks){console.log(" Import: Phase 3 - Importing tasks");for(const M of y.tasks)try{T(M,"task",["id","name"]),await new Promise(H=>setTimeout(H,10));const F={...M,goalId:M.goalId&&k.has(M.goalId)?k.get(M.goalId):M.goalId,subtasks:((b=M.subtasks)==null?void 0:b.map(H=>typeof H=="string"?H:H&&typeof H=="object"&&H.name?H.name:String(H||"")).filter(H=>H&&H.trim()!==""))||[],shoppingItems:((j=M.shoppingItems)==null?void 0:j.map(H=>typeof H=="string"?{name:H,completed:!1}:H))||[]},G=M.id,L=i.addTask(F);k.set(G,L||G),x++,a(H=>({...H,itemsProcessed:x}))}catch(F){console.error(`Error importing task ${M.name||"unknown"}:`,F)}}if(y.journalEntries){console.log(" Import: Phase 4 - Importing journal entries");for(const M of y.journalEntries)try{T(M,"journal entry",["id","content"]),await new Promise(F=>setTimeout(F,10)),l.importEntry(M),x++,a(F=>({...F,itemsProcessed:x}))}catch(F){console.error(`Error importing journal entry ${M.id||"unknown"}:`,F)}}if(y.timeBlocks){console.log(" Import: Phase 5 - Importing time blocks");for(const M of y.timeBlocks)try{T(M,"time block",["id","title"]),await new Promise(G=>setTimeout(G,10));const F={...M};M.linkedItemId&&M.linkedItemType&&(M.linkedItemType==="task"&&k.has(M.linkedItemId)||M.linkedItemType==="habit"&&k.has(M.linkedItemId))&&(F.linkedItemId=k.get(M.linkedItemId)),d.addTimeBlock(F),x++,a(G=>({...G,itemsProcessed:x}))}catch(F){console.error(`Error importing time block ${M.title||"unknown"}:`,F)}}if(y.calendarEvents){console.log(" Import: Importing legacy calendar events");for(const M of y.calendarEvents)try{T(M,"calendar event",["id","title"]),await new Promise(F=>setTimeout(F,10)),d.addEvent(M),x++,a(F=>({...F,itemsProcessed:x}))}catch(F){console.error(`Error importing calendar event ${M.title||"unknown"}:`,F)}}if(console.log(" Import: Completed relationship-aware import"),console.log(" Import: ID mappings created:",Object.fromEntries(k)),console.log(" Import: Summary:",C),y.exportInfo.relationshipMetadata){console.log(" Import: Validating relationships...");const M=y.exportInfo.relationshipMetadata.goalTaskMap;Object.entries(M).forEach(([F,G])=>{k.get(F)&&G.forEach(H=>{k.get(H)?C.relationships.preserved++:C.relationships.failed++})})}const S=Object.values(C).reduce((M,F)=>typeof F=="object"&&"imported"in F?M+F.imported:M,0),w=Object.values(C).reduce((M,F)=>typeof F=="object"&&"failed"in F?M+F.failed:M,0);let _=`Successfully imported ${S} items`;w>0&&(_+=` (${w} failed)`),C.relationships.preserved>0&&(_+=` with ${C.relationships.preserved} relationships preserved`),a(M=>({...M,stage:"completed",message:_}))}catch(S){console.error("Error importing Kage backup:",S),a(w=>({...w,stage:"error",message:"Failed to import Kage backup",errors:[...w.errors,S instanceof Error?S.message:"Unknown error"]}))}},g=async y=>{const p=y.habits.length+y.completions.length;let x=0;a(k=>({...k,totalItems:p,stage:"processing",message:"Converting HabitKit data..."}));try{for(const C of y.habits){if(C.archived)continue;const T={id:C.id,name:C.name,description:C.description||"",icon:C.emoji||sx[C.icon]||"",color:ox[C.color]||C.color||"#3b82f6",measurementType:"simple",frequency:"daily",createdAt:C.createdAt,updatedAt:new Date().toISOString(),streak:0};await new Promise(b=>setTimeout(b,10)),o.addHabit(T),x++,a(b=>({...b,itemsProcessed:x}))}const k=new Map;for(const C of y.completions){k.has(C.habitId)||k.set(C.habitId,[]);const T=S=>{const w=new Date(S.includes("T")?S:S+"T00:00:00.000Z");return isNaN(w.getTime())?new Date:w};let b=C.date;if(C.timezoneOffsetInMinutes){const S=T(C.date);b=new Date(S.getTime()-C.timezoneOffsetInMinutes*6e4).toISOString().split("T")[0]}const j={id:C.id,habitId:C.habitId,date:b,completed:C.amountOfCompletions>0,completedAt:T(C.date).toISOString(),value:C.amountOfCompletions||1};k.get(C.habitId).push(j),x++,a(S=>({...S,itemsProcessed:x})),await new Promise(S=>setTimeout(S,5))}for(const[C,T]of k)for(const b of T)o.addHabitCompletion(b);a(C=>({...C,stage:"completed",message:`Successfully imported ${y.habits.filter(T=>!T.archived).length} habits with ${y.completions.length} completions from HabitKit`}))}catch(k){console.error("Error importing HabitKit data:",k),a(C=>({...C,stage:"error",message:"Failed to import HabitKit data",errors:[...C.errors,k instanceof Error?k.message:"Unknown error"]}))}},m=async y=>{var x;const p=(x=y.target.files)==null?void 0:x[0];if(p){a({stage:"validating",message:"Validating file...",itemsProcessed:0,totalItems:0,importType:null,errors:[]});try{const k=await p.text(),C=JSON.parse(k),T=u(C);if(!T){a(b=>({...b,stage:"error",message:"Unsupported file format. Please select a valid Kage backup or HabitKit export file.",errors:["File format not recognized"]}));return}a(b=>({...b,importType:T})),T==="kage"?await f(C):T==="habitkit"&&await g(C)}catch(k){console.error("Error processing file:",k),a(C=>({...C,stage:"error",message:"Failed to process file. Please ensure it's a valid JSON file.",errors:[...C.errors,k instanceof Error?k.message:"Unknown error"]}))}y.target.value=""}},v=()=>{a({stage:"idle",message:"",itemsProcessed:0,totalItems:0,importType:null,errors:[]})},D=()=>{v(),t()};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Import Data"}),n.jsx("button",{onClick:D,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:n.jsx(Bt,{className:"w-6 h-6"})})]}),n.jsxs("div",{className:"p-6",children:[r.stage==="idle"&&n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx(tg,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-2",children:"Import your data from Kage backups or HabitKit exports"}),n.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Supported formats: Kage Full Backup, Kage Habits Only, HabitKit JSON"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[n.jsxs("div",{className:"p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[n.jsx(gh,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Kage Backup"}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Full data restoration"})]}),n.jsxs("div",{className:"p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[n.jsx(jh,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),n.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"HabitKit"}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Habits migration"})]})]}),n.jsxs("button",{onClick:h,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:[n.jsx(ph,{className:"w-5 h-5 inline mr-2"}),"Select File to Import"]})]}),(r.stage==="validating"||r.stage==="processing")&&n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-2",children:r.message}),r.importType&&n.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Detected: ",r.importType==="kage"?"Kage Backup":"HabitKit Export"]})]}),r.totalItems>0&&n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-2",children:n.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${r.itemsProcessed/r.totalItems*100}%`}})}),n.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.itemsProcessed," of ",r.totalItems," items processed"]})]})]}),r.stage==="completed"&&n.jsxs("div",{className:"text-center",children:[n.jsx(vn,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Import Successful!"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:r.message}),n.jsx("button",{onClick:D,className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors",children:"Done"})]}),r.stage==="error"&&n.jsxs("div",{className:"text-center",children:[n.jsx(Km,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Import Failed"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:r.message}),r.errors.length>0&&n.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 mb-4 text-left",children:[n.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-1",children:"Errors:"}),r.errors.map((y,p)=>n.jsxs("p",{className:"text-xs text-red-600 dark:text-red-300",children:[" ",y]},p))]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:v,className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors",children:"Try Again"}),n.jsx("button",{onClick:D,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors",children:"Close"})]})]})]}),n.jsx("input",{ref:s,type:"file",accept:".json",onChange:m,className:"hidden"})]})}):null}function lx(){const{settings:e,toggleNotifications:t,setTheme:r,togglePrivacySetting:a,updateAppearanceSettings:s,getAccentColorName:o,setupPasscode:i,validatePasscode:c,disablePasscode:l,changePasscode:d,setAutoLockTimeout:h}=ar(),{signOut:u,isPremiumUser:f}=Pa(),{startOnboarding:g}=Fn(),{getArchivedGoals:m,unarchiveGoal:v,deleteGoal:D}=De(),[y,p]=N.useState(!1),[x,k]=N.useState(!1),[C,T]=N.useState(!1),[b,j]=N.useState(!1),[S,w]=N.useState(!1),[_,M]=N.useState(!1),[F,G]=N.useState(""),[L,H]=N.useState(""),[P,O]=N.useState(""),[q,U]=N.useState(""),[Z,$]=N.useState(!1),R=()=>{console.log("Open time picker")},Y=()=>{const A=e.appearance.theme==="light"?"dark":"light";r(A)},oe=()=>{p(!0)},ae=()=>{console.log("Upgrade to premium")},Pe=()=>{k(!0)},$e=()=>{T(!0)},Re=()=>{u()},Te=()=>{g()},Ee=()=>{G(""),H(""),O(""),U(""),$(!1)},nt=()=>{Ee(),w(!0)},ut=async()=>{if(!P){U("Please enter your current passcode");return}$(!0);try{await l(P)?(Ee(),w(!1),console.log(" Passcode disabled successfully")):U("Incorrect passcode")}catch{U("Failed to disable passcode")}finally{$(!1)}},at=async()=>{if(U(""),F.length!==4||!/^\d{4}$/.test(F)){U("Passcode must be 4 digits");return}if(F!==L){U("Passcodes do not match");return}$(!0);try{await i(F)?(Ee(),w(!1),console.log(" Passcode setup successful - Journal is now protected and locked"),setTimeout(()=>{},100)):U("Failed to setup passcode")}catch{U("Failed to setup passcode")}finally{$(!1)}},ce=async()=>{if(U(""),!P){U("Please enter your current passcode");return}if(F.length!==4||!/^\d{4}$/.test(F)){U("New passcode must be 4 digits");return}if(F!==L){U("New passcodes do not match");return}$(!0);try{await d(P,F)?(Ee(),M(!1),console.log(" Passcode changed successfully")):U("Current passcode is incorrect")}catch{U("Failed to change passcode")}finally{$(!1)}},mt=()=>{Ee(),w(!1),M(!1)},st=(A,X)=>{confirm(`Are you sure you want to unarchive "${X}"? It will be restored to your active goals.`)&&(console.log(" Settings: Unarchiving goal:",A),v(A))},B=(A,X)=>{confirm(`Are you sure you want to permanently delete "${X}"? This action cannot be undone.`)&&(console.log(" Settings: Permanently deleting archived goal:",A),D(A))},V=m(),Q=()=>n.jsx("span",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white text-xs px-2 py-1 rounded-md font-semibold",children:"PREMIUM"});return n.jsxs("div",{className:"space-y-6 pb-16",children:[n.jsx(tx,{}),!f()&&n.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-5 text-white relative overflow-hidden",children:[n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:n.jsx(pd,{className:"w-5 h-5"})}),n.jsx("h3",{className:"text-lg font-semibold",children:"Unlock AI Superpowers"})]}),n.jsx("p",{className:"text-purple-100 text-sm mb-4 leading-relaxed",children:"Get personalized insights, smart goal suggestions, and auto-generated journal prompts that make your productivity journey effortless."}),n.jsx("button",{onClick:ae,className:"bg-white text-purple-600 px-4 py-2 rounded-lg font-semibold text-sm hover:bg-purple-50 transition-colors",children:"Upgrade to Premium"})]}),n.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -translate-y-6 translate-x-6"})]}),n.jsxs(ir,{title:"Notifications",icon:n.jsx(ud,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(ud,{className:"w-4 h-4"}),iconBgColor:"bg-blue-500",title:"Push Notifications",subtitle:"Get reminders for habits and tasks",type:"toggle",checked:e.notifications.pushNotifications,onToggle:()=>t("pushNotifications")}),n.jsx(Se,{icon:n.jsx(Sr,{className:"w-4 h-4"}),iconBgColor:"bg-blue-500",title:"Reminder Time",subtitle:"When to send daily reminders",type:"value",value:e.notifications.reminderTime,onClick:R}),n.jsx(Se,{icon:n.jsx(oh,{className:"w-4 h-4"}),iconBgColor:"bg-blue-500",title:"Achievement Notifications",subtitle:"Celebrate streaks and milestones",type:"toggle",checked:e.notifications.achievementNotifications,onToggle:()=>t("achievementNotifications")})]}),n.jsxs(ir,{title:"Appearance",icon:n.jsx(md,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(kh,{className:"w-4 h-4"}),iconBgColor:"bg-gray-500",title:"Theme",subtitle:"Choose your preferred theme",type:"value",value:e.appearance.theme==="light"?"Light":"Dark",onClick:Y}),n.jsx(Se,{icon:n.jsx(md,{className:"w-4 h-4"}),iconBgColor:"bg-gray-500",title:"Accent Color",subtitle:"Customize your experience",type:"value",value:o(),onClick:oe})]}),n.jsxs(ir,{title:"Privacy & Data",icon:n.jsx(Sh,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(zs,{className:"w-4 h-4"}),iconBgColor:"bg-green-500",title:"Privacy Policy",subtitle:"How we protect your data",type:"navigate",onClick:()=>console.log("Open privacy policy")}),n.jsx(Se,{icon:n.jsx(tg,{className:"w-4 h-4"}),iconBgColor:"bg-blue-500",title:"Import Data",subtitle:"Import from Kage backups or HabitKit",type:"navigate",onClick:$e}),n.jsx(Se,{icon:n.jsx(Hl,{className:"w-4 h-4"}),iconBgColor:"bg-purple-500",title:"Data Export",subtitle:"Download your data",type:"navigate",onClick:Pe}),n.jsx(Se,{icon:n.jsx(Ri,{className:"w-4 h-4"}),iconBgColor:"bg-green-500",title:"Analytics",subtitle:"Help improve Kage",type:"toggle",checked:e.privacy.analytics,onToggle:()=>a("analytics")})]}),n.jsxs(ir,{title:"Security & Passcode",icon:n.jsx(zs,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(ps,{className:"w-4 h-4"}),iconBgColor:"bg-indigo-500",title:"Journal Passcode",subtitle:e.passcode.enabled?"Enabled - Journal protected":"Disabled - Journal accessible",type:"toggle",checked:e.passcode.enabled,onToggle:e.passcode.enabled?()=>w(!0):nt}),e.passcode.enabled&&n.jsxs(n.Fragment,{children:[n.jsx(Se,{icon:n.jsx(gd,{className:"w-4 h-4"}),iconBgColor:"bg-orange-500",title:"Change Passcode",subtitle:"Update your journal passcode",type:"navigate",onClick:()=>{Ee(),M(!0)}}),n.jsx(Se,{icon:n.jsx(Sr,{className:"w-4 h-4"}),iconBgColor:"bg-purple-500",title:"Auto-Lock Timeout",subtitle:`Lock after ${e.passcode.autoLockTimeout==="never"?"never":e.passcode.autoLockTimeout}`,type:"navigate",onClick:()=>{const A=["1min","5min","15min","30min","never"],re=(A.indexOf(e.passcode.autoLockTimeout)+1)%A.length;h(A[re])}})]})]}),n.jsxs(ir,{title:"Archive Management",icon:n.jsx(sa,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(sa,{className:"w-4 h-4"}),iconBgColor:"bg-gray-500",title:"Archived Goals",subtitle:V.length>0?`${V.length} archived goal${V.length!==1?"s":""}`:"No archived goals",type:"navigate",onClick:()=>j(!b)}),b&&V.length>0&&n.jsxs("div",{className:"mt-4 space-y-3 bg-gray-50 dark:bg-gray-900 rounded-xl p-4",children:[n.jsxs("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3",children:["Archived Goals (",V.length,")"]}),V.map(A=>n.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[n.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-sm flex-shrink-0",style:{backgroundColor:A.color},children:A.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm mb-1",children:A.name}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 line-clamp-2",children:A.description}),n.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["Archived ",new Date(A.updatedAt).toLocaleDateString()]})]})]}),n.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[n.jsx("button",{onClick:()=>st(A.id,A.name),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",title:"Unarchive goal",children:n.jsx(gd,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>B(A.id,A.name),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Permanently delete goal",children:n.jsx(ft,{className:"w-4 h-4"})})]})]})},A.id)),V.length===0&&n.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[n.jsx(sa,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"No archived goals yet."}),n.jsx("p",{className:"text-xs opacity-75",children:"Archive goals from the Goals page to manage them here."})]})]})]}),n.jsxs(ir,{title:"Premium Features",icon:n.jsx(hd,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(pd,{className:"w-4 h-4"}),iconBgColor:"bg-amber-500",title:"AI Assistant",subtitle:"Smart insights and suggestions",type:"navigate",badge:n.jsx(Q,{}),onClick:()=>console.log("Open AI settings")}),n.jsx(Se,{icon:n.jsx(Ri,{className:"w-4 h-4"}),iconBgColor:"bg-purple-500",title:"Advanced Analytics",subtitle:"Detailed progress insights",type:"navigate",badge:n.jsx(Q,{}),onClick:()=>console.log("Open analytics")}),n.jsx(Se,{icon:n.jsx(mh,{className:"w-4 h-4"}),iconBgColor:"bg-green-500",title:"Cloud Sync",subtitle:"Access anywhere",type:"navigate",badge:n.jsx(Q,{}),onClick:()=>console.log("Open cloud sync")})]}),n.jsxs(ir,{title:"Support & About",icon:n.jsx(yh,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(Nh,{className:"w-4 h-4"}),iconBgColor:"bg-blue-500",title:"Show Onboarding",subtitle:"Replay the welcome experience",type:"navigate",onClick:Te}),n.jsx(Se,{icon:n.jsx(vh,{className:"w-4 h-4"}),iconBgColor:"bg-amber-500",title:"Help & Support",subtitle:"Get help with Kage",type:"navigate",onClick:()=>console.log("Open support")}),n.jsx(Se,{icon:n.jsx(hd,{className:"w-4 h-4"}),iconBgColor:"bg-amber-500",title:"Rate Kage",subtitle:"Share your feedback",type:"navigate",onClick:()=>console.log("Open app store rating")}),n.jsx(Se,{icon:n.jsx(xh,{className:"w-4 h-4"}),iconBgColor:"bg-amber-500",title:"About Kage",subtitle:"Version, terms, and more",type:"navigate",onClick:()=>console.log("Open about page")})]}),n.jsxs(ir,{title:"Account",icon:n.jsx(rg,{className:"w-5 h-5"}),children:[n.jsx(Se,{icon:n.jsx(ps,{className:"w-4 h-4"}),iconBgColor:"bg-red-500",title:"Change Password",subtitle:"Update your password",type:"navigate",onClick:()=>console.log("Open change password")}),n.jsx(Se,{icon:n.jsx(bh,{className:"w-4 h-4"}),iconBgColor:"bg-red-500",title:"Sign Out",subtitle:"Sign out of your account",type:"navigate",onClick:Re})]}),n.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[n.jsxs("div",{className:"text-sm mb-1",children:["Kage v",e.version]}),n.jsx("div",{className:"text-xs opacity-70",children:" 2025 Kage. Made with  for productivity."})]}),n.jsx(nx,{isOpen:y,onClose:()=>p(!1)}),n.jsx(ax,{isOpen:x,onClose:()=>k(!1)}),n.jsx(ix,{isOpen:C,onClose:()=>T(!1)}),(S||_)&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full p-6",children:[n.jsx("div",{className:"flex items-center justify-between mb-6",children:n.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-3",children:[n.jsx(ps,{className:"w-6 h-6 text-indigo-500"}),e.passcode.enabled&&S?"Disable Passcode":_?"Change Passcode":"Setup Passcode"]})}),n.jsxs("div",{className:"space-y-4",children:[e.passcode.enabled&&S||_?n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Current Passcode"}),n.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:P,onChange:A=>{O(A.target.value.replace(/\D/g,"")),U("")},className:"w-full px-4 py-3 text-center text-2xl font-mono border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:""})]}):null,!(e.passcode.enabled&&S)&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:_?"New Passcode":"Enter 4-Digit Passcode"}),n.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:F,onChange:A=>{G(A.target.value.replace(/\D/g,"")),U("")},className:"w-full px-4 py-3 text-center text-2xl font-mono border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:""})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Passcode"}),n.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:L,onChange:A=>{H(A.target.value.replace(/\D/g,"")),U("")},className:"w-full px-4 py-3 text-center text-2xl font-mono border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:""})]})]}),q&&n.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:n.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:q})}),n.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:n.jsx("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:e.passcode.enabled&&S?"Enter your current passcode to disable journal protection.":_?"Enter your current passcode and choose a new 4-digit passcode.":"Choose a 4-digit numeric passcode to protect your journal entries."})})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("button",{onClick:mt,className:"flex-1 px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:Z,children:"Cancel"}),n.jsxs("button",{onClick:e.passcode.enabled&&S?ut:_?ce:at,disabled:Z,className:"flex-1 px-4 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[Z&&n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.passcode.enabled&&S?"Disable":_?"Change":"Setup"]})]})]})})]})}const cx=()=>{const{settings:e}=ar(),[t,r]=N.useState(null),[a,s]=N.useState(!1),[o,i]=N.useState(!1),[c,l]=N.useState(!1);N.useEffect(()=>{const u=/iPad|iPhone|iPod/.test(navigator.userAgent);i(u);const f=window.matchMedia("(display-mode: standalone)").matches,g=window.navigator.standalone||f;if(!g){const m=v=>{v.preventDefault(),r(v),l(!0),setTimeout(()=>{s(!0)},3e3)};return window.addEventListener("beforeinstallprompt",m),u&&!g&&setTimeout(()=>{s(!0)},5e3),()=>{window.removeEventListener("beforeinstallprompt",m)}}},[]);const d=async()=>{t&&(t.prompt(),(await t.userChoice).outcome==="accepted"?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),r(null),s(!1))},h=()=>{s(!1),sessionStorage.setItem("pwa-install-dismissed","true")};return sessionStorage.getItem("pwa-install-dismissed")||!a?null:n.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50",children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-4",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-color-light, #FB923C)",color:"var(--accent-color, #FF7101)"},children:n.jsx(Ch,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:"Install Kage App"}),n.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:o?"Add to Home Screen for the best experience":"Install for quick access and offline use"})]})]}),n.jsx("button",{onClick:h,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:n.jsx(Bt,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})})]}),n.jsx("div",{className:"mt-3 flex space-x-2",children:o?n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:["Tap ",n.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"Share"})," then",n.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-700 px-1 rounded ml-1",children:"Add to Home Screen"})]}),n.jsx("button",{onClick:h,className:"w-full px-3 py-2 text-white text-sm font-medium rounded-lg transition-colors",style:{backgroundColor:"var(--accent-color, #FF7101)"},onMouseOver:u=>{u.currentTarget.style.opacity="0.9"},onMouseOut:u=>{u.currentTarget.style.opacity="1"},children:"Got it"})]}):n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:h,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Later"}),n.jsxs("button",{onClick:d,disabled:!c,className:"flex-1 px-3 py-2 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors flex items-center justify-center space-x-1",style:{backgroundColor:c?"var(--accent-color, #FF7101)":void 0},onMouseOver:u=>{c&&(u.currentTarget.style.opacity="0.9")},onMouseOut:u=>{c&&(u.currentTarget.style.opacity="1")},children:[n.jsx(Hl,{className:"w-4 h-4"}),n.jsx("span",{children:"Install"})]})]})})]})})};class dx{constructor(){sr(this,"APP_VERSION","1.0.0");sr(this,"STORAGE_KEY","kage-app-data");sr(this,"SYNC_QUEUE_KEY","kage-sync-queue");sr(this,"LAST_SYNC_KEY","kage-last-sync")}getAllData(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Error reading offline data:",t),null}}saveAllData(t){try{const a={...this.getAllData()||{},...t,lastSync:Date.now(),version:this.APP_VERSION};return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(a)),!0}catch(r){return console.error("Error saving offline data:",r),!1}}getStoreData(t){const r=this.getAllData();return r?r[t]:null}saveStoreData(t,r){const a=this.getAllData()||{};return a[t]=r,this.saveAllData(a)}isDataStale(){const t=this.getAllData();if(!t||!t.lastSync)return!0;const r=24*60*60*1e3;return Date.now()-t.lastSync>r}getStorageInfo(){try{const t=JSON.stringify(this.getAllData()),r=new Blob([t]).size,a=5*1024*1024,s=a-r,o=r/a*100;return{used:r,available:s,percentage:o,quota:a}}catch(t){return console.error("Error calculating storage info:",t),{used:0,available:0,percentage:0,quota:0}}}cleanupOldData(){try{const t=this.getAllData();if(!t)return!0;if(t.journal&&t.journal.length>100&&(t.journal=t.journal.sort((r,a)=>new Date(a.date).getTime()-new Date(r.date).getTime()).slice(0,100)),t.calendar){const r=Date.now()-2592e6;t.calendar=t.calendar.filter(a=>new Date(a.date).getTime()>r)}if(t.tasks){const r=Date.now()-6048e5;t.tasks=t.tasks.filter(a=>!a.completed||new Date(a.completedAt||a.createdAt).getTime()>r)}return this.saveAllData(t)}catch(t){return console.error("Error cleaning up old data:",t),!1}}addToSyncQueue(t){try{const r=this.getSyncQueue();r.push(t),localStorage.setItem(this.SYNC_QUEUE_KEY,JSON.stringify(r))}catch(r){console.error("Error adding to sync queue:",r)}}getSyncQueue(){try{const t=localStorage.getItem(this.SYNC_QUEUE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading sync queue:",t),[]}}clearSyncQueue(){try{localStorage.removeItem(this.SYNC_QUEUE_KEY)}catch(t){console.error("Error clearing sync queue:",t)}}async processSyncQueue(){const t=this.getSyncQueue(),r=[],a=[];for(const o of t)try{await new Promise(i=>setTimeout(i,100)),console.log(`Syncing ${o.type} ${o.store}:${o.id}`),r.push(`${o.store}:${o.id}`)}catch(i){console.error(`Failed to sync ${o.store}:${o.id}`,i),a.push(`${o.store}:${o.id}`)}const s=Date.now();return localStorage.setItem(this.LAST_SYNC_KEY,s.toString()),a.length===0&&this.clearSyncQueue(),{success:a.length===0,synced:r,failed:a,lastSync:s}}getLastSyncTime(){try{const t=localStorage.getItem(this.LAST_SYNC_KEY);return t?parseInt(t):0}catch(t){return console.error("Error reading last sync time:",t),0}}exportData(){const t=this.getAllData();return JSON.stringify(t,null,2)}importData(t){try{const r=JSON.parse(t);if(!r||typeof r!="object")throw new Error("Invalid data format");const a=this.getAllData();return localStorage.setItem("kage-backup-"+Date.now(),JSON.stringify(a)),this.saveAllData(r)}catch(r){return console.error("Error importing data:",r),!1}}isOffline(){return!navigator.onLine}getOfflineStatus(){return{isOffline:this.isOffline(),hasQueuedChanges:this.getSyncQueue().length>0,queueLength:this.getSyncQueue().length,lastSync:this.getLastSyncTime()}}}const Zr=new dx,ux=()=>{const[e,t]=N.useState(!navigator.onLine),[r,a]=N.useState("idle"),[s,o]=N.useState(0),[i,c]=N.useState(!1);if(N.useEffect(()=>{const f=()=>{t(!1),m()},g=()=>{t(!0),a("idle")},m=async()=>{const y=Zr.getSyncQueue();if(y.length>0){a("syncing");try{const p=await Zr.processSyncQueue();a(p.success?"success":"error"),o(y.length-p.synced.length)}catch{a("error")}setTimeout(()=>a("idle"),3e3)}},v=()=>{o(Zr.getSyncQueue().length)};window.addEventListener("online",f),window.addEventListener("offline",g);const D=setInterval(v,5e3);return v(),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",g),clearInterval(D)}},[]),!e&&r==="idle"&&s===0)return null;const l=()=>{if(e)return n.jsx(Eh,{className:"w-4 h-4 text-red-500"});switch(r){case"syncing":return n.jsx(_o,{className:"w-4 h-4 text-blue-500 animate-spin"});case"success":return n.jsx(vn,{className:"w-4 h-4 text-green-500"});case"error":return n.jsx(Ph,{className:"w-4 h-4 text-red-500"});default:return s>0?n.jsx(_o,{className:"w-4 h-4 text-orange-500"}):n.jsx(Ih,{className:"w-4 h-4 text-green-500"})}},d=()=>{if(e)return s>0?`Offline (${s} pending)`:"Offline";switch(r){case"syncing":return"Syncing...";case"success":return"Synced";case"error":return"Sync failed";default:return s>0?`${s} pending`:"Online"}},h=()=>{if(e)return"bg-red-100 border-red-200 text-red-800 dark:bg-red-900 dark:border-red-700 dark:text-red-200";switch(r){case"syncing":return"bg-blue-100 border-blue-200 text-blue-800 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-200";case"success":return"bg-green-100 border-green-200 text-green-800 dark:bg-green-900 dark:border-green-700 dark:text-green-200";case"error":return"bg-red-100 border-red-200 text-red-800 dark:bg-red-900 dark:border-red-700 dark:text-red-200";default:return s>0?"bg-orange-100 border-orange-200 text-orange-800 dark:bg-orange-900 dark:border-orange-700 dark:text-orange-200":"bg-green-100 border-green-200 text-green-800 dark:bg-green-900 dark:border-green-700 dark:text-green-200"}},u=async()=>{if(!e&&s>0){a("syncing");try{const f=await Zr.processSyncQueue();a(f.success?"success":"error"),o(f.failed.length)}catch{a("error")}setTimeout(()=>a("idle"),3e3)}};return n.jsxs("div",{className:"fixed top-4 right-4 z-50",children:[n.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg border text-sm font-medium transition-all duration-200 cursor-pointer ${h()}`,onClick:()=>c(!i),children:[l(),n.jsx("span",{children:d()})]}),i&&n.jsx("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-4 text-sm",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),n.jsx("span",{className:e?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",children:e?"Offline":"Online"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Pending sync:"}),n.jsx("span",{className:"text-gray-900 dark:text-white",children:s})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Last sync:"}),n.jsx("span",{className:"text-gray-900 dark:text-white",children:Zr.getLastSyncTime()>0?new Date(Zr.getLastSyncTime()).toLocaleTimeString():"Never"})]}),!e&&s>0&&n.jsxs("button",{onClick:u,disabled:r==="syncing",className:"w-full mt-3 px-3 py-2 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-colors flex items-center justify-center space-x-1",children:[n.jsx(_o,{className:`w-4 h-4 ${r==="syncing"?"animate-spin":""}`}),n.jsx("span",{children:r==="syncing"?"Syncing...":"Sync Now"})]})]})})]})};class Ld extends N.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("ErrorBoundary caught an error:",t,r);const a=window.matchMedia("(display-mode: standalone)").matches;console.error("Error occurred in PWA mode:",a),console.error("User Agent:",navigator.userAgent),console.error("Location:",window.location.href)}render(){return this.state.hasError?this.props.fallback||n.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-4xl mb-4",children:""}),n.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Something went wrong"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"The app encountered an unexpected error. Please try refreshing the page."}),n.jsx("button",{onClick:()=>window.location.reload(),className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Refresh App"}),!1]})})}):this.props.children}}function mx(){return n.jsxs("div",{className:"h-full bg-gradient-to-br from-orange-500 to-orange-400 text-white flex flex-col justify-center items-center text-center px-10 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-72 h-72 bg-white/10 rounded-full -translate-y-1/3 translate-x-1/3"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-1/4 -translate-x-1/4"}),n.jsxs("div",{className:"relative z-10 max-w-md",children:[n.jsx("div",{className:"text-8xl mb-6 animate-bounce",children:""}),n.jsx("h1",{className:"text-4xl font-bold mb-4 leading-tight",children:"Welcome to Kage"}),n.jsx("p",{className:"text-lg opacity-90 mb-12 leading-relaxed",children:"Turn your goals into reality with the productivity app that connects everything you do to what matters most."}),n.jsxs("div",{className:"flex justify-center gap-8 mb-12",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-sm font-semibold opacity-90",children:"Goal-Centric"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-sm font-semibold opacity-90",children:"Smart Tracking"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"text-sm font-semibold opacity-90",children:"AI-Powered"})]})]})]}),n.jsx("style",{jsx:!0,children:`
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-10px); }
        }
        .animate-bounce {
          animation: float 3s ease-in-out infinite;
        }
      `})]})}function gx(){const{getCategories:e,setSelectedCategory:t,onboardingData:r}=Fn(),a=e(),s=o=>{t(o)};return n.jsxs("div",{className:"h-full bg-gradient-to-br from-purple-600 to-purple-500 text-white px-5 py-10 overflow-y-auto",children:[n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full -translate-y-1/4 translate-x-1/4"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full translate-y-1/3 -translate-x-1/3"}),n.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-10",children:[n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Choose Your Focus Area"}),n.jsx("p",{className:"text-base opacity-90 max-w-lg mx-auto leading-relaxed",children:"Which area of your life would you like to improve first? We'll help you create your first goal."})]}),n.jsx("div",{className:"grid grid-cols-2 gap-4 mb-8",children:a.map(o=>n.jsxs("button",{onClick:()=>s(o.id),className:`
                p-6 rounded-2xl border-2 transition-all duration-300 text-center relative overflow-hidden
                ${r.selectedCategory===o.id?"border-white/40 bg-white/15 shadow-lg transform -translate-y-1":"border-transparent bg-white/10 hover:bg-white/15 hover:border-white/30 hover:-translate-y-1"}
              `,children:[n.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 bg-white/10 rounded-full -translate-y-3 translate-x-3 transition-all duration-300"}),n.jsxs("div",{className:"relative z-10",children:[n.jsx("div",{className:"text-4xl mb-3",children:o.icon}),n.jsx("h3",{className:"text-base font-semibold mb-1",children:o.name}),n.jsx("p",{className:"text-xs opacity-75",children:o.description})]})]},o.id))})]})]})}function px(){const{getTemplatesForCategory:e,setSelectedTemplate:t,onboardingData:r}=Fn(),a=e(r.selectedCategory||""),s=o=>{t(o)};return n.jsxs("div",{className:"h-full bg-gradient-to-br from-green-500 to-teal-400 text-white px-5 py-10 overflow-y-auto",children:[n.jsx("div",{className:"absolute top-0 right-0 w-56 h-56 bg-white/5 rounded-full -translate-y-1/4 translate-x-1/4"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-white/10 rounded-full translate-y-1/3 -translate-x-1/3"}),n.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-10",children:[n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Choose Your First Goal"}),n.jsx("p",{className:"text-base opacity-90 max-w-lg mx-auto leading-relaxed",children:"Pick a proven template to get started quickly, or create a custom goal later."})]}),n.jsx("div",{className:"space-y-4 mb-8",children:a.map(o=>{var i;return n.jsxs("button",{onClick:()=>s(o),className:`
                w-full p-5 rounded-2xl border-2 transition-all duration-300 text-left relative overflow-hidden
                ${((i=r.selectedTemplate)==null?void 0:i.id)===o.id?"border-white/40 bg-white/15 shadow-lg transform -translate-y-1":"border-transparent bg-white/10 hover:bg-white/15 hover:border-white/30 hover:-translate-y-1"}
              `,children:[n.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-white/5 rounded-full -translate-y-4 translate-x-4"}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-2xl flex-shrink-0",children:o.icon}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold mb-1",children:o.name}),n.jsx("p",{className:"text-xs opacity-75",children:o.duration})]})]}),n.jsx("p",{className:"text-sm opacity-90 mb-3 leading-relaxed",children:o.description}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-sm",children:""}),n.jsxs("span",{className:"text-xs opacity-80",children:[o.taskCount," tasks"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-sm",children:""}),n.jsxs("span",{className:"text-xs opacity-80",children:[o.habitCount," habits"]})]})]})]})]},o.id)})})]})]})}function hx(){return n.jsxs("div",{className:"h-full bg-gradient-to-br from-purple-600 to-indigo-600 text-white flex flex-col justify-center items-center text-center px-10 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/3 translate-x-1/3"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-1/4 -translate-x-1/4"}),n.jsxs("div",{className:"relative z-10 max-w-md",children:[n.jsx("div",{className:"w-32 h-32 bg-white/10 rounded-3xl flex items-center justify-center text-6xl mb-8 mx-auto animate-pulse",children:""}),n.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Meet Your AI Assistant"}),n.jsx("p",{className:"text-base opacity-90 mb-8 leading-relaxed",children:"Kage's AI helps you stay motivated, provides insights, and suggests improvements to achieve your goals faster."}),n.jsxs("div",{className:"space-y-4 mb-10 text-left",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/10 rounded-xl",children:[n.jsx("span",{className:"text-xl flex-shrink-0",children:""}),n.jsx("span",{className:"text-sm font-medium",children:"Smart insights about your productivity patterns"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/10 rounded-xl",children:[n.jsx("span",{className:"text-xl flex-shrink-0",children:""}),n.jsx("span",{className:"text-sm font-medium",children:"Personalized suggestions for habits and tasks"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/10 rounded-xl",children:[n.jsx("span",{className:"text-xl flex-shrink-0",children:""}),n.jsx("span",{className:"text-sm font-medium",children:"AI chat for motivation and strategy advice"})]})]}),n.jsxs("div",{className:"bg-white/10 rounded-2xl p-5 mb-8",children:[n.jsx("p",{className:"text-sm opacity-90 mb-3",children:"Available with Kage Premium"}),n.jsx("p",{className:"text-base font-semibold text-yellow-300",children:"7-day free trial  $9.99/month"})]})]}),n.jsx("style",{jsx:!0,children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
        .animate-pulse {
          animation: pulse 2s ease-in-out infinite;
        }
      `})]})}function fx(){const{onboardingData:e}=Fn(),t=e.selectedTemplate;return n.jsxs("div",{className:"h-full bg-gradient-to-br from-orange-500 to-orange-400 text-white flex flex-col justify-center items-center text-center px-10 relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-72 h-72 bg-white/10 rounded-full -translate-y-1/3 translate-x-1/3"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-1/4 -translate-x-1/4"}),n.jsxs("div",{className:"relative z-10 max-w-md",children:[n.jsx("div",{className:"text-8xl mb-8 animate-bounce",children:""}),n.jsx("h2",{className:"text-4xl font-bold mb-4",children:"You're All Set!"}),n.jsx("p",{className:"text-lg opacity-90 mb-10 leading-relaxed",children:t?`Your "${t.name}" goal is ready. Let's start building the habits that will make it happen.`:"You're ready to start achieving your goals with Kage!"}),n.jsxs("div",{className:"grid grid-cols-3 gap-5 mb-12",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold mb-1",children:"1"}),n.jsx("div",{className:"text-xs opacity-80 uppercase tracking-wide",children:"Goal Created"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold mb-1",children:(t==null?void 0:t.taskCount)||3}),n.jsx("div",{className:"text-xs opacity-80 uppercase tracking-wide",children:"Tasks Added"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold mb-1",children:(t==null?void 0:t.habitCount)||2}),n.jsx("div",{className:"text-xs opacity-80 uppercase tracking-wide",children:"Habits Suggested"})]})]})]}),n.jsx("style",{jsx:!0,children:`
        @keyframes bounce {
          0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
          40% { transform: translateY(-10px); }
          60% { transform: translateY(-5px); }
        }
        .animate-bounce {
          animation: bounce 2s ease-in-out infinite;
        }
      `})]})}function yx({onComplete:e}){const{currentStep:t,nextStep:r,previousStep:a,completeOnboarding:s,onboardingData:o}=Fn(),[i,c]=N.useState(null),[l,d]=N.useState(null);N.useEffect(()=>{const y=x=>{c(x.touches[0].clientX),d(x.touches[0].clientY)},p=x=>{if(!i||!l)return;const k=x.changedTouches[0].clientX,C=x.changedTouches[0].clientY,T=i-k,b=l-C;Math.abs(T)>Math.abs(b)&&Math.abs(T)>50&&(T>0?h():T<0&&u()),c(null),d(null)};return document.addEventListener("touchstart",y),document.addEventListener("touchend",p),()=>{document.removeEventListener("touchstart",y),document.removeEventListener("touchend",p)}},[i,l]),N.useEffect(()=>{const y=p=>{p.key==="ArrowRight"||p.key==="Enter"?h():p.key==="ArrowLeft"?u():p.key==="Escape"&&f()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[]);const h=()=>{if(t==="category"&&!o.selectedCategory){alert("Please select a category first!");return}if(t==="template"&&!o.selectedTemplate){alert("Please choose a goal template!");return}t==="ready"?g():r()},u=()=>{t!=="welcome"&&a()},f=()=>{confirm("Skip onboarding and go to dashboard?")&&g()},g=()=>{s(),e()},m=()=>{const y=["welcome","category","template","ai","ready"],p=y.indexOf(t);return y.map((x,k)=>n.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${k===p?"w-6 bg-white":"w-2 bg-white/30"}`},k))},v=t!=="welcome",D=t==="ready";return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",style:{paddingTop:"env(safe-area-inset-top)"},children:[n.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10",children:m()}),n.jsx("button",{onClick:f,className:"absolute top-4 right-5 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors z-10",children:"Skip"}),n.jsxs("div",{className:"h-full",children:[t==="welcome"&&n.jsx(mx,{}),t==="category"&&n.jsx(gx,{}),t==="template"&&n.jsx(px,{}),t==="ai"&&n.jsx(hx,{}),t==="ready"&&n.jsx(fx,{})]}),n.jsxs("div",{className:"absolute bottom-10 left-1/2 transform -translate-x-1/2 flex gap-4 z-10",children:[v&&n.jsx("button",{onClick:u,className:"px-8 py-3 bg-white/20 hover:bg-white/30 text-white rounded-xl font-medium transition-colors border border-white/30",children:"Back"}),n.jsx("button",{onClick:h,className:"px-8 py-3 bg-white hover:bg-gray-100 text-gray-900 rounded-xl font-medium transition-all hover:shadow-lg hover:-translate-y-0.5",children:D?"Start Using Kage":t==="category"&&!o.selectedCategory?"Choose Category":t==="template"&&!o.selectedTemplate?"Choose Template":t==="template"?"Create Goal":t==="ai"?"Continue Free":"Continue"})]})]})}function xx(){const[e,t]=N.useState("dashboard"),{settings:r,initializeSettings:a,isOnboardingCompleted:s,checkAndUpdateLockState:o}=ar(),{isOnboardingActive:i}=Fn(),{initializeApp:c}=Pa();N.useEffect(()=>{try{ay(),a(),wr.isNativePlatform()&&(console.log(" Mobile platform detected - forcing passcode state check"),setTimeout(()=>{var m;const g=o();console.log(" Mobile passcode initialization complete:",{passcodeEnabled:(m=r.passcode)==null?void 0:m.enabled,lockState:g,platform:wr.getPlatform()})},200)),c();const f=g=>{if(!(g.target instanceof HTMLInputElement||g.target instanceof HTMLTextAreaElement)){if(g.ctrlKey||g.metaKey)switch(g.key){case"k":g.preventDefault(),console.log("Quick search shortcut activated");break;case"1":g.preventDefault(),t("goals");break;case"2":g.preventDefault(),t("tasks");break;case"3":g.preventDefault(),t("dashboard");break;case"4":g.preventDefault(),t("habits");break;case"5":g.preventDefault(),t("journal");break;case",":g.preventDefault(),t("settings");break}g.key}};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)}catch(f){Us(f,"App initialization")}},[]),N.useEffect(()=>{const f=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches,m=new URLSearchParams(window.location.search).get("action");if(console.log("PWA Detection:",{isPWA:f,currentPath:window.location.pathname,search:window.location.search,action:m}),m){switch(m){case"create":window.location.pathname.includes("goals")?t("goals"):window.location.pathname.includes("tasks")?t("tasks"):window.location.pathname.includes("habits")?t("habits"):window.location.pathname.includes("journal")&&t("journal");break;case"complete":window.location.pathname.includes("habits")&&t("habits");break}window.history.replaceState({},"","/kage-app/")}},[]),N.useEffect(()=>{r.appearance.theme==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[r.appearance.theme]),Ul(()=>{e==="dashboard"?wr.isNativePlatform()&&ge(async()=>{const{App:f}=await Promise.resolve().then(()=>gg);return{App:f}},void 0,import.meta.url).then(({App:f})=>{f.minimizeApp()}):t("dashboard")},!0);const d=[{id:"goals",label:"Goals",icon:oa},{id:"tasks",label:"Tasks",icon:dh},{id:"dashboard",label:"Dashboard",icon:Ri},{id:"habits",label:"Habits",icon:fh},{id:"journal",label:"Journal",icon:ih}],h=()=>{switch(e){case"dashboard":return n.jsx(Id,{onNavigate:t});case"goals":return n.jsx(by,{onNavigate:t});case"tasks":return n.jsx(jy,{onNavigate:t});case"habits":return n.jsx(Dy,{onNavigate:t});case"calendar":return n.jsx(Qy,{});case"journal":return n.jsx(Zy,{});case"settings":return n.jsx(lx,{});default:return n.jsx(Id,{onNavigate:t})}},u=()=>{};return!s()&&r.firstLaunch||i?n.jsx(Ld,{children:n.jsx(yx,{onComplete:u})}):n.jsx(Ld,{children:n.jsxs("div",{className:"w-full max-w-md mx-auto min-h-screen bg-gray-50 dark:bg-gray-900 shadow-xl overflow-hidden flex flex-col",style:{paddingTop:"env(safe-area-inset-top)"},children:[n.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:n.jsxs("div",{className:"px-4 py-3 flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Kage"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Goal-Centric Productivity"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"w-9 h-9 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:n.jsx(Dh,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),n.jsx("button",{onClick:()=>t("calendar"),className:`w-9 h-9 rounded-lg flex items-center justify-center transition-colors ${e==="calendar"?"accent-bg-100 dark:accent-bg-900 accent-text-600 dark:accent-text-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,style:e==="calendar"?{backgroundColor:"var(--accent-color-light, #FB923C)",color:"var(--accent-color, #FF7101)"}:{},children:n.jsx(zr,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>t("settings"),className:`w-9 h-9 rounded-lg flex items-center justify-center transition-colors ${e==="settings"?"accent-bg-100 dark:accent-bg-900 accent-text-600 dark:accent-text-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,style:e==="settings"?{backgroundColor:"var(--accent-color-light, #FB923C)",color:"var(--accent-color, #FF7101)"}:{},children:n.jsx(eg,{className:"w-5 h-5"})})]})]})}),n.jsx("main",{className:"flex-1 overflow-y-auto px-2 py-3 pb-24 scroll-smooth scrollbar-hide",children:h()}),n.jsx("nav",{className:"fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-md bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 backdrop-blur-sm bg-white/95 dark:bg-gray-800/95",children:n.jsx("div",{className:"flex justify-around py-2",children:d.map(f=>{const g=f.icon;return n.jsxs("button",{onClick:()=>t(f.id),className:`flex flex-col items-center py-2 px-2 rounded-lg transition-colors ${e===f.id?"accent-text-500 accent-bg-50 dark:accent-bg-900 dark:accent-text-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,style:e===f.id?{backgroundColor:"var(--accent-color-light, #FB923C)",color:"var(--accent-color, #FF7101)"}:{},children:[n.jsx(g,{className:"w-4 h-4 mb-1"}),n.jsx("span",{className:"text-xs",children:f.label})]},f.id)})})}),n.jsx(cx,{}),n.jsx(ux,{})]})})}wr.isNativePlatform()&&(console.log(" Running on native platform - initializing mobile plugins"),ge(async()=>{const{App:e}=await Promise.resolve().then(()=>gg);return{App:e}},void 0,import.meta.url).then(({App:e})=>{console.log(" App plugin loaded successfully")}).catch(e=>{console.error(" Failed to load App plugin:",e)}));"serviceWorker"in navigator&&(navigator.serviceWorker.getRegistrations().then(e=>{for(const t of e)console.log("Unregistering service worker:",t),t.unregister()}),"caches"in window&&caches.keys().then(e=>Promise.all(e.map(t=>(console.log("Deleting cache:",t),caches.delete(t))))).then(()=>{console.log("All caches cleared")}));Wo.createRoot(document.getElementById("root")).render(n.jsx(Vd.StrictMode,{children:n.jsx(xx,{})}));export{ng as W,ge as _,Rh as b,Gl as r};
