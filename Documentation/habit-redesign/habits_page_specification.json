{
  "pageSpecification": {
    "title": "Habits Page Redesign - List View with Detail Modal",
    "description": "Complete specification for implementing the habits page with list view and slide-up detail modal functionality",
    "version": "2.0",
    "lastUpdated": "2025-07-18"
  },
  
  "architecture": {
    "pageLayout": "list_view_only",
    "modalType": "slide_up_from_bottom",
    "viewSystem": "single_view",
    "interactionPattern": "click_to_detail"
  },
  
  "components": {
    "HabitsPage": {
      "description": "Main page component containing header, list, and modal",
      "structure": [
        "PageHeader",
        "HabitsList", 
        "HabitDetailModal",
        "BottomNavigation"
      ]
    },
    
    "PageHeader": {
      "elements": {
        "logo": {
          "text": "üèÆ Kage",
          "fontSize": "18px",
          "fontWeight": 600
        },
        "title": {
          "text": "Habits",
          "fontSize": "24px",
          "fontWeight": 600,
          "color": "#1a202c"
        },
        "addButton": {
          "size": "44px",
          "backgroundColor": "#ff7101",
          "borderRadius": "12px",
          "icon": "+",
          "action": "openHabitCreationModal"
        },
        "headerActions": [
          {
            "icon": "üìä",
            "action": "openAnalytics",
            "tooltip": "Analytics"
          },
          {
            "icon": "‚öôÔ∏è", 
            "action": "openSettings",
            "tooltip": "Settings"
          }
        ]
      }
    },
    
    "HabitsList": {
      "layout": "vertical_stack",
      "gap": "12px",
      "maxWidth": "600px",
      "centerAlign": true,
      
      "HabitListItem": {
        "structure": {
          "container": {
            "backgroundColor": "white",
            "borderRadius": "12px",
            "padding": "16px",
            "boxShadow": "0 2px 8px rgba(0,0,0,0.1)",
            "border": "1px solid #e2e8f0",
            "leftBorder": {
              "width": "4px",
              "color": "var(--habit-color)"
            },
            "cursor": "pointer",
            "hoverEffect": {
              "transform": "translateY(-1px)",
              "boxShadow": "0 4px 16px rgba(0,0,0,0.15)"
            }
          },
          
          "header": {
            "layout": "horizontal",
            "alignItems": "center",
            "gap": "12px",
            "marginBottom": "12px",
            
            "elements": [
              {
                "type": "habitIcon",
                "size": "44px",
                "borderRadius": "12px",
                "backgroundColor": "var(--habit-color)",
                "fontSize": "22px",
                "color": "white"
              },
              {
                "type": "habitInfo",
                "flex": 1,
                "elements": [
                  {
                    "type": "habitName",
                    "fontSize": "18px",
                    "fontWeight": 600,
                    "color": "#1a202c",
                    "marginBottom": "4px"
                  },
                  {
                    "type": "habitMeta",
                    "layout": "horizontal",
                    "gap": "16px",
                    "fontSize": "13px",
                    "elements": [
                      {
                        "type": "frequency",
                        "color": "#718096",
                        "fontWeight": 500
                      },
                      {
                        "type": "completionRate", 
                        "fontWeight": 600,
                        "colorMapping": {
                          "good": "#10B981",
                          "medium": "#F59E0B", 
                          "poor": "#EF4444"
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "type": "streakInfo",
                "backgroundColor": "rgba(255, 113, 1, 0.1)",
                "padding": "8px 12px",
                "borderRadius": "10px",
                "fontSize": "14px",
                "fontWeight": 600,
                "color": "#ff7101",
                "elements": [
                  {
                    "type": "streakIcon", 
                    "content": "üî•"
                  },
                  {
                    "type": "streakValue",
                    "format": "{value} {unit}"
                  }
                ]
              },
              {
                "type": "completionButton",
                "size": "48px",
                "border": "3px solid #e2e8f0",
                "borderRadius": "12px",
                "backgroundColor": "white",
                "fontSize": "20px",
                "color": "#a0aec0",
                "icon": "‚úì",
                "hoverEffect": {
                  "borderColor": "var(--habit-color)",
                  "color": "var(--habit-color)",
                  "transform": "scale(1.05)"
                },
                "completedState": {
                  "backgroundColor": "var(--habit-color)",
                  "borderColor": "var(--habit-color)",
                  "color": "white"
                },
                "action": "toggleHabitCompletion",
                "stopPropagation": true
              }
            ]
          },
          
          "progressGrid": {
            "layout": "horizontal",
            "gap": "4px",
            "marginTop": "8px",
            
            "progressDay": {
              "size": "18px",
              "borderRadius": "4px",
              "backgroundColor": "#f1f5f9",
              "border": "1px solid #e2e8f0",
              "states": {
                "completed": {
                  "backgroundColor": "var(--habit-color)",
                  "borderColor": "var(--habit-color)"
                },
                "today": {
                  "border": "2px dashed var(--habit-color)",
                  "backgroundColor": "white"
                },
                "notRequired": {
                  "backgroundColor": "#f8f9fa",
                  "borderColor": "#e9ecef",
                  "opacity": 0.4
                }
              }
            }
          }
        },
        
        "onClick": "openHabitDetailModal"
      }
    },
    
    "HabitDetailModal": {
      "type": "slide_up_modal",
      "position": "fixed_bottom",
      "animation": {
        "slideUp": {
          "duration": "300ms",
          "easing": "ease",
          "transform": "translateY(0)"
        },
        "slideDown": {
          "duration": "300ms", 
          "easing": "ease",
          "transform": "translateY(100%)"
        }
      },
      
      "overlay": {
        "backgroundColor": "rgba(0, 0, 0, 0.5)",
        "zIndex": 1000,
        "onClick": "closeModal"
      },
      
      "container": {
        "backgroundColor": "white",
        "borderRadius": "20px 20px 0 0",
        "maxHeight": "90vh",
        "overflowY": "auto",
        "zIndex": 1001
      },
      
      "structure": [
        "ModalHeader",
        "ModalContent"
      ],
      
      "ModalHeader": {
        "padding": "20px",
        "borderBottom": "1px solid #e2e8f0",
        
        "elements": [
          {
            "type": "habitInfo",
            "layout": "horizontal",
            "alignItems": "center",
            "gap": "12px",
            "marginBottom": "8px",
            
            "elements": [
              {
                "type": "habitIcon",
                "size": "48px",
                "borderRadius": "14px",
                "backgroundColor": "var(--habit-color)",
                "fontSize": "24px",
                "color": "white"
              },
              {
                "type": "habitDetails",
                "elements": [
                  {
                    "type": "habitName",
                    "fontSize": "20px",
                    "fontWeight": 700,
                    "color": "#1a202c"
                  },
                  {
                    "type": "habitDescription",
                    "fontSize": "14px",
                    "color": "#718096",
                    "marginTop": "4px"
                  }
                ]
              }
            ]
          },
          {
            "type": "closeButton",
            "position": "absolute",
            "top": "20px",
            "right": "20px",
            "size": "36px",
            "backgroundColor": "#f7fafc",
            "borderRadius": "8px",
            "fontSize": "18px",
            "color": "#718096",
            "icon": "‚úï",
            "action": "closeModal"
          }
        ]
      },
      
      "ModalContent": {
        "padding": "20px",
        
        "sections": [
          {
            "type": "statsSection",
            "layout": "grid",
            "columns": 2,
            "gap": "16px",
            "marginBottom": "24px",
            
            "statItem": {
              "backgroundColor": "#f7fafc",
              "padding": "16px",
              "borderRadius": "12px",
              "textAlign": "center",
              
              "elements": [
                {
                  "type": "statValue",
                  "fontSize": "24px",
                  "fontWeight": 700,
                  "color": "var(--habit-color)",
                  "marginBottom": "4px"
                },
                {
                  "type": "statLabel",
                  "fontSize": "12px",
                  "color": "#718096",
                  "textTransform": "uppercase",
                  "letterSpacing": "0.5px"
                }
              ]
            },
            
            "stats": [
              {
                "id": "currentStreak",
                "label": "Current Streak"
              },
              {
                "id": "frequency",
                "label": "Frequency"
              }
            ]
          },
          
          {
            "type": "actionsSection",
            "layout": "horizontal",
            "gap": "12px",
            "marginBottom": "24px",
            
            "actionButton": {
              "flex": 1,
              "padding": "12px 16px",
              "border": "2px solid #e2e8f0",
              "backgroundColor": "white",
              "borderRadius": "10px",
              "fontWeight": 600,
              "fontSize": "14px",
              "layout": "horizontal",
              "alignItems": "center",
              "justifyContent": "center",
              "gap": "8px",
              "cursor": "pointer"
            },
            
            "buttons": [
              {
                "type": "edit",
                "text": "Edit Habit",
                "icon": "‚úèÔ∏è",
                "color": "#3B82F6",
                "borderColor": "#3B82F6",
                "action": "editHabit"
              },
              {
                "type": "delete",
                "text": "Delete",
                "icon": "üóëÔ∏è",
                "color": "#EF4444", 
                "borderColor": "#EF4444",
                "action": "deleteHabit"
              }
            ]
          },
          
          {
            "type": "calendarSection",
            "marginBottom": "20px",
            
            "elements": [
              {
                "type": "sectionTitle",
                "text": "Progress Calendar",
                "fontSize": "16px",
                "fontWeight": 600,
                "color": "#1a202c",
                "marginBottom": "16px"
              },
              {
                "type": "calendarHeader",
                "layout": "horizontal",
                "justifyContent": "space-between",
                "alignItems": "center",
                "marginBottom": "16px",
                
                "elements": [
                  {
                    "type": "monthTitle",
                    "fontSize": "18px",
                    "fontWeight": 600,
                    "color": "#1a202c",
                    "format": "{monthName} {year}"
                  },
                  {
                    "type": "calendarNav",
                    "layout": "horizontal",
                    "gap": "8px",
                    
                    "navButton": {
                      "size": "36px",
                      "backgroundColor": "#f7fafc",
                      "borderRadius": "8px",
                      "fontSize": "16px",
                      "color": "#718096",
                      "border": "none",
                      "cursor": "pointer"
                    },
                    
                    "buttons": [
                      {
                        "type": "previous",
                        "icon": "‚Äπ",
                        "action": "previousMonth"
                      },
                      {
                        "type": "next", 
                        "icon": "‚Ä∫",
                        "action": "nextMonth"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "calendarGrid",
                "display": "grid",
                "gridTemplateColumns": "repeat(7, 1fr)",
                "gap": "2px",
                
                "dayHeader": {
                  "textAlign": "center",
                  "fontSize": "12px",
                  "fontWeight": 600,
                  "color": "#718096",
                  "padding": "8px 0",
                  "labels": ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
                },
                
                "calendarDay": {
                  "aspectRatio": 1,
                  "display": "flex",
                  "alignItems": "center",
                  "justifyContent": "center",
                  "fontSize": "14px",
                  "borderRadius": "6px",
                  "cursor": "pointer",
                  "transition": "all 0.2s",
                  
                  "states": {
                    "default": {
                      "hover": {
                        "backgroundColor": "rgba(255, 113, 1, 0.1)"
                      }
                    },
                    "completed": {
                      "backgroundColor": "var(--habit-color)",
                      "color": "white"
                    },
                    "today": {
                      "backgroundColor": "rgba(255, 113, 1, 0.2)",
                      "fontWeight": 600
                    },
                    "otherMonth": {
                      "color": "#cbd5e0"
                    }
                  },
                  
                  "onClick": "toggleCalendarDay"
                }
              }
            ]
          }
        ]
      }
    }
  },
  
  "dataStructure": {
    "Habit": {
      "id": "string",
      "name": "string",
      "icon": "string (emoji)",
      "color": "string (hex)",
      "description": "string",
      "frequency": {
        "type": "daily | weekly | custom",
        "selectedDays": "number[] (for weekly)",
        "targetCount": "number (for custom)",
        "period": "week | month (for custom)"
      },
      "streak": {
        "current": "number",
        "longest": "number",
        "unit": "days | weeks | periods"
      },
      "completions": "HabitCompletion[]",
      "completionRate": "number (percentage)",
      "isCompletedToday": "boolean",
      "createdAt": "date",
      "updatedAt": "date"
    },
    
    "HabitCompletion": {
      "id": "string",
      "habitId": "string",
      "date": "date",
      "completed": "boolean",
      "value": "number (optional, for quantified habits)",
      "notes": "string (optional)"
    }
  },
  
  "apiEndpoints": {
    "habits": {
      "getAll": {
        "method": "GET",
        "url": "/api/habits",
        "response": "Habit[]",
        "includes": "last 7 days completion data"
      },
      "getById": {
        "method": "GET", 
        "url": "/api/habits/{id}",
        "response": "Habit with full completion history"
      },
      "create": {
        "method": "POST",
        "url": "/api/habits",
        "body": "Partial<Habit>",
        "response": "Habit"
      },
      "update": {
        "method": "PUT",
        "url": "/api/habits/{id}",
        "body": "Partial<Habit>",
        "response": "Habit"
      },
      "delete": {
        "method": "DELETE",
        "url": "/api/habits/{id}",
        "response": "success boolean"
      },
      "complete": {
        "method": "POST",
        "url": "/api/habits/{id}/complete",
        "body": {
          "date": "date",
          "completed": "boolean",
          "value": "number (optional)"
        },
        "response": "updated Habit with new streak"
      },
      "getCompletions": {
        "method": "GET",
        "url": "/api/habits/{id}/completions",
        "params": {
          "startDate": "date",
          "endDate": "date"
        },
        "response": "HabitCompletion[]"
      }
    }
  },
  
  "streakCalculationLogic": {
    "daily": {
      "description": "Count consecutive completed days from today backwards",
      "resetCondition": "Any missed day breaks the streak",
      "calculation": "consecutive_days_completed"
    },
    "weekly": {
      "description": "Count consecutive weeks where ALL selected days are completed",
      "resetCondition": "Missing any required day in a week breaks the streak",
      "calculation": "consecutive_weeks_all_completed"
    },
    "custom": {
      "description": "Count consecutive periods where target count is met",
      "resetCondition": "Not meeting target count in a period breaks the streak", 
      "calculation": "consecutive_periods_target_met"
    }
  },
  
  "userInteractions": {
    "habitListItem": {
      "onClick": "Open habit detail modal with slide-up animation",
      "completionButton": {
        "onClick": "Toggle today's completion (prevent modal open)",
        "stopPropagation": true
      }
    },
    "habitDetailModal": {
      "calendarDay": {
        "onClick": "Toggle completion for that specific date",
        "updateStreak": true,
        "refreshDisplay": true
      },
      "editButton": {
        "onClick": "Open habit edit modal/page"
      },
      "deleteButton": {
        "onClick": "Show confirmation dialog, then delete habit"
      },
      "closeButton": {
        "onClick": "Close modal with slide-down animation"
      },
      "overlay": {
        "onClick": "Close modal"
      }
    },
    "monthNavigation": {
      "previousButton": {
        "onClick": "Navigate to previous month, regenerate calendar"
      },
      "nextButton": {
        "onClick": "Navigate to next month, regenerate calendar"
      }
    }
  },
  
  "animations": {
    "modalSlideUp": {
      "duration": "300ms",
      "easing": "ease",
      "properties": {
        "overlay": {
          "opacity": "0 ‚Üí 1"
        },
        "modal": {
          "transform": "translateY(100%) ‚Üí translateY(0)"
        }
      }
    },
    "modalSlideDown": {
      "duration": "300ms",
      "easing": "ease", 
      "properties": {
        "overlay": {
          "opacity": "1 ‚Üí 0"
        },
        "modal": {
          "transform": "translateY(0) ‚Üí translateY(100%)"
        }
      }
    },
    "completionButton": {
      "duration": "200ms",
      "easing": "ease",
      "properties": {
        "scale": "1 ‚Üí 1.05 ‚Üí 1",
        "backgroundColor": "transition to habit color when completed"
      }
    },
    "calendarDay": {
      "duration": "150ms",
      "easing": "ease",
      "properties": {
        "scale": "1 ‚Üí 1.1 ‚Üí 1 (on click)",
        "backgroundColor": "transition to habit color when completed"
      }
    }
  },
  
  "responsiveDesign": {
    "mobile": {
      "maxWidth": "768px",
      "changes": {
        "habitsList": {
          "padding": "16px 12px"
        },
        "habitIcon": {
          "size": "40px"
        },
        "completionButton": {
          "size": "44px (minimum touch target)"
        },
        "modal": {
          "maxHeight": "95vh",
          "borderRadius": "16px 16px 0 0"
        }
      }
    },
    "tablet": {
      "maxWidth": "1024px",
      "changes": {
        "habitsList": {
          "maxWidth": "700px"
        }
      }
    },
    "desktop": {
      "minWidth": "1025px",
      "changes": {
        "habitsList": {
          "maxWidth": "800px"
        },
        "modal": {
          "maxWidth": "600px",
          "margin": "0 auto"
        }
      }
    }
  },
  
  "accessibility": {
    "requirements": [
      "All interactive elements must have appropriate ARIA labels",
      "Modal must trap focus and return focus on close",
      "Calendar navigation must be keyboard accessible",
      "Completion states must be announced to screen readers",
      "High contrast mode support for all visual elements",
      "Minimum touch target size of 44px for mobile"
    ]
  },
  
  "performance": {
    "requirements": [
      "Modal animation must maintain 60fps",
      "Calendar generation should be optimized for large date ranges",
      "Habit list should support virtualization for 100+ habits",
      "API calls should be debounced for rapid interactions",
      "Images and icons should be optimized and cached"
    ]
  },
  
  "testingScenarios": {
    "userInteractions": [
      "Click habit item to open modal",
      "Complete habit via completion button",
      "Toggle past completion in calendar",
      "Navigate between months",
      "Edit habit information",
      "Delete habit with confirmation",
      "Close modal via overlay, button, or escape key"
    ],
    "streakCalculation": [
      "Daily habit: complete consecutive days",
      "Weekly habit: complete all required days in week",
      "Custom habit: meet target count in period",
      "Frequency change: preserve historical data",
      "Calendar editing: recalculate streak in real-time"
    ],
    "responsiveDesign": [
      "Test on mobile (320px - 768px)",
      "Test on tablet (768px - 1024px)", 
      "Test on desktop (1024px+)",
      "Verify touch targets on mobile",
      "Check modal behavior on different screen sizes"
    ]
  },
  
  "implementationNotes": {
    "criticalFeatures": [
      "Modal slide-up animation must be smooth and performant",
      "Calendar day clicking must update streaks immediately",
      "Habit colors must be consistently applied throughout",
      "Completion button must prevent modal opening (event.stopPropagation)",
      "Month navigation must preserve habit context"
    ],
    "technicalConsiderations": [
      "Use CSS custom properties for habit colors (--habit-color)",
      "Implement proper z-index stacking for modal overlay",
      "Handle keyboard navigation and focus management",
      "Optimize calendar rendering for performance",
      "Implement proper error handling and loading states"
    ]
  }
}